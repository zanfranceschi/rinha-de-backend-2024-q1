 Network rinha-nginx-2024q1  Creating
 Network rinha-nginx-2024q1  Created
 Container erickreis-db-1  Creating
 Container erickreis-db-1  Created
 Container erickreis-api02-1  Creating
 Container erickreis-api01-1  Creating
 Container erickreis-api02-1  Created
 Container erickreis-api01-1  Created
 Container erickreis-nginx-1  Creating
 Container erickreis-nginx-1  Created
Attaching to api01-1, api02-1, db-1, nginx-1
db-1     | The files belonging to this database system will be owned by user "postgres".
db-1     | This user must also own the server process.
db-1     | 
db-1     | The database cluster will be initialized with locale "en_US.utf8".
db-1     | The default database encoding has accordingly been set to "UTF8".
db-1     | The default text search configuration will be set to "english".
db-1     | 
db-1     | Data page checksums are disabled.
db-1     | 
db-1     | fixing permissions on existing directory /var/lib/postgresql/data ... ok
db-1     | creating subdirectories ... ok
db-1     | selecting dynamic shared memory implementation ... posix
db-1     | selecting default max_connections ... 100
db-1     | selecting default shared_buffers ... 128MB
db-1     | selecting default time zone ... Etc/UTC
db-1     | creating configuration files ... ok
api01-1  | $ bun run dist/index.js
api02-1  | $ bun run dist/index.js
api01-1  | Server started at http://localhost:3000 in development mode.
api02-1  | Server started at http://localhost:3000 in development mode.
db-1     | running bootstrap script ... ok
nginx-1  | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
nginx-1  | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
nginx-1  | 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
nginx-1  | 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
nginx-1  | /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
nginx-1  | /docker-entrypoint.sh: Configuration complete; ready for start up
db-1     | performing post-bootstrap initialization ... ok
db-1     | syncing data to disk ... ok
db-1     | 
db-1     | 
db-1     | Success. You can now start the database server using:
db-1     | 
db-1     |     pg_ctl -D /var/lib/postgresql/data -l logfile start
db-1     | 
db-1     | initdb: warning: enabling "trust" authentication for local connections
db-1     | initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
db-1     | waiting for server to start....2024-02-19 04:59:25.832 UTC [49] LOG:  starting PostgreSQL 16.2 (Debian 16.2-1.pgdg120+2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
db-1     | 2024-02-19 04:59:25.836 UTC [49] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db-1     | 2024-02-19 04:59:25.845 UTC [52] LOG:  database system was shut down at 2024-02-19 04:59:25 UTC
db-1     | 2024-02-19 04:59:25.852 UTC [49] LOG:  database system is ready to accept connections
db-1     |  done
db-1     | server started
db-1     | CREATE DATABASE
db-1     | 
db-1     | 
db-1     | /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init.sql
db-1     | CREATE TABLE
db-1     | CREATE TABLE
db-1     | INSERT 0 5
db-1     | 
db-1     | 
db-1     | waiting for server to shut down...2024-02-19 04:59:26.337 UTC [49] LOG:  received fast shutdown request
db-1     | .2024-02-19 04:59:26.341 UTC [49] LOG:  aborting any active transactions
db-1     | 2024-02-19 04:59:26.415 UTC [49] LOG:  background worker "logical replication launcher" (PID 55) exited with exit code 1
db-1     | 2024-02-19 04:59:26.415 UTC [50] LOG:  shutting down
db-1     | 2024-02-19 04:59:26.419 UTC [50] LOG:  checkpoint starting: shutdown immediate
api01-1  | 1 | import{c as PY,d as qH,e as P,f as VH,g as kH} from"./chunk-6f10381133ca5ab7.js";var U5=P((yX)=>{var bX=function($){return $};yX.parse=function($,Z){return new W5($,Z).parse()};class W5{constructor($,Z){this.source=$,this.transform=Z||bX,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var $=this.source[this.position++];if($==="\\")return{value:this.source[this.position++],escaped:!0};return{value:$,escaped:!1}}record($){this.recorded.push($)}newEntry($){var Z;if(this.recorded.length>0||$){if(Z=this.recorded.join(""),Z==="NULL"&&!$)Z=null;if(Z!==null)Z=this.transform(Z);this.entries.push(Z),this.recorded=[]}}consumeDimensions(){if(this.source[0]==="[")while(!this.isEof()){var $=this.nextCharacter();if($.value==="=")break}}parse($){var Z,X,Y;this.consumeDimensions();while(!this.isEof())if(Z=this.nextCharacter(),Z.value==="{"&&!Y){if(this.dimension++,this.dimension>1)X=new W5(this.source.substr(this.position-1),this.transform),this.entries.push(X.parse(!0)),this.position+=X.position-2}else if(Z.value==="}"&&!Y){if(this.dimension--,!this.dimension){if(this.newEntry(),$)return this.entries}}else if(Z.value==='"'&&!Z.escaped){if(Y)this.newEntry(!0);Y=!Y}else if(Z.value===","&&!Y)this.newEntry();else this.record(Z.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}}});var L5=P((Qq,l9)=>{var mX=U5();l9.exports={create:function($,Z){return{parse:function(){return mX.parse($,Z)}}}}});var i9=P((Sq,a9)=>{var lX=function($){var Z=cX.exec($);if(!Z)return;var X=parseInt(Z[1],10),Y=!!Z[4];if(Y)X=d9(X);var G=parseInt(Z[2],10)-1,K=Z[3],J=new Date(X,G,K);if(M5(X))J.setFullYear(X);return J},dX=function($){if($.endsWith("+00"))return 0;var Z=uX.exec($.split(" ")[1]);if(!Z)return;var X=Z[1];if(X==="Z")return 0;var Y=X==="-"?-1:1,G=parseInt(Z[2],10)*3600+parseInt(Z[3]||0,10)*60+parseInt(Z[4]||0,10);return G*Y*1000},d9=function($){return-($-1)},M5=function($){return $>=0&&$<100},fX=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,cX=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,uX=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,pX=/^-?infinity$/;a9.exports=function $(Z){if(pX.test(Z))return Number(Z.replace("i","I"));var X=fX.exec(Z);if(!X)return lX(Z)||null;var Y=!!X[8],G=parseInt(X[1],10);if(Y)G=d9(G);var K=parseInt(X[2],10)-1,J=X[3],_=parseInt(X[4],10),U=parseInt(X[5],10),L=parseInt(X[6],10),F=X[7];F=F?1000*parseFloat(F):0;var E,h=dX(Z);if(h!=null){if(E=new Date(Date.UTC(G,K,J,_,U,L,F)),M5(G))E.setUTCFullYear(G);if(h!==0)E.setTime(E.getTime()-h)}else if(E=new Date(G,K,J,_,U,L,F),M5(G))E.setFullYear(G);return E}});var s9=P((Iq,t9)=>{var iX=function($){for(var Z=1;Z<arguments.length;Z++){var X=arguments[Z];for(var Y in X)if(aX.call(X,Y))$[Y]=X[Y]}return $};t9.exports=iX;var aX=Object.prototype.hasOwnProperty});var r9=P((Cq,o9)=>{var u1=function($){if(!(this instanceof u1))return new u1($);tX(this,K6($))},G6=function($){var Z=$+"000000".slice($.length);return parseInt(Z,10)/1000},K6=function($){if(!$)return{};var Z=H6.exec($),X=Z[8]==="-";return Object.keys(n9).reduce(function(Y,G){var K=n9[G],J=Z[K];if(!J)return Y;if(J=G==="milliseconds"?G6(J):parseInt(J,10),!J)return Y;if(X&&~Y6.indexOf(G))J*=-1;return Y[G]=J,Y},{})},tX=s9();o9.exports=u1;var sX=["seconds","minutes","hours","days","months","years"];u1.prototype.toPostgres=function(){var $=sX.filter(this.hasOwnProperty,this);if(this.milliseconds&&$.indexOf("seconds")<0)$.push("seconds");if($.length===0)return"0";return $.map(function(Z){var X=this[Z]||0;if(Z==="seconds"&&this.milliseconds)X=(X+this.milliseconds/1000).toFixed(6).replace(/\.?0+$/,"");return X+" "+Z},this).join(" ")};var nX={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},oX=["years","months","days"],rX=["hours","minutes","seconds"];u1.prototype.toISOString=u1.prototype.toISO=function(){var $=oX.map(X,this).join(""),Z=rX.map(X,this).join("");return"P"+$+"T"+Z;function X(Y){var G=this[Y]||0;if(Y==="seconds"&&this.milliseconds)G=(G+this.milliseconds/1000).toFixed(6).replace(/0+$/,"");return G+nX[Y]}};var F5="([+-]?\\d+)",eX=F5+"\\s+years?",$6=F5+"\\s+mons?",Z6=F5+"\\s+days?",X6="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",H6=new RegExp([eX,$6,Z6,X6].map(function($){return"("+$+")?"}).join("\\s*")),n9={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Y6=["hours","minutes","seconds","milliseconds"]});var $$=P((hq,e9)=>{e9.exports=function $(Z){if(/^\\x/.test(Z))return new Buffer(Z.substr(2),"hex");var X="",Y=0;while(Y<Z.length)if(Z[Y]!=="\\")X+=Z[Y],++Y;else if(/[0-7]{3}/.test(Z.substr(Y+1,3)))X+=String.fromCharCode(parseInt(Z.substr(Y+1,3),8)),Y+=4;else{var G=1;while(Y+G<Z.length&&Z[Y+G]==="\\")G++;for(var K=0;K<Math.floor(G/2);++K)X+="\\";Y+=Math.floor(G/2)*2}return new Buffer(X,"binary")}});var J$=P((jq,K$)=>{var $4=function($){return function Z(X){if(X===null)return X;return $(X)}},Y$=function($){if($===null)return $;return $==="TRUE"||$==="t"||$==="true"||$==="y"||$==="yes"||$==="on"||$==="1"},J6=function($){if(!$)return null;return V8.parse($,Y$)},_6=function($){return parseInt($,10)},V5=function($){if(!$)return null;return V8.parse($,$4(_6))},W6=function($){if(!$)return null;return V8.parse($,$4(function(Z){return G$(Z).trim()}))},V8=U5(),k8=L5(),e8=i9(),X$=r9(),H$=$$(),U6=function($){if(!$)return null;var Z=k8.create($,function(X){if(X!==null)X=P5(X);return X});return Z.parse()},k5=function($){if(!$)return null;var Z=k8.create($,function(X){if(X!==null)X=parseFloat(X);return X});return Z.parse()},k0=function($){if(!$)return null;var Z=k8.create($);return Z.parse()},R5=function($){if(!$)return null;var Z=k8.create($,function(X){if(X!==null)X=e8(X);return X});return Z.parse()},L6=function($){if(!$)return null;var Z=k8.create($,function(X){if(X!==null)X=X$(X);return X});return Z.parse()},M6=function($){if(!$)return null;return V8.parse($,$4(H$))},q5=function($){return parseInt($,10)},G$=function($){var Z=String($);if(/^\d+$/.test(Z))return Z;return $},Z$=function($){if(!$)return null;return V8.parse($,$4(JSON.parse))},P5=function($){if($[0]!=="(")return null;return $=$.substring(1,$.length-1).split(","),{x:parseFloat($[0]),y:parseFloat($[1])}},F6=function($){if($[0]!=="<"&&$[1]!=="(")return null;var Z="(",X="",Y=!1;for(var G=2;G<$.length-1;G++){if(!Y)Z+=$[G];if($[G]===")"){Y=!0;continue}else if(!Y)continue;if($[G]===",")continue;X+=$[G]}var K=P5(Z);return K.radius=parseFloat(X),K},V6=function($){$(20,G$),$(21,q5),$(23,q5),$(26,q5),$(700,parseFloat),$(701,parseFloat),$(16,Y$),$(1082,e8),$(1114,e8),$(1184,e8),$(600,P5),$(651,k0),$(718,F6),$(1000,J6),$(1001,M6),$(1005,V5),$(1007,V5),$(1028,V5),$(1016,W6),$(1017,U6),$(1021,k5),$(1022,k5),$(1231,k5),$(1014,k0),$(1015,k0),$(1008,k0),$(1009,k0),$(1040,k0),$(1041,k0),$(1115,R5),$(1182,R5),$(1185,R5),$(1186,X$),$(1187,L6),$(17,H$),$(114,JSON.parse.bind(JSON)),$(3802,JSON.parse.bind(JSON)),$(199,Z$),$(3807,Z$),$(3907,k0),$(2951,k0),$(791,k0),$(1183,k0),$(1270,k0)};K$.exports={init:V6}});var W$=P((xq,_$)=>{var k6=function($){var Z=$.readInt32BE(0),X=$.readUInt32BE(4),Y="";if(Z<0)Z=~Z+(X===0),X=~X+1>>>0,Y="-";var G="",K,J,_,U,L,F;{if(K=Z%Y0,Z=Z/Y0>>>0,J=4294967296*K+X,X=J/Y0>>>0,_=""+(J-Y0*X),X===0&&Z===0)return Y+_+G;U="",L=6-_.length;for(F=0;F<L;F++)U+="0";G=U+_+G}{if(K=Z%Y0,Z=Z/Y0>>>0,J=4294967296*K+X,X=J/Y0>>>0,_=""+(J-Y0*X),X===0&&Z===0)return Y+_+G;U="",L=6-_.length;for(F=0;F<L;F++)U+="0";G=U+_+G}{if(K=Z%Y0,Z=Z/Y0>>>0,J=4294967296*K+X,X=J/Y0>>>0,_=""+(J-Y0*X),X===0&&Z===0)return Y+_+G;U="",L=6-_.length;for(F=0;F<L;F++)U+="0";G=U+_+G}return K=Z%Y0,J=4294967296*K+X,_=""+J%Y0,Y+_+G},Y0=1e6;_$.exports=k6});var V$=P((vq,F$)=>{var R6=W$(),v=function($,Z,X,Y,G){X=X||0,Y=Y||!1,G=G||function(K0,W4,U4){return K0*Math.pow(2,U4)+W4};var K=X>>3,J=function(K0){if(Y)return~K0&255;return K0},_=255,U=8-X%8;if(Z<U)_=255<<8-Z&255,U=Z;if(X)_=_>>X%8;var L=0;if(X%8+Z>=8)L=G(0,J($[K])&_,U);var F=Z+X>>3;for(var E=K+1;E<F;E++)L=G(L,J($[E]),8);var h=(Z+X)%8;if(h>0)L=G(L,J($[F])>>8-h,h);return L},M$=function($,Z,X){var Y=Math.pow(2,X-1)-1,G=v($,1),K=v($,X,1);if(K===0)return 0;var J=1,_=function(L,F,E){if(L===0)L=1;for(var h=1;h<=E;h++)if(J/=2,(F&1<<E-h)>0)L+=J;return L},U=v($,Z,X+1,!1,_);if(K==Math.pow(2,X+1)-1){if(U===0)return G===0?Infinity:(-Infinity);return NaN}return(G===0?1:-1)*Math.pow(2,K-Y)*U},q6=function($){if(v($,1)==1)return-1*(v($,15,1,!0)+1);return v($,15,1)},U$=function($){if(v($,1)==1)return-1*(v($,31,1,!0)+1);return v($,31,1)},P6=function($){return M$($,23,8)},D6=function($){return M$($,52,11)},E6=function($){var Z=v($,16,32);if(Z==49152)return NaN;var X=Math.pow(1e4,v($,16,16)),Y=0,G=[],K=v($,16);for(var J=0;J<K;J++)Y+=v($,16,64+16*J)*X,X/=1e4;var _=Math.pow(10,v($,16,48));return(Z===0?1:-1)*Math.round(Y*_)/_},L$=function($,Z){var X=v(Z,1),Y=v(Z,63,1),G=new Date((X===0?1:-1)*Y/1000+946684800000);if(!$)G.setTime(G.getTime()+G.getTimezoneOffset()*60000);return G.usec=Y%1000,G.getMicroSeconds=function(){return this.usec},G.setMicroSeconds=function(K){this.usec=K},G.getUTCMicroSeconds=function(){return this.usec},G},R8=function($){var Z=v($,32),X=v($,32,32),Y=v($,32,64),G=96,K=[];for(var J=0;J<Z;J++)K[J]=v($,32,G),G+=32,G+=32;var _=function(L){var F=v($,32,G);if(G+=32,F==4294967295)return null;var E;if(L==23||L==20)return E=v($,F*8,G),G+=F*8,E;else if(L==25)return E=$.toString(this.encoding,G>>3,(G+=F<<3)>>3),E;else console.log("ERROR: ElementType not implemented: "+L)},U=function(L,F){var E=[],h;if(L.length>1){var K0=L.shift();for(h=0;h<K0;h++)E[h]=U(L,F);L.unshift(K0)}else for(h=0;h<L[0];h++)E[h]=_(F);return E};return U(K,Y)},O6=function($){return $.toString("utf8")},w6=function($){if($===null)return null;return v($,8)>0},T6=function($){$(20,R6),$(21,q6),$(23,U$),$(26,U$),$(1700,E6),$(700,P6),$(701,D6),$(16,w6),$(1114,L$.bind(null,!1)),$(1184,L$.bind(null,!0)),$(1000,R8),$(1007,R8),$(1016,R8),$(1008,R8),$(1009,R8),$(25,O6)};F$.exports={init:T6}});var R$=P((Bq,k$)=>{k$.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var P8=P((h6)=>{var q$=function($){return String($)},I6=function($,Z){if(Z=Z||"text",!q8[Z])return q$;return q8[Z][$]||q$},C6=function($,Z,X){if(typeof Z=="function")X=Z,Z="text";q8[Z][$]=X},A6=J$(),z6=V$(),Q6=L5(),S6=R$();h6.getTypeParser=I6;h6.setTypeParser=C6;h6.arrayParser=Q6;h6.builtins=S6;var q8={text:{},binary:{}};A6.init(function($,Z){q8.text[$]=Z});z6.init(function($,Z){q8.binary[$]=Z})});var D8=P((bq,D5)=>{D5.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:30000,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var p1=P8(),N6=p1.getTypeParser(20,"text"),b6=p1.getTypeParser(1016,"text");D5.exports.__defineSetter__("parseInt8",function($){p1.setTypeParser(20,"text",$?p1.getTypeParser(23,"text"):N6),p1.setTypeParser(1016,"text",$?p1.getTypeParser(1007,"text"):b6)})});var E8=P((yq,D$)=>{var g6=function($){var Z=$.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+Z+'"'},P$=function($){var Z="{";for(var X=0;X<$.length;X++){if(X>0)Z=Z+",";if($[X]===null||typeof $[X]==="undefined")Z=Z+"NULL";else if(Array.isArray($[X]))Z=Z+P$($[X]);else if($[X]instanceof Buffer)Z+="\\\\x"+$[X].toString("hex");else Z+=g6(Z4($[X]))}return Z=Z+"}",Z},m6=function($,Z){if($&&typeof $.toPostgres==="function"){if(Z=Z||[],Z.indexOf($)!==-1)throw new Error('circular reference detected while preparing "'+$+'" for query');return Z.push($),Z4($.toPostgres(Z4),Z)}return JSON.stringify($)},s=function($,Z){$=""+$;while($.length<Z)$="0"+$;return $},f6=function($){var Z=-$.getTimezoneOffset(),X=$.getFullYear(),Y=X<1;if(Y)X=Math.abs(X)+1;var G=s(X,4)+"-"+s($.getMonth()+1,2)+"-"+s($.getDate(),2)+"T"+s($.getHours(),2)+":"+s($.getMinutes(),2)+":"+s($.getSeconds(),2)+"."+s($.getMilliseconds(),3);if(Z<0)G+="-",Z*=-1;else G+="+";if(G+=s(Math.floor(Z/60),2)+":"+s(Z%60,2),Y)G+=" BC";return G},c6=function($){var Z=$.getUTCFullYear(),X=Z<1;if(X)Z=Math.abs(Z)+1;var Y=s(Z,4)+"-"+s($.getUTCMonth()+1,2)+"-"+s($.getUTCDate(),2)+"T"+s($.getUTCHours(),2)+":"+s($.getUTCMinutes(),2)+":"+s($.getUTCSeconds(),2)+"."+s($.getUTCMilliseconds(),3);if(Y+="+00:00",X)Y+=" BC";return Y},u6=function($,Z,X){if($=typeof $==="string"?{text:$}:$,Z)if(typeof Z==="function")$.callback=Z;else $.values=Z;if(X)$.callback=X;return $},y6=D8(),Z4=function($,Z){if($==null)return null;if($ instanceof Buffer)return $;if(ArrayBuffer.isView($)){var X=Buffer.from($.buffer,$.byteOffset,$.byteLength);if(X.length===$.byteLength)return X;return X.slice($.byteOffset,$.byteOffset+$.byteLength)}if($ instanceof Date)if(y6.parseInputDatesAsUTC)return c6($);else return f6($);if(Array.isArray($))return P$($);if(typeof $==="object")return m6($,Z);return $.toString()},p6=function($){return'"'+$.replace(/"/g,'""')+'"'},l6=function($){var Z=!1,X="'";for(var Y=0;Y<$.length;Y++){var G=$[Y];if(G==="'")X+=G+G;else if(G==="\\")X+=G+G,Z=!0;else X+=G}if(X+="'",Z===!0)X=" E"+X;return X};D$.exports={prepareValue:function $(Z){return Z4(Z)},normalizeQueryConfig:u6,escapeIdentifier:p6,escapeLiteral:l6}});var O$=P((gq,E$)=>{var E5=function($){return O8.createHash("md5").update($,"utf-8").digest("hex")},d6=function($,Z,X){var Y=E5(Z+$),G=E5(Buffer.concat([Buffer.from(Y),X]));return"md5"+G},a6=function($){return O8.createHash("sha256").update($).digest()},i6=function($,Z){return O8.createHmac("sha256",$).update(Z).digest()};async function t6($,Z,X){return O8.pbkdf2Sync($,Z,X,32,"sha256")}var O8=import.meta.require("crypto");E$.exports={postgresMd5PasswordHash:d6,randomBytes:O8.randomBytes,deriveKey:t6,sha256:a6,hmacSha256:i6,md5:E5}});var z$=P((mq,A$)=>{var s6=function($){return T$.getRandomValues(Buffer.alloc($))};async function O5($){try{return w$.createHash("md5").update($,"utf-8").digest("hex")}catch(Z){const X=typeof $==="string"?w5.encode($):$,Y=await l1.digest("MD5",X);return Array.from(new Uint8Array(Y)).map((G)=>G.toString(16).padStart(2,"0")).join("")}}async function n6($,Z,X){var Y=await O5(Z+$),G=await O5(Buffer.concat([Buffer.from(Y),X]));return"md5"+G}async function o6($){return await l1.digest("SHA-256",$)}async function r6($,Z){const X=await l1.importKey("raw",$,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await l1.sign("HMAC",X,w5.encode(Z))}async function e6($,Z,X){const Y=await l1.importKey("raw",w5.encode($),"PBKDF2",!1,["deriveBits"]),G={name:"PBKDF2",hash:"SHA-256",salt:Z,iterations:X};return await l1.deriveBits(G,Y,256,["deriveBits"])}var w$=import.meta.require("crypto");A$.exports={postgresMd5PasswordHash:n6,randomBytes:s6,deriveKey:e6,sha256:o6,hmacSha256:r6,md5:O5};var T$=w$.webcrypto||globalThis.crypto,l1=T$.subtle,w5=new TextEncoder});var A5=P((fq,T5)=>{var $7=parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15;if($7)T5.exports=O$();else T5.exports=z$()});var C$=P((cq,I$)=>{var Z7=function($){if($.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");const Z=M1.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:Z,response:"n,,n=*,r="+Z,message:"SASLInitialResponse"}};async function X7($,Z,X){if($.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof Z!=="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(Z==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof X!=="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");const Y=G7(X);if(!Y.nonce.startsWith($.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");else if(Y.nonce.length===$.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");var G="n=*,r="+$.clientNonce,K="r="+Y.nonce+",s="+Y.salt+",i="+Y.iteration,J="c=biws,r="+Y.nonce,_=G+","+K+","+J,U=Buffer.from(Y.salt,"base64"),L=await M1.deriveKey(Z,U,Y.iteration),F=await M1.hmacSha256(L,"Client Key"),E=await M1.sha256(F),h=await M1.hmacSha256(E,_),K0=J7(Buffer.from(F),Buffer.from(h)).toString("base64"),W4=await M1.hmacSha256(L,"Server Key"),U4=await M1.hmacSha256(W4,_);$.message="SASLResponse",$.serverSignature=Buffer.from(U4).toString("base64"),$.response=J+",p="+K0}var H7=function($,Z){if($.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof Z!=="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");const{serverSignature:X}=K7(Z);if(X!==$.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")},Y7=function($){if(typeof $!=="string")throw new TypeError("SASL: text must be a string");return $.split("").map((Z,X)=>$.charCodeAt(X)).every((Z)=>Z>=33&&Z<=43||Z>=45&&Z<=126)},Q$=function($){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test($)},S$=function($){if(typeof $!=="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map($.split(",").map((Z)=>{if(!/^.=/.test(Z))throw new Error("SASL: Invalid attribute pair entry");const X=Z[0],Y=Z.substring(2);return[X,Y]}))},G7=function($){const Z=S$($),X=Z.get("r");if(!X)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");else if(!Y7(X))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters");const Y=Z.get("s");if(!Y)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");else if(!Q$(Y))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64");const G=Z.get("i");if(!G)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");else if(!/^[1-9][0-9]*$/.test(G))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count");const K=parseInt(G,10);return{nonce:X,salt:Y,iteration:K}},K7=function($){const X=S$($).get("v");if(!X)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");else if(!Q$(X))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64");return{serverSignature:X}},J7=function($,Z){if(!Buffer.isBuffer($))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(Z))throw new TypeError("second argument must be a Buffer");if($.length!==Z.length)throw new Error("Buffer lengths must match");if($.length===0)throw new Error("Buffers cannot be empty");return Buffer.from($.map((X,Y)=>$[Y]^Z[Y]))},M1=A5();I$.exports={startSession:Z7,continueSession:X7,finalizeSession:H7}});var z5=P((uq,h$)=>{var X4=function($){this._types=$||_7,this.text={},this.binary={}},_7=P8();X4.prototype.getOverrides=function($){switch($){case"text":return this.text;case"binary":return this.binary;default:return{}}};X4.prototype.setTypeParser=function($,Z,X){if(typeof Z==="function")X=Z,Z="text";this.getOverrides(Z)[$]=X};X4.prototype.getTypeParser=function($,Z){return Z=Z||"text",this.getOverrides(Z)[$]||this._types.getTypeParser($,Z)};h$.exports=X4});var x$=P((pq,j$)=>{var Q5=function($){if($.charAt(0)==="/"){const _=$.split(" ");return{host:_[0],database:_[1]}}const Z={};let X,Y=!1;if(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test($))$=encodeURI($).replace(/\%25(\d\d)/g,"%$1");try{X=new URL($,"postgres://base")}catch(_){X=new URL($.replace("@/","@___DUMMY___/"),"postgres://base"),Y=!0}for(let _ of X.searchParams.entries())Z[_[0]]=_[1];if(Z.user=Z.user||decodeURIComponent(X.username),Z.password=Z.password||decodeURIComponent(X.password),X.protocol=="socket:")return Z.host=decodeURI(X.pathname),Z.database=X.searchParams.get("db"),Z.client_encoding=X.searchParams.get("encoding"),Z;const G=Y?"":X.hostname;if(!Z.host)Z.host=decodeURIComponent(G);else if(G&&/^%2f/i.test(G))X.pathname=G+X.pathname;if(!Z.port)Z.port=X.port;const K=X.pathname.slice(1)||null;if(Z.database=K?decodeURI(K):null,Z.ssl==="true"||Z.ssl==="1")Z.ssl=!0;if(Z.ssl==="0")Z.ssl=!1;if(Z.sslcert||Z.sslkey||Z.sslrootcert||Z.sslmode)Z.ssl={};const J=Z.sslcert||Z.sslkey||Z.sslrootcert?import.meta.require("fs"):null;if(Z.sslcert)Z.ssl.cert=J.readFileSync(Z.sslcert).toString();if(Z.sslkey)Z.ssl.key=J.readFileSync(Z.sslkey).toString();if(Z.sslrootcert)Z.ssl.ca=J.readFileSync(Z.sslrootcert).toString();switch(Z.sslmode){case"disable":{Z.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{Z.ssl.rejectUnauthorized=!1;break}}return Z};j$.exports=Q5;Q5.parse=Q5});var S5=P((lq,b$)=>{var W7=import.meta.require("dns"),B$=D8(),v$=x$().parse,$0=function($,Z,X){if(X===void 0)X=process.env["PG"+$.toUpperCase()];else if(X===!1);else X=process.env[X];return Z[$]||X||B$[$]},U7=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return B$.ssl},d1=function($){return"'"+(""+$).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},R0=function($,Z,X){var Y=Z[X];if(Y!==void 0&&Y!==null)$.push(X+"="+d1(Y))};class N${constructor($){if($=typeof $==="string"?v$($):$||{},$.connectionString)$=Object.assign({},$,v$($.connectionString));if(this.user=$0("user",$),this.database=$0("database",$),this.database===void 0)this.database=this.user;if(this.port=parseInt($0("port",$),10),this.host=$0("host",$),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:$0("password",$)}),this.binary=$0("binary",$),this.options=$0("options",$),this.ssl=typeof $.ssl==="undefined"?U7():$.ssl,typeof this.ssl==="string"){if(this.ssl==="true")this.ssl=!0}if(this.ssl==="no-verify")this.ssl={rejectUnauthorized:!1};if(this.ssl&&this.ssl.key)Object.defineProperty(this.ssl,"key",{enumerable:!1});if(this.client_encoding=$0("client_encoding",$),this.replication=$0("replication",$),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=$0("application_name",$,"PGAPPNAME"),this.fallback_application_name=$0("fallback_application_name",$,!1),this.statement_timeout=$0("statement_timeout",$,!1),this.lock_timeout=$0("lock_timeout",$,!1),this.idle_in_transaction_session_timeout=$0("idle_in_transaction_session_timeout",$,!1),this.query_timeout=$0("query_timeout",$,!1),$.connectionTimeoutMillis===void 0)this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0;else this.connect_timeout=Math.floor($.connectionTimeoutMillis/1000);if($.keepAlive===!1)this.keepalives=0;else if($.keepAlive===!0)this.keepalives=1;if(typeof $.keepAliveInitialDelayMillis==="number")this.keepalives_idle=Math.floor($.keepAliveInitialDelayMillis/1000)}getLibpqConnectionString($){var Z=[];R0(Z,this,"user"),R0(Z,this,"password"),R0(Z,this,"port"),R0(Z,this,"application_name"),R0(Z,this,"fallback_application_name"),R0(Z,this,"connect_timeout"),R0(Z,this,"options");var X=typeof this.ssl==="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(R0(Z,X,"sslmode"),R0(Z,X,"sslca"),R0(Z,X,"sslkey"),R0(Z,X,"sslcert"),R0(Z,X,"sslrootcert"),this.database)Z.push("dbname="+d1(this.database));if(this.replication)Z.push("replication="+d1(this.replication));if(this.host)Z.push("host="+d1(this.host));if(this.isDomainSocket)return $(null,Z.join(" "));if(this.client_encoding)Z.push("client_encoding="+d1(this.client_encoding));W7.lookup(this.host,function(Y,G){if(Y)return $(Y,null);return Z.push("hostaddr="+d1(G)),$(null,Z.join(" "))})}}b$.exports=N$});var f$=P((dq,m$)=>{var L7=P8(),y$=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;class g${constructor($,Z){if(this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=Z,this.RowCtor=null,this.rowAsArray=$==="array",this.rowAsArray)this.parseRow=this._parseRowAsArray;this._prebuiltEmptyResultObject=null}addCommandComplete($){var Z;if($.text)Z=y$.exec($.text);else Z=y$.exec($.command);if(Z){if(this.command=Z[1],Z[3])this.oid=parseInt(Z[2],10),this.rowCount=parseInt(Z[3],10);else if(Z[2])this.rowCount=parseInt(Z[2],10)}}_parseRowAsArray($){var Z=new Array($.length);for(var X=0,Y=$.length;X<Y;X++){var G=$[X];if(G!==null)Z[X]=this._parsers[X](G);else Z[X]=null}return Z}parseRow($){var Z={...this._prebuiltEmptyResultObject};for(var X=0,Y=$.length;X<Y;X++){var G=$[X],K=this.fields[X].name;if(G!==null)Z[K]=this._parsers[X](G)}return Z}addRow($){this.rows.push($)}addFields($){if(this.fields=$,this.fields.length)this._parsers=new Array($.length);for(var Z=0;Z<$.length;Z++){var X=$[Z];if(this._types)this._parsers[Z]=this._types.getTypeParser(X.dataTypeID,X.format||"text");else this._parsers[Z]=L7.getTypeParser(X.dataTypeID,X.format||"text")}this._createPrebuiltEmptyResultObject()}_createPrebuiltEmptyResultObject(){var $={};for(var Z=0;Z<this.fields.length;Z++)$[this.fields[Z].name]=null;this._prebuiltEmptyResultObject={...$}}}m$.exports=g$});var d$=P((aq,l$)=>{var{EventEmitter:M7}=import.meta.require("events"),c$=f$(),u$=E8();class p$ extends M7{constructor($,Z,X){super();if($=u$.normalizeQueryConfig($,Z,X),this.text=$.text,this.values=$.values,this.rows=$.rows,this.types=$.types,this.name=$.name,this.binary=$.binary,this.portal=$.portal||"",this.callback=$.callback,this._rowMode=$.rowMode,process.domain&&$.callback)this.callback=process.domain.bind($.callback);this._result=new c$(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){if(this.name)return!0;if(this.rows)return!0;if(!this.text)return!1;if(!this.values)return!1;return this.values.length>0}_checkForMultirow(){if(this._result.command){if(!Array.isArray(this._results))this._results=[this._result];this._result=new c$(this._rowMode,this.types),this._results.push(this._result)}}handleRowDescription($){this._checkForMultirow(),this._result.addFields($.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow($){let Z;if(this._canceledDueToError)return;try{Z=this._result.parseRow($.fields)}catch(X){this._canceledDueToError=X;return}if(this.emit("row",Z,this._result),this._accumulateRows)this._result.addRow(Z)}handleCommandComplete($,Z){if(this._checkForMultirow(),this._result.addCommandComplete($),this.rows)Z.sync()}handleEmptyQuery($){if(this.rows)$.sync()}handleError($,Z){if(this._canceledDueToError)$=this._canceledDueToError,this._canceledDueToError=!1;if(this.callback)return this.callback($);this.emit("error",$)}handleReadyForQuery($){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,$);if(this.callback)try{this.callback(null,this._results)}catch(Z){process.nextTick(()=>{throw Z})}this.emit("end",this._results)}submit($){if(typeof this.text!=="string"&&typeof this.name!=="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");const Z=$.parsedStatements[this.name];if(this.text&&Z&&this.text!==Z)return new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return new Error("Query values must be an array");if(this.requiresPreparation())this.prepare($);else $.query(this.text);return null}hasBeenParsed($){return this.name&&$.parsedStatements[this.name]}handlePortalSuspended($){this._getRows($,this.rows)}_getRows($,Z){if($.execute({portal:this.portal,rows:Z}),!Z)$.sync();else $.flush()}prepare($){if(this.isPreparedStatement=!0,!this.hasBeenParsed($))$.parse({text:this.text,name:this.name,types:this.types});try{$.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:u$.prepareValue})}catch(Z){this.handleError(Z,$);return}$.describe({type:"P",name:this.portal||""}),this._getRows($,this.rows)}handleCopyInResponse($){$.sendCopyFail("No source stream defined")}handleCopyData($,Z){}}l$.exports=p$});var I5=P((KZ)=>{Object.defineProperty(KZ,"__esModule",{value:!0});KZ.NoticeMessage=KZ.DataRowMessage=KZ.CommandCompleteMessage=KZ.ReadyForQueryMessage=KZ.NotificationResponseMessage=KZ.BackendKeyDataMessage=KZ.AuthenticationMD5Password=KZ.ParameterStatusMessage=KZ.ParameterDescriptionMessage=KZ.RowDescriptionMessage=KZ.Field=KZ.CopyResponse=KZ.CopyDataMessage=KZ.DatabaseError=KZ.copyDone=KZ.emptyQuery=KZ.replicationStart=KZ.portalSuspended=KZ.noData=KZ.closeComplete=KZ.bindComplete=KZ.parseComplete=void 0;KZ.parseComplete={name:"parseComplete",length:5};KZ.bindComplete={name:"bindComplete",length:5};KZ.closeComplete={name:"closeComplete",length:5};KZ.noData={name:"noData",length:5};KZ.portalSuspended={name:"portalSuspended",length:5};KZ.replicationStart={name:"replicationStart",length:4};KZ.emptyQuery={name:"emptyQuery",length:4};KZ.copyDone={name:"copyDone",length:4};class a$ extends Error{constructor($,Z,X){super($);this.length=Z,this.name=X}}KZ.DatabaseError=a$;class i${constructor($,Z){this.length=$,this.chunk=Z,this.name="copyData"}}KZ.CopyDataMessage=i$;class t${constructor($,Z,X,Y){this.length=$,this.name=Z,this.binary=X,this.columnTypes=new Array(Y)}}KZ.CopyResponse=t$;class s${constructor($,Z,X,Y,G,K,J){this.name=$,this.tableID=Z,this.columnID=X,this.dataTypeID=Y,this.dataTypeSize=G,this.dataTypeModifier=K,this.format=J}}KZ.Field=s$;class n${constructor($,Z){this.length=$,this.fieldCount=Z,this.name="rowDescription",this.fields=new Array(this.fieldCount)}}KZ.RowDescriptionMessage=n$;class o${constructor($,Z){this.length=$,this.parameterCount=Z,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}}KZ.ParameterDescriptionMessage=o$;class r${constructor($,Z,X){this.length=$,this.parameterName=Z,this.parameterValue=X,this.name="parameterStatus"}}KZ.ParameterStatusMessage=r$;class e${constructor($,Z){this.length=$,this.salt=Z,this.name="authenticationMD5Password"}}KZ.AuthenticationMD5Password=e$;class $Z{constructor($,Z,X){this.length=$,this.processID=Z,this.secretKey=X,this.name="backendKeyData"}}KZ.BackendKeyDataMessage=$Z;class ZZ{constructor($,Z,X,Y){this.length=$,this.processId=Z,this.channel=X,this.payload=Y,this.name="notification"}}KZ.NotificationResponseMessage=ZZ;class XZ{constructor($,Z){this.length=$,this.status=Z,this.name="readyForQuery"}}KZ.ReadyForQueryMessage=XZ;class HZ{constructor($,Z){this.length=$,this.text=Z,this.name="commandComplete"}}KZ.CommandCompleteMessage=HZ;class YZ{constructor($,Z){this.length=$,this.fields=Z,this.name="dataRow",this.fieldCount=Z.length}}KZ.DataRowMessage=YZ;class GZ{constructor($,Z){this.length=$,this.message=Z,this.name="notice"}}KZ.NoticeMessage=GZ});var LZ=P((WZ)=>{Object.defineProperty(WZ,"__esModule",{value:!0});WZ.Writer=void 0;class _Z{constructor($=256){this.size=$,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe($)}ensure($){var Z=this.buffer.length-this.offset;if(Z<$){var X=this.buffer,Y=X.length+(X.length>>1)+$;this.buffer=Buffer.allocUnsafe(Y),X.copy(this.buffer)}}addInt32($){return this.ensure(4),this.buffer[this.offset++]=$>>>24&255,this.buffer[this.offset++]=$>>>16&255,this.buffer[this.offset++]=$>>>8&255,this.buffer[this.offset++]=$>>>0&255,this}addInt16($){return this.ensure(2),this.buffer[this.offset++]=$>>>8&255,this.buffer[this.offset++]=$>>>0&255,this}addCString($){if(!$)this.ensure(1);else{var Z=Buffer.byteLength($);this.ensure(Z+1),this.buffer.write($,this.offset,"utf-8"),this.offset+=Z}return this.buffer[this.offset++]=0,this}addString($=""){var Z=Buffer.byteLength($);return this.ensure(Z),this.buffer.write($,this.offset),this.offset+=Z,this}add($){return this.ensure($.length),$.copy(this.buffer,this.offset),this.offset+=$.length,this}join($){if($){this.buffer[this.headerPosition]=$;const Z=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(Z,this.headerPosition+1)}return this.buffer.slice($?0:5,this.offset)}flush($){var Z=this.join($);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),Z}}WZ.Writer=_Z});var kZ=P((FZ)=>{Object.defineProperty(FZ,"__esModule",{value:!0});FZ.serialize=void 0;var C5=LZ(),B=new C5.Writer,B7=($)=>{B.addInt16(3).addInt16(0);for(let Y of Object.keys($))B.addCString(Y).addCString($[Y]);B.addCString("client_encoding").addCString("UTF8");var Z=B.addCString("").flush(),X=Z.length+4;return new C5.Writer().addInt32(X).add(Z).flush()},N7=()=>{const $=Buffer.allocUnsafe(8);return $.writeInt32BE(8,0),$.writeInt32BE(80877103,4),$},b7=($)=>{return B.addCString($).flush(112)},y7=function($,Z){return B.addCString($).addInt32(Buffer.byteLength(Z)).addString(Z),B.flush(112)},g7=function($){return B.addString($).flush(112)},m7=($)=>{return B.addCString($).flush(81)},MZ=[],f7=($)=>{const Z=$.name||"";if(Z.length>63)console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",Z,Z.length),console.error("This can cause conflicts and silent errors executing queries");const X=$.types||MZ;var Y=X.length,G=B.addCString(Z).addCString($.text).addInt16(Y);for(var K=0;K<Y;K++)G.addInt32(X[K]);return B.flush(80)},a1=new C5.Writer,c7=function($,Z){for(let X=0;X<$.length;X++){const Y=Z?Z($[X],X):$[X];if(Y==null)B.addInt16(0),a1.addInt32(-1);else if(Y instanceof Buffer)B.addInt16(1),a1.addInt32(Y.length),a1.add(Y);else B.addInt16(0),a1.addInt32(Buffer.byteLength(Y)),a1.addString(Y)}},u7=($={})=>{const Z=$.portal||"",X=$.statement||"",Y=$.binary||!1,G=$.values||MZ,K=G.length;return B.addCString(Z).addCString(X),B.addInt16(K),c7(G,$.valueMapper),B.addInt16(K),B.add(a1.flush()),B.addInt16(Y?1:0),B.flush(66)},p7=Buffer.from([69,0,0,0,9,0,0,0,0,0]),l7=($)=>{if(!$||!$.portal&&!$.rows)return p7;const Z=$.portal||"",X=$.rows||0,Y=Buffer.byteLength(Z),G=4+Y+1+4,K=Buffer.allocUnsafe(1+G);return K[0]=69,K.writeInt32BE(G,1),K.write(Z,5,"utf-8"),K[Y+5]=0,K.writeUInt32BE(X,K.length-4),K},d7=($,Z)=>{const X=Buffer.allocUnsafe(16);return X.writeInt32BE(16,0),X.writeInt16BE(1234,4),X.writeInt16BE(5678,6),X.writeInt32BE($,8),X.writeInt32BE(Z,12),X},h5=($,Z)=>{const Y=4+Buffer.byteLength(Z)+1,G=Buffer.allocUnsafe(1+Y);return G[0]=$,G.writeInt32BE(Y,1),G.write(Z,5,"utf-8"),G[Y]=0,G},a7=B.addCString("P").flush(68),i7=B.addCString("S").flush(68),t7=($)=>{return $.name?h5(68,`${$.type}${$.name||""}`):$.type==="P"?a7:i7},s7=($)=>{const Z=`${$.type}${$.name||""}`;return h5(67,Z)},n7=($)=>{return B.add($).flush(100)},o7=($)=>{return h5(102,$)},H4=($)=>Buffer.from([$,0,0,0,4]),r7=H4(72),e7=H4(83),$H=H4(88),ZH=H4(99),XH={startup:B7,password:b7,requestSsl:N7,sendSASLInitialResponseMessage:y7,sendSCRAMClientFinalMessage:g7,query:m7,parse:f7,bind:u7,execute:l7,describe:t7,close:s7,flush:()=>r7,sync:()=>e7,end:()=>$H,copyData:n7,copyDone:()=>ZH,copyFail:o7,cancel:d7};FZ.serialize=XH});var DZ=P((qZ)=>{Object.defineProperty(qZ,"__esModule",{value:!0});qZ.BufferReader=void 0;var HH=Buffer.allocUnsafe(0);class RZ{constructor($=0){this.offset=$,this.buffer=HH,this.encoding="utf-8"}setBuffer($,Z){this.offset=$,this.buffer=Z}int16(){const $=this.buffer.readInt16BE(this.offset);return this.offset+=2,$}byte(){const $=this.buffer[this.offset];return this.offset++,$}int32(){const $=this.buffer.readInt32BE(this.offset);return this.offset+=4,$}string($){const Z=this.buffer.toString(this.encoding,this.offset,this.offset+$);return this.offset+=$,Z}cstring(){const $=this.offset;let Z=$;while(this.buffer[Z++]!==0);return this.offset=Z,this.buffer.toString(this.encoding,$,Z-1)}bytes($){const Z=this.buffer.slice(this.offset,this.offset+$);return this.offset+=$,Z}}qZ.BufferReader=RZ});var TZ=P((i1)=>{var YH=i1&&i1.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(i1,"__esModule",{value:!0});i1.Parser=void 0;var y=I5(),GH=DZ(),KH=YH(import.meta.require("assert")),j5=1,JH=4,EZ=j5+JH,OZ=Buffer.allocUnsafe(0);class wZ{constructor($){if(this.buffer=OZ,this.bufferLength=0,this.bufferOffset=0,this.reader=new GH.BufferReader,($===null||$===void 0?void 0:$.mode)==="binary")throw new Error("Binary mode not supported yet");this.mode=($===null||$===void 0?void 0:$.mode)||"text"}parse($,Z){this.mergeBuffer($);const X=this.bufferOffset+this.bufferLength;let Y=this.bufferOffset;while(Y+EZ<=X){const G=this.buffer[Y],K=this.buffer.readUInt32BE(Y+j5),J=j5+K;if(J+Y<=X){const _=this.handlePacket(Y+EZ,G,K,this.buffer);Z(_),Y+=J}else break}if(Y===X)this.buffer=OZ,this.bufferLength=0,this.bufferOffset=0;else this.bufferLength=X-Y,this.bufferOffset=Y}mergeBuffer($){if(this.bufferLength>0){const Z=this.bufferLength+$.byteLength;if(Z+this.bufferOffset>this.buffer.byteLength){let Y;if(Z<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)Y=this.buffer;else{let G=this.buffer.byteLength*2;while(Z>=G)G*=2;Y=Buffer.allocUnsafe(G)}this.buffer.copy(Y,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=Y,this.bufferOffset=0}$.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=Z}else this.buffer=$,this.bufferOffset=0,this.bufferLength=$.byteLength}handlePacket($,Z,X,Y){switch(Z){case 50:return y.bindComplete;case 49:return y.parseComplete;case 51:return y.closeComplete;case 110:return y.noData;case 115:return y.portalSuspended;case 99:return y.copyDone;case 87:return y.replicationStart;case 73:return y.emptyQuery;case 68:return this.parseDataRowMessage($,X,Y);case 67:return this.parseCommandCompleteMessage($,X,Y);case 90:return this.parseReadyForQueryMessage($,X,Y);case 65:return this.parseNotificationMessage($,X,Y);case 82:return this.parseAuthenticationResponse($,X,Y);case 83:return this.parseParameterStatusMessage($,X,Y);case 75:return this.parseBackendKeyData($,X,Y);case 69:return this.parseErrorMessage($,X,Y,"error");case 78:return this.parseErrorMessage($,X,Y,"notice");case 84:return this.parseRowDescriptionMessage($,X,Y);case 116:return this.parseParameterDescriptionMessage($,X,Y);case 71:return this.parseCopyInMessage($,X,Y);case 72:return this.parseCopyOutMessage($,X,Y);case 100:return this.parseCopyData($,X,Y);default:KH.default.fail(`unknown message code: ${Z.toString(16)}`)}}parseReadyForQueryMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.string(1);return new y.ReadyForQueryMessage(Z,Y)}parseCommandCompleteMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.cstring();return new y.CommandCompleteMessage(Z,Y)}parseCopyData($,Z,X){const Y=X.slice($,$+(Z-4));return new y.CopyDataMessage(Z,Y)}parseCopyInMessage($,Z,X){return this.parseCopyMessage($,Z,X,"copyInResponse")}parseCopyOutMessage($,Z,X){return this.parseCopyMessage($,Z,X,"copyOutResponse")}parseCopyMessage($,Z,X,Y){this.reader.setBuffer($,X);const G=this.reader.byte()!==0,K=this.reader.int16(),J=new y.CopyResponse(Z,Y,G,K);for(let _=0;_<K;_++)J.columnTypes[_]=this.reader.int16();return J}parseNotificationMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int32(),G=this.reader.cstring(),K=this.reader.cstring();return new y.NotificationResponseMessage(Z,Y,G,K)}parseRowDescriptionMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int16(),G=new y.RowDescriptionMessage(Z,Y);for(let K=0;K<Y;K++)G.fields[K]=this.parseField();return G}parseField(){const $=this.reader.cstring(),Z=this.reader.int32(),X=this.reader.int16(),Y=this.reader.int32(),G=this.reader.int16(),K=this.reader.int32(),J=this.reader.int16()===0?"text":"binary";return new y.Field($,Z,X,Y,G,K,J)}parseParameterDescriptionMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int16(),G=new y.ParameterDescriptionMessage(Z,Y);for(let K=0;K<Y;K++)G.dataTypeIDs[K]=this.reader.int32();return G}parseDataRowMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int16(),G=new Array(Y);for(let K=0;K<Y;K++){const J=this.reader.int32();G[K]=J===-1?null:this.reader.string(J)}return new y.DataRowMessage(Z,G)}parseParameterStatusMessage($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.cstring(),G=this.reader.cstring();return new y.ParameterStatusMessage(Z,Y,G)}parseBackendKeyData($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int32(),G=this.reader.int32();return new y.BackendKeyDataMessage(Z,Y,G)}parseAuthenticationResponse($,Z,X){this.reader.setBuffer($,X);const Y=this.reader.int32(),G={name:"authenticationOk",length:Z};switch(Y){case 0:break;case 3:if(G.length===8)G.name="authenticationCleartextPassword";break;case 5:if(G.length===12){G.name="authenticationMD5Password";const J=this.reader.bytes(4);return new y.AuthenticationMD5Password(Z,J)}break;case 10:G.name="authenticationSASL",G.mechanisms=[];let K;do if(K=this.reader.cstring(),K)G.mechanisms.push(K);while(K);break;case 11:G.name="authenticationSASLContinue",G.data=this.reader.string(Z-8);break;case 12:G.name="authenticationSASLFinal",G.data=this.reader.string(Z-8);break;default:throw new Error("Unknown authenticationOk message type "+Y)}return G}parseErrorMessage($,Z,X,Y){this.reader.setBuffer($,X);const G={};let K=this.reader.string(1);while(K!=="\0")G[K]=this.reader.cstring(),K=this.reader.string(1);const J=G.M,_=Y==="notice"?new y.NoticeMessage(Z,J):new y.DatabaseError(J,Z,Y);return _.severity=G.S,_.code=G.C,_.detail=G.D,_.hint=G.H,_.position=G.P,_.internalPosition=G.p,_.internalQuery=G.q,_.where=G.W,_.schema=G.s,_.table=G.t,_.column=G.c,_.dataType=G.d,_.constraint=G.n,_.file=G.F,_.line=G.L,_.routine=G.R,_}}i1.Parser=wZ});var x5=P((Y4)=>{var LH=function($,Z){const X=new UH.Parser;return $.on("data",(Y)=>X.parse(Y,Z)),new Promise((Y)=>$.on("end",()=>Y()))};Object.defineProperty(Y4,"__esModule",{value:!0});Y4.DatabaseError=Y4.serialize=Y4.parse=void 0;var _H=I5();Object.defineProperty(Y4,"DatabaseError",{enumerable:!0,get:function(){return _H.DatabaseError}});var WH=kZ();Object.defineProperty(Y4,"serialize",{enumerable:!0,get:function(){return WH.serialize}});var UH=TZ();Y4.parse=LH});var AZ={};VH(AZ,{default:()=>{{return RH}}});var RH;var zZ=kH(()=>{RH={}});var QZ=P((PH,v5)=>{PH.getStream=function $(Z){const X=import.meta.require("net");if(typeof X.Socket==="function")return new X.Socket;else{const{CloudflareSocket:Y}=(zZ(),qH(AZ));return new Y(Z)}};PH.getSecureStream=function $(Z){var X=import.meta.require("tls");if(X.connect)return X.connect(Z);else return Z.socket.startTls(Z),Z.socket}});var B5=P((ZP,IZ)=>{var $P=import.meta.require("net"),OH=import.meta.require("events").EventEmitter,{parse:wH,serialize:f}=x5(),{getStream:TH,getSecureStream:AH}=QZ(),zH=f.flush(),QH=f.sync(),SH=f.end();class SZ extends OH{constructor($){super();if($=$||{},this.stream=$.stream||TH($.ssl),typeof this.stream==="function")this.stream=this.stream($);this._keepAlive=$.keepAlive,this._keepAliveInitialDelayMillis=$.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=$.ssl||!1,this._ending=!1,this._emitMessage=!1;var Z=this;this.on("newListener",function(X){if(X==="message")Z._emitMessage=!0})}connect($,Z){var X=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect($,Z),this.stream.once("connect",function(){if(X._keepAlive)X.stream.setKeepAlive(!0,X._keepAliveInitialDelayMillis);X.emit("connect")});const Y=function(G){if(X._ending&&(G.code==="ECONNRESET"||G.code==="EPIPE"))return;X.emit("error",G)};if(this.stream.on("error",Y),this.stream.on("close",function(){X.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(G){var K=G.toString("utf8");switch(K){case"S":break;case"N":return X.stream.end(),X.emit("error",new Error("The server does not support SSL connections"));default:return X.stream.end(),X.emit("error",new Error("There was an error establishing an SSL connection"))}const J={socket:X.stream};if(X.ssl!==!0){if(Object.assign(J,X.ssl),"key"in X.ssl)J.key=X.ssl.key}var _=import.meta.require("net");if(_.isIP&&_.isIP(Z)===0)J.servername=Z;try{X.stream=AH(J)}catch(U){return X.emit("error",U)}X.attachListeners(X.stream),X.stream.on("error",Y),X.emit("sslconnect")})}attachListeners($){wH($,(Z)=>{var X=Z.name==="error"?"errorMessage":Z.name;if(this._emitMessage)this.emit("message",Z);this.emit(X,Z)})}requestSsl(){this.stream.write(f.requestSsl())}startup($){this.stream.write(f.startup($))}cancel($,Z){this._send(f.cancel($,Z))}password($){this._send(f.password($))}sendSASLInitialResponseMessage($,Z){this._send(f.sendSASLInitialResponseMessage($,Z))}sendSCRAMClientFinalMessage($){this._send(f.sendSCRAMClientFinalMessage($))}_send($){if(!this.stream.writable)return!1;return this.stream.write($)}query($){this._send(f.query($))}parse($){this._send(f.parse($))}bind($){this._send(f.bind($))}execute($){this._send(f.execute($))}flush(){if(this.stream.writable)this.stream.write(zH)}sync(){this._ending=!0,this._send(QH)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(SH,()=>{this.stream.end()})}close($){this._send(f.close($))}describe($){this._send(f.describe($))}sendCopyFromChunk($){this._send(f.copyData($))}endCopyFrom(){this._send(f.copyDone())}sendCopyFail($){this._send(f.copyFail($))}}IZ.exports=SZ});var xZ=P((XP,jZ)=>{var hH=function($,Z,X){let Y;if(this.overflow){if(Y=this[G4].write($).split(this.matcher),Y.length===1)return X();Y.shift(),this.overflow=!1}else this[e0]+=this[G4].write($),Y=this[e0].split(this.matcher);this[e0]=Y.pop();for(let G=0;G<Y.length;G++)try{hZ(this,this.mapper(Y[G]))}catch(K){return X(K)}if(this.overflow=this[e0].length>this.maxLength,this.overflow&&!this.skipOverflow){X(new Error("maximum buffer reached"));return}X()},jH=function($){if(this[e0]+=this[G4].end(),this[e0])try{hZ(this,this.mapper(this[e0]))}catch(Z){return $(Z)}$()},hZ=function($,Z){if(Z!==void 0)$.push(Z)},CZ=function($){return $},xH=function($,Z,X){switch($=$||/\r?\n/,Z=Z||CZ,X=X||{},arguments.length){case 1:if(typeof $==="function")Z=$,$=/\r?\n/;else if(typeof $==="object"&&!($ instanceof RegExp)&&!$[Symbol.split])X=$,$=/\r?\n/;break;case 2:if(typeof $==="function")X=Z,Z=$,$=/\r?\n/;else if(typeof Z==="object")X=Z,Z=CZ}X=Object.assign({},X),X.autoDestroy=!0,X.transform=hH,X.flush=jH,X.readableObjectMode=!0;const Y=new IH(X);return Y[e0]="",Y[G4]=new CH("utf8"),Y.matcher=$,Y.mapper=Z,Y.maxLength=X.maxLength,Y.skipOverflow=X.skipOverflow||!1,Y.overflow=!1,Y._destroy=function(G,K){this._writableState.errorEmitted=!1,K(G)},Y},{Transform:IH}=import.meta.require("stream"),{StringDecoder:CH}=import.meta.require("string_decoder"),e0=Symbol("last"),G4=Symbol("decoder");jZ.exports=xH});var NZ=P((dH,c0)=>{var fH=function($){return($&gH)==mH},b5=function(){var $=w8 instanceof vH&&w8.writable===!0;if($){var Z=Array.prototype.slice.call(arguments).concat("\n");w8.write(BZ.format.apply(BZ,Z))}},vZ=import.meta.require("path"),vH=import.meta.require("stream").Stream,BH=xZ(),BZ=import.meta.require("util"),NH=5432,K4=process.platform==="win32",w8=process.stderr,bH=56,yH=7,gH=61440,mH=32768,t1=["host","port","database","user","password"],N5=t1.length,cH=t1[N5-1];Object.defineProperty(dH,"isWin",{get:function(){return K4},set:function($){K4=$}});dH.warnTo=function($){var Z=w8;return w8=$,Z};dH.getFileName=function($){var Z=$||process.env,X=Z.PGPASSFILE||(K4?vZ.join(Z.APPDATA||"./","postgresql","pgpass.conf"):vZ.join(Z.HOME||"./",".pgpass"));return X};dH.usePgPass=function($,Z){if(Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD"))return!1;if(K4)return!0;if(Z=Z||"<unkn>",!fH($.mode))return b5('WARNING: password file "%s" is not a plain file',Z),!1;if($.mode&(bH|yH))return b5('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',Z),!1;return!0};var uH=dH.match=function($,Z){return t1.slice(0,-1).reduce(function(X,Y,G){if(G==1){if(Number($[Y]||NH)===Number(Z[Y]))return X&&!0}return X&&(Z[Y]==="*"||Z[Y]===$[Y])},!0)};dH.getPassword=function($,Z,X){var Y,G=Z.pipe(BH());function K(U){var L=pH(U);if(L&&lH(L)&&uH($,L))Y=L[cH],G.end()}var J=function(){Z.destroy(),X(Y)},_=function(U){Z.destroy(),b5("WARNING: error on reading file: %s",U),X(void 0)};Z.on("error",_),G.on("data",K).on("end",J).on("error",_)};var pH=dH.parseLine=function($){if($.length<11||$.match(/^\s+#/))return null;var Z="",X="",Y=0,G=0,K=0,J={},_=!1,U=function(F,E,h){var K0=$.substring(E,h);if(!Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE"))K0=K0.replace(/\\([:\\])/g,"$1");J[t1[F]]=K0};for(var L=0;L<$.length-1;L+=1){if(Z=$.charAt(L+1),X=$.charAt(L),_=Y==N5-1,_){U(Y,G);break}if(L>=0&&Z==":"&&X!=="\\")U(Y,G,L+1),G=L+2,Y+=1}return J=Object.keys(J).length===N5?J:null,J},lH=dH.isValidEntry=function($){var Z={0:function(J){return J.length>0},1:function(J){if(J==="*")return!0;return J=Number(J),isFinite(J)&&J>0&&J<9007199254740992&&Math.floor(J)===J},2:function(J){return J.length>0},3:function(J){return J.length>0},4:function(J){return J.length>0}};for(var X=0;X<t1.length;X+=1){var Y=Z[X],G=$[t1[X]]||"",K=Y(G);if(!K)return!1}return!0}});var yZ=P((JP,y5)=>{var KP=import.meta.require("path"),bZ=import.meta.require("fs"),J4=NZ();y5.exports=function($,Z){var X=J4.getFileName();bZ.stat(X,function(Y,G){if(Y||!J4.usePgPass(G,X))return Z(void 0);var K=bZ.createReadStream(X);J4.getPassword($,K,Z)})};y5.exports.warnTo=J4.warnTo});var cZ=P((_P,fZ)=>{var nH=import.meta.require("events").EventEmitter,gZ=E8(),g5=C$(),oH=z5(),rH=S5(),mZ=d$(),eH=D8(),$Y=B5(),ZY=A5();class m5 extends nH{constructor($){super();this.connectionParameters=new rH($),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var Z=$||{};if(this._Promise=Z.Promise||global.Promise,this._types=new oH(Z.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=Z.connection||new $Y({stream:Z.stream,ssl:this.connectionParameters.ssl,keepAlive:Z.keepAlive||!1,keepAliveInitialDelayMillis:Z.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=Z.binary||eH.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key)Object.defineProperty(this.ssl,"key",{enumerable:!1});this._connectionTimeoutMillis=Z.connectionTimeoutMillis||0}_errorAllQueries($){const Z=(X)=>{process.nextTick(()=>{X.handleError($,this.connection)})};if(this.activeQuery)Z(this.activeQuery),this.activeQuery=null;this.queryQueue.forEach(Z),this.queryQueue.length=0}_connect($){var Z=this,X=this.connection;if(this._connectionCallback=$,this._connecting||this._connected){const Y=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{$(Y)});return}if(this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0)this.connectionTimeoutHandle=setTimeout(()=>{X._ending=!0,X.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis);if(this.host&&this.host.indexOf("/")===0)X.connect(this.host+"/.s.PGSQL."+this.port);else X.connect(this.port,this.host);X.on("connect",function(){if(Z.ssl)X.requestSsl();else X.startup(Z.getStartupConf())}),X.on("sslconnect",function(){X.startup(Z.getStartupConf())}),this._attachListeners(X),X.once("end",()=>{const Y=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");if(clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(Y),this._ended=!0,!this._ending){if(this._connecting&&!this._connectionError)if(this._connectionCallback)this._connectionCallback(Y);else this._handleErrorEvent(Y);else if(!this._connectionError)this._handleErrorEvent(Y)}process.nextTick(()=>{this.emit("end")})})}connect($){if($){this._connect($);return}return new this._Promise((Z,X)=>{this._connect((Y)=>{if(Y)X(Y);else Z()})})}_attachListeners($){$.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),$.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),$.on("authenticationSASL",this._handleAuthSASL.bind(this)),$.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),$.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),$.on("backendKeyData",this._handleBackendKeyData.bind(this)),$.on("error",this._handleErrorEvent.bind(this)),$.on("errorMessage",this._handleErrorMessage.bind(this)),$.on("readyForQuery",this._handleReadyForQuery.bind(this)),$.on("notice",this._handleNotice.bind(this)),$.on("rowDescription",this._handleRowDescription.bind(this)),$.on("dataRow",this._handleDataRow.bind(this)),$.on("portalSuspended",this._handlePortalSuspended.bind(this)),$.on("emptyQuery",this._handleEmptyQuery.bind(this)),$.on("commandComplete",this._handleCommandComplete.bind(this)),$.on("parseComplete",this._handleParseComplete.bind(this)),$.on("copyInResponse",this._handleCopyInResponse.bind(this)),$.on("copyData",this._handleCopyData.bind(this)),$.on("notification",this._handleNotification.bind(this))}_checkPgPass($){const Z=this.connection;if(typeof this.password==="function")this._Promise.resolve().then(()=>this.password()).then((X)=>{if(X!==void 0){if(typeof X!=="string"){Z.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=X}else this.connectionParameters.password=this.password=null;$()}).catch((X)=>{Z.emit("error",X)});else if(this.password!==null)$();else try{yZ()(this.connectionParameters,(Y)=>{if(Y!==void 0)this.connectionParameters.password=this.password=Y;$()})}catch(X){this.emit("error",X)}}_handleAuthCleartextPassword($){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password($){this._checkPgPass(async()=>{try{const Z=await ZY.postgresMd5PasswordHash(this.user,this.password,$.salt);this.connection.password(Z)}catch(Z){this.emit("error",Z)}})}_handleAuthSASL($){this._checkPgPass(()=>{try{this.saslSession=g5.startSession($.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(Z){this.connection.emit("error",Z)}})}async _handleAuthSASLContinue($){try{await g5.continueSession(this.saslSession,this.password,$.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(Z){this.connection.emit("error",Z)}}_handleAuthSASLFinal($){try{g5.finalizeSession(this.saslSession,$.data),this.saslSession=null}catch(Z){this.connection.emit("error",Z)}}_handleBackendKeyData($){this.processID=$.processID,this.secretKey=$.secretKey}_handleReadyForQuery($){if(this._connecting){if(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)this._connectionCallback(null,this),this._connectionCallback=null;this.emit("connect")}const{activeQuery:Z}=this;if(this.activeQuery=null,this.readyForQuery=!0,Z)Z.handleReadyForQuery(this.connection);this._pulseQueryQueue()}_handleErrorWhileConnecting($){if(this._connectionError)return;if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback($);this.emit("error",$)}_handleErrorEvent($){if(this._connecting)return this._handleErrorWhileConnecting($);this._queryable=!1,this._errorAllQueries($),this.emit("error",$)}_handleErrorMessage($){if(this._connecting)return this._handleErrorWhileConnecting($);const Z=this.activeQuery;if(!Z){this._handleErrorEvent($);return}this.activeQuery=null,Z.handleError($,this.connection)}_handleRowDescription($){this.activeQuery.handleRowDescription($)}_handleDataRow($){this.activeQuery.handleDataRow($)}_handlePortalSuspended($){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery($){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete($){this.activeQuery.handleCommandComplete($,this.connection)}_handleParseComplete($){if(this.activeQuery.name)this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text}_handleCopyInResponse($){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData($){this.activeQuery.handleCopyData($,this.connection)}_handleNotification($){this.emit("notification",$)}_handleNotice($){this.emit("notice",$)}getStartupConf(){var $=this.connectionParameters,Z={user:$.user,database:$.database},X=$.application_name||$.fallback_application_name;if(X)Z.application_name=X;if($.replication)Z.replication=""+$.replication;if($.statement_timeout)Z.statement_timeout=String(parseInt($.statement_timeout,10));if($.lock_timeout)Z.lock_timeout=String(parseInt($.lock_timeout,10));if($.idle_in_transaction_session_timeout)Z.idle_in_transaction_session_timeout=String(parseInt($.idle_in_transaction_session_timeout,10));if($.options)Z.options=$.options;return Z}cancel($,Z){if($.activeQuery===Z){var X=this.connection;if(this.host&&this.host.indexOf("/")===0)X.connect(this.host+"/.s.PGSQL."+this.port);else X.connect(this.port,this.host);X.on("connect",function(){X.cancel($.processID,$.secretKey)})}else if($.queryQueue.indexOf(Z)!==-1)$.queryQueue.splice($.queryQueue.indexOf(Z),1)}setTypeParser($,Z,X){return this._types.setTypeParser($,Z,X)}getTypeParser($,Z){return this._types.getTypeParser($,Z)}escapeIdentifier($){return gZ.escapeIdentifier($)}escapeLiteral($){return gZ.escapeLiteral($)}_pulseQueryQueue(){if(this.readyForQuery===!0){if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;const $=this.activeQuery.submit(this.connection);if($)process.nextTick(()=>{this.activeQuery.handleError($,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else if(this.hasExecuted)this.activeQuery=null,this.emit("drain")}}query($,Z,X){var Y,G,K,J,_;if($===null||$===void 0)throw new TypeError("Client was passed a null or undefined query");else if(typeof $.submit==="function"){if(K=$.query_timeout||this.connectionParameters.query_timeout,G=Y=$,typeof Z==="function")Y.callback=Y.callback||Z}else if(K=this.connectionParameters.query_timeout,Y=new mZ($,Z,X),!Y.callback)G=new this._Promise((U,L)=>{Y.callback=(F,E)=>F?L(F):U(E)}).catch((U)=>{throw Error.captureStackTrace(U),U});if(K)_=Y.callback,J=setTimeout(()=>{var U=new Error("Query read timeout");process.nextTick(()=>{Y.handleError(U,this.connection)}),_(U),Y.callback=()=>{};var L=this.queryQueue.indexOf(Y);if(L>-1)this.queryQueue.splice(L,1);this._pulseQueryQueue()},K),Y.callback=(U,L)=>{clearTimeout(J),_(U,L)};if(this.binary&&!Y.binary)Y.binary=!0;if(Y._result&&!Y._result._types)Y._result._types=this._types;if(!this._queryable)return process.nextTick(()=>{Y.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),G;if(this._ending)return process.nextTick(()=>{Y.handleError(new Error("Client was closed and is not queryable"),this.connection)}),G;return this.queryQueue.push(Y),this._pulseQueryQueue(),G}ref(){this.connection.ref()}unref(){this.connection.unref()}end($){if(this._ending=!0,!this.connection._connecting||this._ended)if($)$();else return this._Promise.resolve();if(this.activeQuery||!this._queryable)this.connection.stream.destroy();else this.connection.end();if($)this.connection.once("end",$);else return new this._Promise((Z)=>{this.connection.once("end",Z)})}}m5.Query=mZ;fZ.exports=m5});var iZ=P((WP,aZ)=>{var HY=function(){throw new Error("Release called on client which has already been released to the pool.")},_4=function($,Z){if(Z)return{callback:Z,result:void 0};let X,Y;const G=function(J,_){J?X(J):Y(_)},K=new $(function(J,_){Y=J,X=_}).catch((J)=>{throw Error.captureStackTrace(J),J});return{callback:G,result:K}},YY=function($,Z){return function X(Y){Y.client=Z,Z.removeListener("error",X),Z.on("error",()=>{$.log("additional client error after disconnection due to error",Y)}),$._remove(Z),$.emit("error",Y,Z)}},XY=import.meta.require("events").EventEmitter,uZ=function(){},pZ=($,Z)=>{const X=$.findIndex(Z);return X===-1?void 0:$.splice(X,1)[0]};class lZ{constructor($,Z,X){this.client=$,this.idleListener=Z,this.timeoutId=X}}class T8{constructor($){this.callback=$}}class dZ extends XY{constructor($,Z){super();if(this.options=Object.assign({},$),$!=null&&"password"in $)Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:$.password});if($!=null&&$.ssl&&$.ssl.key)Object.defineProperty(this.options.ssl,"key",{enumerable:!1});if(this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||Infinity,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||Z||f5().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis==="undefined")this.options.idleTimeoutMillis=1e4;this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){if(this.log("pulse queue on ending"),this._idle.length)this._idle.slice().map((Z)=>{this._remove(Z.client)});if(!this._clients.length)this.ended=!0,this._endCallback();return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;const $=this._pendingQueue.shift();if(this._idle.length){const Z=this._idle.pop();clearTimeout(Z.timeoutId);const X=Z.client;X.ref&&X.ref();const Y=Z.idleListener;return this._acquireClient(X,$,Y,!1)}if(!this._isFull())return this.newClient($);throw new Error("unexpected condition")}_remove($){const Z=pZ(this._idle,(X)=>X.client===$);if(Z!==void 0)clearTimeout(Z.timeoutId);this._clients=this._clients.filter((X)=>X!==$),$.end(),this.emit("remove",$)}connect($){if(this.ending){const Y=new Error("Cannot use a pool after calling end on the pool");return $?$(Y):this.Promise.reject(Y)}const Z=_4(this.Promise,$),X=Z.result;if(this._isFull()||this._idle.length){if(this._idle.length)process.nextTick(()=>this._pulseQueue());if(!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new T8(Z.callback)),X;const Y=(J,_,U)=>{clearTimeout(K),Z.callback(J,_,U)},G=new T8(Y),K=setTimeout(()=>{pZ(this._pendingQueue,(J)=>J.callback===Y),G.timedOut=!0,Z.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(G),X}return this.newClient(new T8(Z.callback)),X}newClient($){const Z=new this.Client(this.options);this._clients.push(Z);const X=YY(this,Z);this.log("checking client timeout");let Y,G=!1;if(this.options.connectionTimeoutMillis)Y=setTimeout(()=>{this.log("ending client due to timeout"),G=!0,Z.connection?Z.connection.stream.destroy():Z.end()},this.options.connectionTimeoutMillis);this.log("connecting new client"),Z.connect((K)=>{if(Y)clearTimeout(Y);if(Z.on("error",X),K){if(this.log("client failed to connect",K),this._clients=this._clients.filter((J)=>J!==Z),G)K.message="Connection terminated due to connection timeout";if(this._pulseQueue(),!$.timedOut)$.callback(K,void 0,uZ)}else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){const J=setTimeout(()=>{if(this.log("ending client due to expired lifetime"),this._expired.add(Z),this._idle.findIndex((U)=>U.client===Z)!==-1)this._acquireClient(Z,new T8((U,L,F)=>F()),X,!1)},this.options.maxLifetimeSeconds*1000);J.unref(),Z.once("end",()=>clearTimeout(J))}return this._acquireClient(Z,$,X,!0)}})}_acquireClient($,Z,X,Y){if(Y)this.emit("connect",$);if(this.emit("acquire",$),$.release=this._releaseOnce($,X),$.removeListener("error",X),!Z.timedOut)if(Y&&this.options.verify)this.options.verify($,(G)=>{if(G)return $.release(G),Z.callback(G,void 0,uZ);Z.callback(void 0,$,$.release)});else Z.callback(void 0,$,$.release);else if(Y&&this.options.verify)this.options.verify($,$.release);else $.release()}_releaseOnce($,Z){let X=!1;return(Y)=>{if(X)HY();X=!0,this._release($,Z,Y)}}_release($,Z,X){if($.on("error",Z),$._poolUseCount=($._poolUseCount||0)+1,this.emit("release",X,$),X||this.ending||!$._queryable||$._ending||$._poolUseCount>=this.options.maxUses){if($._poolUseCount>=this.options.maxUses)this.log("remove expended client");this._remove($),this._pulseQueue();return}if(this._expired.has($)){this.log("remove expired client"),this._expired.delete($),this._remove($),this._pulseQueue();return}let G;if(this.options.idleTimeoutMillis){if(G=setTimeout(()=>{this.log("remove idle client"),this._remove($)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle)G.unref()}if(this.options.allowExitOnIdle)$.unref();this._idle.push(new lZ($,Z,G)),this._pulseQueue()}query($,Z,X){if(typeof $==="function"){const G=_4(this.Promise,$);return setImmediate(function(){return G.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),G.result}if(typeof Z==="function")X=Z,Z=void 0;const Y=_4(this.Promise,X);return X=Y.callback,this.connect((G,K)=>{if(G)return X(G);let J=!1;const _=(U)=>{if(J)return;J=!0,K.release(U),X(U)};K.once("error",_),this.log("dispatching query");try{K.query($,Z,(U,L)=>{if(this.log("query dispatched"),K.removeListener("error",_),J)return;if(J=!0,K.release(U),U)return X(U);return X(void 0,L)})}catch(U){return K.release(U),X(U)}}),Y.result}end($){if(this.log("ending"),this.ending){const X=new Error("Called end on pool more than once");return $?$(X):this.Promise.reject(X)}this.ending=!0;const Z=_4(this.Promise,$);return this._endCallback=Z.callback,this._pulseQueue(),Z.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce(($,Z)=>$+(this._expired.has(Z)?1:0),0)}get totalCount(){return this._clients.length}}aZ.exports=dZ});var nZ=P((UP,sZ)=>{var tZ=import.meta.require("events").EventEmitter,GY=import.meta.require("util"),c5=E8(),s1=sZ.exports=function($,Z,X){tZ.call(this),$=c5.normalizeQueryConfig($,Z,X),this.text=$.text,this.values=$.values,this.name=$.name,this.callback=$.callback,this.state="new",this._arrayMode=$.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(Y){if(Y==="row")this._emitRowEvents=!0}.bind(this))};GY.inherits(s1,tZ);var KY={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};s1.prototype.handleError=function($){var Z=this.native.pq.resultErrorFields();if(Z)for(var X in Z){var Y=KY[X]||X;$[Y]=Z[X]}if(this.callback)this.callback($);else this.emit("error",$);this.state="error"};s1.prototype.then=function($,Z){return this._getPromise().then($,Z)};s1.prototype.catch=function($){return this._getPromise().catch($)};s1.prototype._getPromise=function(){if(this._promise)return this._promise;return this._promise=new Promise(function($,Z){this._once("end",$),this._once("error",Z)}.bind(this)),this._promise};s1.prototype.submit=function($){this.state="running";var Z=this;this.native=$.native,$.native.arrayMode=this._arrayMode;var X=function(K,J,_){if($.native.arrayMode=!1,setImmediate(function(){Z.emit("_done")}),K)return Z.handleError(K);if(Z._emitRowEvents)if(_.length>1)J.forEach((U,L)=>{U.forEach((F)=>{Z.emit("row",F,_[L])})});else J.forEach(function(U){Z.emit("row",U,_)});if(Z.state="end",Z.emit("end",_),Z.callback)Z.callback(null,_)};if(process.domain)X=process.domain.bind(X);if(this.name){if(this.name.length>63)console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries");var Y=(this.values||[]).map(c5.prepareValue);if($.namedQueries[this.name]){if(this.text&&$.namedQueries[this.name]!==this.text){const K=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return X(K)}return $.native.execute(this.name,Y,X)}return $.native.prepare(this.name,this.text,Y.length,function(K){if(K)return X(K);return $.namedQueries[Z.name]=Z.text,Z.native.execute(Z.name,Y,X)})}else if(this.values){if(!Array.isArray(this.values)){const K=new Error("Query values must be an array");return X(K)}var G=this.values.map(c5.prepareValue);$.native.query(this.text,G,X)}else $.native.query(this.text,X)}});var u5=P((LP,$X)=>{var oZ;try{oZ=(()=>{throw new Error(`Cannot require module "pg-native"`);})()}catch($){throw $}var JY=z5(),rZ=import.meta.require("events").EventEmitter,_Y=import.meta.require("util"),WY=S5(),eZ=nZ(),G0=$X.exports=function($){rZ.call(this),$=$||{},this._Promise=$.Promise||global.Promise,this._types=new JY($.types),this.native=new oZ({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var Z=this.connectionParameters=new WY($);if($.nativeConnectionString)Z.nativeConnectionString=$.nativeConnectionString;this.user=Z.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:Z.password}),this.database=Z.database,this.host=Z.host,this.port=Z.port,this.namedQueries={}};G0.Query=eZ;_Y.inherits(G0,rZ);G0.prototype._errorAllQueries=function($){const Z=(X)=>{process.nextTick(()=>{X.native=this.native,X.handleError($)})};if(this._hasActiveQuery())Z(this._activeQuery),this._activeQuery=null;this._queryQueue.forEach(Z),this._queryQueue.length=0};G0.prototype._connect=function($){var Z=this;if(this._connecting){process.nextTick(()=>$(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(X,Y){if(Z.connectionParameters.nativeConnectionString)Y=Z.connectionParameters.nativeConnectionString;if(X)return $(X);Z.native.connect(Y,function(G){if(G)return Z.native.end(),$(G);Z._connected=!0,Z.native.on("error",function(K){Z._queryable=!1,Z._errorAllQueries(K),Z.emit("error",K)}),Z.native.on("notification",function(K){Z.emit("notification",{channel:K.relname,payload:K.extra})}),Z.emit("connect"),Z._pulseQueryQueue(!0),$()})})};G0.prototype.connect=function($){if($){this._connect($);return}return new this._Promise((Z,X)=>{this._connect((Y)=>{if(Y)X(Y);else Z()})})};G0.prototype.query=function($,Z,X){var Y,G,K,J,_;if($===null||$===void 0)throw new TypeError("Client was passed a null or undefined query");else if(typeof $.submit==="function"){if(K=$.query_timeout||this.connectionParameters.query_timeout,G=Y=$,typeof Z==="function")$.callback=Z}else if(K=this.connectionParameters.query_timeout,Y=new eZ($,Z,X),!Y.callback){let U,L;G=new this._Promise((F,E)=>{U=F,L=E}).catch((F)=>{throw Error.captureStackTrace(F),F}),Y.callback=(F,E)=>F?L(F):U(E)}if(K)_=Y.callback,J=setTimeout(()=>{var U=new Error("Query read timeout");process.nextTick(()=>{Y.handleError(U,this.connection)}),_(U),Y.callback=()=>{};var L=this._queryQueue.indexOf(Y);if(L>-1)this._queryQueue.splice(L,1);this._pulseQueryQueue()},K),Y.callback=(U,L)=>{clearTimeout(J),_(U,L)};if(!this._queryable)return Y.native=this.native,process.nextTick(()=>{Y.handleError(new Error("Client has encountered a connection error and is not queryable"))}),G;if(this._ending)return Y.native=this.native,process.nextTick(()=>{Y.handleError(new Error("Client was closed and is not queryable"))}),G;return this._queryQueue.push(Y),this._pulseQueryQueue(),G};G0.prototype.end=function($){var Z=this;if(this._ending=!0,!this._connected)this.once("connect",this.end.bind(this,$));var X;if(!$)X=new this._Promise(function(Y,G){$=(K)=>K?G(K):Y()});return this.native.end(function(){Z._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{if(Z.emit("end"),$)$()})}),X};G0.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};G0.prototype._pulseQueryQueue=function($){if(!this._connected)return;if(this._hasActiveQuery())return;var Z=this._queryQueue.shift();if(!Z){if(!$)this.emit("drain");return}this._activeQuery=Z,Z.submit(this);var X=this;Z.once("_done",function(){X._pulseQueryQueue()})};G0.prototype.cancel=function($){if(this._activeQuery===$)this.native.cancel(function(){});else if(this._queryQueue.indexOf($)!==-1)this._queryQueue.splice(this._queryQueue.indexOf($),1)};G0.prototype.ref=function(){};G0.prototype.unref=function(){};G0.prototype.setTypeParser=function($,Z,X){return this._types.setTypeParser($,Z,X)};G0.prototype.getTypeParser=function($,Z){return this._types.getTypeParser($,Z)}});var f5=P((MP,A8)=>{var UY=cZ(),LY=D8(),MY=B5(),FY=iZ(),{DatabaseError:VY}=x5(),{escapeIdentifier:kY,escapeLiteral:RY}=E8(),qY=($)=>{return class Z extends FY{constructor(X){super(X,$)}}},p5=function($){this.defaults=LY,this.Client=$,this.Query=this.Client.Query,this.Pool=qY(this.Client),this._pools=[],this.Connection=MY,this.types=P8(),this.DatabaseError=VY,this.escapeIdentifier=kY,this.escapeLiteral=RY};if(typeof process.env.NODE_PG_FORCE_NATIVE!=="undefined")A8.exports=new p5(u5());else A8.exports=new p5(UY),Object.defineProperty(A8.exports,"native",{configurable:!0,enumerable:!1,get(){var $=null;try{$=new p5(u5())}catch(Z){if(Z.code!=="MODULE_NOT_FOUND")throw Z}return Object.defineProperty(A8.exports,"native",{value:$}),$}})});function q0($){return typeof $==="undefined"||$===void 0}function j($){return typeof $==="string"}function z8($){return typeof $==="number"}function $1($){return typeof $==="boolean"}function F1($){return $===null}function l5($){return $ instanceof Date}function d5($){return typeof $==="bigint"}function Q($){return typeof $==="function"}function c($){return typeof $==="object"&&$!==null}function a5($){return $[$.length-1]}function H($){return Object.freeze($)}function n1($){if(l($))return $;else return[$]}function l($){return Array.isArray($)}function A0($){return $}var V=H({is($){return $.kind==="IdentifierNode"},create($){return H({kind:"IdentifierNode",name:$})}});function x($){return c($)&&Q($.toOperationNode)}var N=H({is($){return $.kind==="RawNode"},create($,Z){return H({kind:"RawNode",sqlFragments:H($),parameters:H(Z)})},createWithSql($){return N.create([$],[])},createWithChild($){return N.create(["",""],[$])},createWithChildren($){return N.create(new Array($.length+1).fill(""),$)}});var n=H({is($){return $.kind==="ValueNode"},create($){return H({kind:"ValueNode",value:$})},createImmediate($){return H({kind:"ValueNode",value:$,immediate:!0})}});var d=H({is($){return $.kind==="AliasNode"},create($,Z){return H({kind:"AliasNode",node:$,alias:Z})}});var D=H({is($){return $.kind==="ColumnNode"},create($){return H({kind:"ColumnNode",column:V.create($)})}});var V1=H({is($){return $.kind==="SelectAllNode"},create(){return H({kind:"SelectAllNode"})}});var k1=H({is($){return $.kind==="ReferenceNode"},create($,Z){return H({kind:"ReferenceNode",table:Z,column:$})},createSelectAll($){return H({kind:"ReferenceNode",table:$,column:V1.create()})}});var Z0=H({is($){return $.kind==="SchemableIdentifierNode"},create($){return H({kind:"SchemableIdentifierNode",identifier:V.create($)})},createWithSchema($,Z){return H({kind:"SchemableIdentifierNode",schema:V.create($),identifier:V.create(Z)})}});var L0=H({is($){return $.kind==="TableNode"},create($){return H({kind:"TableNode",table:Z0.create($)})},createWithSchema($,Z){return H({kind:"TableNode",table:Z0.createWithSchema($,Z)})}});function i5($){return c($)&&"expressionType"in $&&x($)}function t5($){return c($)&&"expression"in $&&j($.alias)&&x($)}var z0=H({is($){return $.kind==="SelectModifierNode"},create($,Z){return H({kind:"SelectModifierNode",modifier:$,of:Z})},createWithExpression($){return H({kind:"SelectModifierNode",rawModifier:$})}});var X0=H({is($){return $.kind==="AndNode"},create($,Z){return H({kind:"AndNode",left:$,right:Z})}});var P0=H({is($){return $.kind==="OrNode"},create($,Z){return H({kind:"OrNode",left:$,right:Z})}});var Q8=H({is($){return $.kind==="OnNode"},create($){return H({kind:"OnNode",on:$})},cloneWithOperation($,Z,X){return H({...$,on:Z==="And"?X0.create($.on,X):P0.create($.on,X)})}});var u0=H({is($){return $.kind==="JoinNode"},create($,Z){return H({kind:"JoinNode",joinType:$,table:Z,on:void 0})},createWithOn($,Z,X){return H({kind:"JoinNode",joinType:$,table:Z,on:Q8.create(X)})},cloneWithOn($,Z){return H({...$,on:$.on?Q8.cloneWithOperation($.on,"And",Z):Q8.create(Z)})}});function Q0($){if(l($))return $.map((Z)=>p0(Z));else return[p0($)]}function p0($){if(j($))return XX($);else return S8($)}function XX($){if($.includes(" as ")){const[X,Y]=$.split(" as ").map(s5);return d.create(T(X),V.create(Y))}else return T($)}function T($){if($.includes(".")){const[X,Y]=$.split(".").map(s5);return L0.createWithSchema(X,Y)}else return L0.create($)}var s5=function($){return $.trim()};var l0=H({is($){return $.kind==="BinaryOperationNode"},create($,Z,X){return H({kind:"BinaryOperationNode",leftOperand:$,operator:Z,rightOperand:X})}});function L4($){return j($)&&n5.includes($)}var HX=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],YX=["+","-","*","/","%","^","&","|","#","<<",">>"],n5=["->","->>"],GX=[...HX,...YX,"&&","||"],KX=["exists","not exists"],JX=["not","-",...KX],o5=[...GX,...n5,...JX,"between","between symmetric"],J0=H({is($){return $.kind==="OperatorNode"},create($){return H({kind:"OperatorNode",operator:$})}});var I8=H({is($){return $.kind==="PrimitiveValueListNode"},create($){return H({kind:"PrimitiveValueListNode",values:H([...$])})}});var R1=H({is($){return $.kind==="ValueListNode"},create($){return H({kind:"ValueListNode",values:H($)})}});function r5($){if(l($))return _X($);return z($)}function z($){if(j0($))return H0($);return n.create($)}function C8($){return z8($)||$1($)||F1($)}function o1($){if(!C8($))throw new Error(`unsafe immediate value ${JSON.stringify($)}`);return n.createImmediate($)}var _X=function($){if($.some(j0))return R1.create($.map((Z)=>z(Z)));return I8.create($)};var S0=H({is($){return $.kind==="ParensNode"},create($){return H({kind:"ParensNode",node:$})}});function S($){if($.length===3)return h8($[0],$[1],$[2]);else if($.length===1)return z($[0]);throw new Error(`invalid arguments: ${JSON.stringify($)}`)}function h8($,Z,X){if(WX(Z)&&$9(X))return l0.create(a($),M4(Z),n.createImmediate(X));return l0.create(a($),M4(Z),r5(X))}function i($,Z,X){return l0.create(a($),M4(Z),a(X))}function F4($,Z){return j8(Object.entries($).filter(([,X])=>!q0(X)).map(([X,Y])=>h8(X,$9(Y)?"is":"=",Y)),Z)}function j8($,Z){const X=Z==="and"?X0.create:P0.create;if($.length===0)return l0.create(n.createImmediate(1),J0.create("="),n.createImmediate(Z==="and"?1:0));let Y=e5($[0]);for(let G=1;G<$.length;++G)Y=X(Y,e5($[G]));if($.length>1)return S0.create(Y);return Y}var WX=function($){return $==="is"||$==="is not"},$9=function($){return F1($)||$1($)},M4=function($){if(j($)&&o5.includes($))return J0.create($);if(x($))return $.toOperationNode();throw new Error(`invalid operator ${JSON.stringify($)}`)},e5=function($){return x($)?$.toOperationNode():$};var x0=H({is($){return $.kind==="OrderByNode"},create($){return H({kind:"OrderByNode",items:H([...$])})},cloneWithItems($,Z){return H({...$,items:H([...$.items,...Z])})}});var V4=H({is($){return $.kind==="PartitionByNode"},create($){return H({kind:"PartitionByNode",items:H($)})},cloneWithItems($,Z){return H({...$,items:H([...$.items,...Z])})}});var r1=H({is($){return $.kind==="OverNode"},create(){return H({kind:"OverNode"})},cloneWithOrderByItems($,Z){return H({...$,orderBy:$.orderBy?x0.cloneWithItems($.orderBy,Z):x0.create(Z)})},cloneWithPartitionByItems($,Z){return H({...$,partitionBy:$.partitionBy?V4.cloneWithItems($.partitionBy,Z):V4.create(Z)})}});var Z1=H({is($){return $.kind==="FromNode"},create($){return H({kind:"FromNode",froms:H($)})},cloneWithFroms($,Z){return H({...$,froms:H([...$.froms,...Z])})}});var k4=H({is($){return $.kind==="GroupByNode"},create($){return H({kind:"GroupByNode",items:H($)})},cloneWithItems($,Z){return H({...$,items:H([...$.items,...Z])})}});var R4=H({is($){return $.kind==="HavingNode"},create($){return H({kind:"HavingNode",having:$})},cloneWithOperation($,Z,X){return H({...$,having:Z==="And"?X0.create($.having,X):P0.create($.having,X)})}});var q=H({is($){return $.kind==="SelectQueryNode"},create($){return H({kind:"SelectQueryNode",...$&&{with:$}})},createFrom($,Z){return H({kind:"SelectQueryNode",from:Z1.create($),...Z&&{with:Z}})},cloneWithSelections($,Z){return H({...$,selections:$.selections?H([...$.selections,...Z]):H(Z)})},cloneWithDistinctOn($,Z){return H({...$,distinctOn:$.distinctOn?H([...$.distinctOn,...Z]):H(Z)})},cloneWithFrontModifier($,Z){return H({...$,frontModifiers:$.frontModifiers?H([...$.frontModifiers,Z]):H([Z])})},cloneWithEndModifier($,Z){return H({...$,endModifiers:$.endModifiers?H([...$.endModifiers,Z]):H([Z])})},cloneWithOrderByItems($,Z){return H({...$,orderBy:$.orderBy?x0.cloneWithItems($.orderBy,Z):x0.create(Z)})},cloneWithGroupByItems($,Z){return H({...$,groupBy:$.groupBy?k4.cloneWithItems($.groupBy,Z):k4.create(Z)})},cloneWithLimit($,Z){return H({...$,limit:Z})},cloneWithOffset($,Z){return H({...$,offset:Z})},cloneWithHaving($,Z){return H({...$,having:$.having?R4.cloneWithOperation($.having,"And",Z):R4.create(Z)})},cloneWithSetOperations($,Z){return H({...$,setOperations:$.setOperations?H([...$.setOperations,...Z]):H([...Z])})},cloneWithoutSelections($){return H({...$,selections:[]})},cloneWithoutLimit($){return H({...$,limit:void 0})},cloneWithoutOffset($){return H({...$,offset:void 0})},cloneWithoutOrderBy($){return H({...$,orderBy:void 0})}});function M($,Z){Object.defineProperties($.prototype,{then:{enumerable:!1,value:()=>{throw new Error(Z)}}})}class X1{#$;constructor($){this.#$=H($)}on(...$){return new X1({...this.#$,joinNode:u0.cloneWithOn(this.#$.joinNode,S($))})}onRef($,Z,X){return new X1({...this.#$,joinNode:u0.cloneWithOn(this.#$.joinNode,i($,Z,X))})}onTrue(){return new X1({...this.#$,joinNode:u0.cloneWithOn(this.#$.joinNode,N.createWithSql("true"))})}$call($){return $(this)}toOperationNode(){return this.#$.joinNode}}M(X1,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");function x8($){return c($)&&x($)&&j($.dynamicReference)}class q4{#$;get dynamicReference(){return this.#$}get refType(){return}constructor($){this.#$=$}toOperationNode(){return P4(this.#$)}}var v8=H({is($){return $.kind==="OrderByItemNode"},create($,Z){return H({kind:"OrderByItemNode",orderBy:$,direction:Z})}});function E4($){return $==="asc"||$==="desc"}function d0($){if($.length===2)return[D4($[0],$[1])];if($.length===1){const[Z]=$;if(Array.isArray(Z))return Z.map((X)=>D4(X));return[D4(Z)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${$.length}`)}function D4($,Z){const X=UX($);if(v8.is(X)){if(Z)throw new Error("Cannot specify direction twice!");return X}return v8.create(X,Z9(Z))}var UX=function($){if(j0($))return H0($);if(x8($))return $.toOperationNode();const[Z,X]=$.split(" ");if(X){if(!E4(X))throw new Error(`Invalid order by direction: ${X}`);return v8.create(_0(Z),Z9(X))}return _0($)},Z9=function($){if(!$)return;if($==="asc"||$==="desc")return N.createWithSql($);return $.toOperationNode()};var X9=H({is($){return $.kind==="PartitionByItemNode"},create($){return H({kind:"PartitionByItemNode",partitionBy:$})}});function H9($){return v0($).map(X9.create)}class q1{#$;constructor($){this.#$=H($)}orderBy($,Z){return new q1({overNode:r1.cloneWithOrderByItems(this.#$.overNode,d0([$,Z]))})}partitionBy($){return new q1({overNode:r1.cloneWithPartitionByItems(this.#$.overNode,H9($))})}$call($){return $(this)}toOperationNode(){return this.#$.overNode}}M(q1,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");var P1=H({is($){return $.kind==="SelectionNode"},create($){return H({kind:"SelectionNode",selection:$})},createSelectAll(){return H({kind:"SelectionNode",selection:V1.create()})},createSelectAllFromTable($){return H({kind:"SelectionNode",selection:k1.createSelectAll($)})}});function D0($){if(Q($))return D0($(E0()));else if(l($))return $.map((Z)=>Y9(Z));else return[Y9($)]}var Y9=function($){if(j($))return P1.create(K9($));else if(x8($))return P1.create($.toOperationNode());else return P1.create(S8($))};function I0($){if(!$)return[P1.createSelectAll()];else if(Array.isArray($))return $.map(G9);else return[G9($)]}var G9=function($){if(j($))return P1.createSelectAllFromTable(T($));throw new Error(`invalid value selectAll expression: ${JSON.stringify($)}`)};var J9=H({is($){return $.kind==="ValuesNode"},create($){return H({kind:"ValuesNode",values:H($)})}});var _9=H({is($){return $.kind==="DefaultInsertValueNode"},create(){return H({kind:"DefaultInsertValueNode"})}});function W9($){const Z=Q($)?$(E0()):$,X=l(Z)?Z:H([Z]);return LX(X)}var LX=function($){const Z=MX($);return[H([...Z.keys()].map(D.create)),J9.create($.map((X)=>FX(X,Z)))]},MX=function($){const Z=new Map;for(let X of $){const Y=Object.keys(X);for(let G of Y)if(!Z.has(G)&&X[G]!==void 0)Z.set(G,Z.size)}return Z},FX=function($,Z){const X=Object.keys($),Y=Array.from({length:Z.size});let G=!1;for(let J of X){const _=Z.get(J);if(q0(_))continue;const U=$[J];if(q0(U)||j0(U))G=!0;Y[_]=U}if(X.length<Z.size||G){const J=_9.create();return R1.create(Y.map((_)=>q0(_)?J:z(_)))}return I8.create(Y)};var o=H({is($){return $.kind==="InsertQueryNode"},create($,Z,X){return H({kind:"InsertQueryNode",into:$,...Z&&{with:Z},replace:X})},cloneWith($,Z){return H({...$,...Z})}});var H1=H({is($){return $.kind==="UpdateQueryNode"},create($,Z){return H({kind:"UpdateQueryNode",table:$,...Z&&{with:Z}})},cloneWithFromItems($,Z){return H({...$,from:$.from?Z1.cloneWithFroms($.from,Z):Z1.create(Z)})},cloneWithUpdates($,Z){return H({...$,updates:$.updates?H([...$.updates,...Z]):Z})}});var O4=H({is($){return $.kind==="UsingNode"},create($){return H({kind:"UsingNode",tables:H($)})},cloneWithTables($,Z){return H({...$,tables:H([...$.tables,...Z])})}});var a0=H({is($){return $.kind==="DeleteQueryNode"},create($,Z){return H({kind:"DeleteQueryNode",from:Z1.create($),...Z&&{with:Z}})},cloneWithOrderByItems($,Z){return H({...$,orderBy:$.orderBy?x0.cloneWithItems($.orderBy,Z):x0.create(Z)})},cloneWithLimit($,Z){return H({...$,limit:Z})},cloneWithUsing($,Z){return H({...$,using:$.using!==void 0?O4.cloneWithTables($.using,Z):O4.create(Z)})}});var u=H({is($){return $.kind==="WhereNode"},create($){return H({kind:"WhereNode",where:$})},cloneWithOperation($,Z,X){return H({...$,where:Z==="And"?X0.create($.where,X):P0.create($.where,X)})}});var w4=H({is($){return $.kind==="ReturningNode"},create($){return H({kind:"ReturningNode",selections:H($)})},cloneWithSelections($,Z){return H({...$,selections:$.selections?H([...$.selections,...Z]):H(Z)})}});var U9=H({is($){return $.kind==="ExplainNode"},create($,Z){return H({kind:"ExplainNode",format:$,options:Z})}});var R=H({is($){return q.is($)||o.is($)||H1.is($)||a0.is($)},cloneWithWhere($,Z){return H({...$,where:$.where?u.cloneWithOperation($.where,"And",Z):u.create(Z)})},cloneWithJoin($,Z){return H({...$,joins:$.joins?H([...$.joins,Z]):H([Z])})},cloneWithReturning($,Z){return H({...$,returning:$.returning?w4.cloneWithSelections($.returning,Z):w4.create(Z)})},cloneWithoutWhere($){return H({...$,where:void 0})},cloneWithExplain($,Z,X){return H({...$,explain:U9.create(Z,X?.toOperationNode())})}});var T4=H({is($){return $.kind==="ColumnUpdateNode"},create($,Z){return H({kind:"ColumnUpdateNode",column:$,value:Z})}});function L9(...$){if($.length===2)return[T4.create(a($[0]),z($[1]))];return e1($[0])}function e1($){const Z=Q($)?$(E0()):$;return Object.entries(Z).filter(([X,Y])=>Y!==void 0).map(([X,Y])=>{return T4.create(D.create(X),z(Y))})}var M9=H({is($){return $.kind==="OnDuplicateKeyNode"},create($){return H({kind:"OnDuplicateKeyNode",updates:$})}});class A4{insertId;numInsertedOrUpdatedRows;constructor($,Z){this.insertId=$,this.numInsertedOrUpdatedRows=Z}}function i0($){return Object.prototype.hasOwnProperty.call($,"prototype")}class B0 extends Error{node;constructor($){super("no result");this.node=$}}var r=H({is($){return $.kind==="OnConflictNode"},create(){return H({kind:"OnConflictNode"})},cloneWith($,Z){return H({...$,...Z})},cloneWithIndexWhere($,Z){return H({...$,indexWhere:$.indexWhere?u.cloneWithOperation($.indexWhere,"And",Z):u.create(Z)})},cloneWithIndexOrWhere($,Z){return H({...$,indexWhere:$.indexWhere?u.cloneWithOperation($.indexWhere,"Or",Z):u.create(Z)})},cloneWithUpdateWhere($,Z){return H({...$,updateWhere:$.updateWhere?u.cloneWithOperation($.updateWhere,"And",Z):u.create(Z)})},cloneWithUpdateOrWhere($,Z){return H({...$,updateWhere:$.updateWhere?u.cloneWithOperation($.updateWhere,"Or",Z):u.create(Z)})},cloneWithoutIndexWhere($){return H({...$,indexWhere:void 0})},cloneWithoutUpdateWhere($){return H({...$,updateWhere:void 0})}});class O0{#$;constructor($){this.#$=H($)}column($){const Z=D.create($);return new O0({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{columns:this.#$.onConflictNode.columns?H([...this.#$.onConflictNode.columns,Z]):H([Z])})})}columns($){const Z=$.map(D.create);return new O0({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{columns:this.#$.onConflictNode.columns?H([...this.#$.onConflictNode.columns,...Z]):H(Z)})})}constraint($){return new O0({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{constraint:V.create($)})})}expression($){return new O0({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{indexExpression:$.toOperationNode()})})}where(...$){return new O0({...this.#$,onConflictNode:r.cloneWithIndexWhere(this.#$.onConflictNode,S($))})}whereRef($,Z,X){return new O0({...this.#$,onConflictNode:r.cloneWithIndexWhere(this.#$.onConflictNode,i($,Z,X))})}clearWhere(){return new O0({...this.#$,onConflictNode:r.cloneWithoutIndexWhere(this.#$.onConflictNode)})}doNothing(){return new z4({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{doNothing:!0})})}doUpdateSet($){return new D1({...this.#$,onConflictNode:r.cloneWith(this.#$.onConflictNode,{updates:e1($)})})}$call($){return $(this)}}M(O0,"don't await OnConflictBuilder instances.");class z4{#$;constructor($){this.#$=H($)}toOperationNode(){return this.#$.onConflictNode}}M(z4,"don't await OnConflictDoNothingBuilder instances.");class D1{#$;constructor($){this.#$=H($)}where(...$){return new D1({...this.#$,onConflictNode:r.cloneWithUpdateWhere(this.#$.onConflictNode,S($))})}whereRef($,Z,X){return new D1({...this.#$,onConflictNode:r.cloneWithUpdateWhere(this.#$.onConflictNode,i($,Z,X))})}clearWhere(){return new D1({...this.#$,onConflictNode:r.cloneWithoutUpdateWhere(this.#$.onConflictNode)})}$call($){return $(this)}toOperationNode(){return this.#$.onConflictNode}}M(D1,"don't await OnConflictUpdateBuilder instances.");class m{#$;constructor($){this.#$=H($)}values($){const[Z,X]=W9($);return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{columns:Z,values:X})})}columns($){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{columns:H($.map(D.create))})})}expression($){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{values:H0($)})})}defaultValues(){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{defaultValues:!0})})}ignore(){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{ignore:!0})})}onConflict($){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{onConflict:$(new O0({onConflictNode:r.create()})).toOperationNode()})})}onDuplicateKeyUpdate($){return new m({...this.#$,queryNode:o.cloneWith(this.#$.queryNode,{onDuplicateKey:M9.create(e1($))})})}returning($){return new m({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,D0($))})}returningAll(){return new m({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,I0())})}$call($){return $(this)}$if($,Z){if($)return Z(this);return new m({...this.#$})}$castTo(){return new m(this.#$)}$narrowType(){return new m(this.#$)}$assertType(){return new m(this.#$)}withPlugin($){return new m({...this.#$,executor:this.#$.executor.withPlugin($)})}toOperationNode(){return this.#$.executor.transformQuery(this.#$.queryNode,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){const $=this.compile(),Z=$.query,X=await this.#$.executor.executeQuery($,this.#$.queryId);if(this.#$.executor.adapter.supportsReturning&&Z.returning)return X.rows;return[new A4(X.insertId,X.numAffectedRows??X.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[$]=await this.execute();return $}async executeTakeFirstOrThrow($=B0){const Z=await this.executeTakeFirst();if(Z===void 0)throw i0($)?new $(this.toOperationNode()):$(this.toOperationNode());return Z}async*stream($=100){const Z=this.compile(),X=this.#$.executor.stream(Z,$,this.#$.queryId);for await(let Y of X)yield*Y.rows}async explain($,Z){return await new m({...this.#$,queryNode:R.cloneWithExplain(this.#$.queryNode,$,Z)}).execute()}}M(m,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Q4{numDeletedRows;constructor($){this.numDeletedRows=$}}var B8=H({is($){return $.kind==="LimitNode"},create($){return H({kind:"LimitNode",limit:$})}});class b{#$;constructor($){this.#$=H($)}where(...$){return new b({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,S($))})}whereRef($,Z,X){return new b({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,i($,Z,X))})}clearWhere(){return new b({...this.#$,queryNode:R.cloneWithoutWhere(this.#$.queryNode)})}using($){return new b({...this.#$,queryNode:a0.cloneWithUsing(this.#$.queryNode,Q0($))})}innerJoin(...$){return new b({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("InnerJoin",$))})}leftJoin(...$){return new b({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("LeftJoin",$))})}rightJoin(...$){return new b({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("RightJoin",$))})}fullJoin(...$){return new b({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("FullJoin",$))})}returning($){return new b({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,D0($))})}returningAll($){return new b({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,I0($))})}orderBy($,Z){return new b({...this.#$,queryNode:a0.cloneWithOrderByItems(this.#$.queryNode,d0([$,Z]))})}limit($){return new b({...this.#$,queryNode:a0.cloneWithLimit(this.#$.queryNode,B8.create(z($)))})}$call($){return $(this)}$if($,Z){if($)return Z(this);return new b({...this.#$})}$castTo(){return new b(this.#$)}$narrowType(){return new b(this.#$)}$assertType(){return new b(this.#$)}withPlugin($){return new b({...this.#$,executor:this.#$.executor.withPlugin($)})}toOperationNode(){return this.#$.executor.transformQuery(this.#$.queryNode,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){const $=this.compile(),Z=$.query,X=await this.#$.executor.executeQuery($,this.#$.queryId);if(this.#$.executor.adapter.supportsReturning&&Z.returning)return X.rows;return[new Q4(X.numAffectedRows??X.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[$]=await this.execute();return $}async executeTakeFirstOrThrow($=B0){const Z=await this.executeTakeFirst();if(Z===void 0)throw i0($)?new $(this.toOperationNode()):$(this.toOperationNode());return Z}async*stream($=100){const Z=this.compile(),X=this.#$.executor.stream(Z,$,this.#$.queryId);for await(let Y of X)yield*Y.rows}async explain($,Z){return await new b({...this.#$,queryNode:R.cloneWithExplain(this.#$.queryNode,$,Z)}).execute()}}M(b,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class S4{numUpdatedRows;numChangedRows;constructor($,Z){this.numUpdatedRows=$,this.numChangedRows=Z}}class g{#$;constructor($){this.#$=H($)}where(...$){return new g({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,S($))})}whereRef($,Z,X){return new g({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,i($,Z,X))})}clearWhere(){return new g({...this.#$,queryNode:R.cloneWithoutWhere(this.#$.queryNode)})}from($){return new g({...this.#$,queryNode:H1.cloneWithFromItems(this.#$.queryNode,Q0($))})}innerJoin(...$){return new g({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("InnerJoin",$))})}leftJoin(...$){return new g({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("LeftJoin",$))})}rightJoin(...$){return new g({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("RightJoin",$))})}fullJoin(...$){return new g({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("FullJoin",$))})}set(...$){return new g({...this.#$,queryNode:H1.cloneWithUpdates(this.#$.queryNode,L9(...$))})}returning($){return new g({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,D0($))})}returningAll(){return new g({...this.#$,queryNode:R.cloneWithReturning(this.#$.queryNode,I0())})}$call($){return $(this)}$if($,Z){if($)return Z(this);return new g({...this.#$})}$castTo(){return new g(this.#$)}$narrowType(){return new g(this.#$)}$assertType(){return new g(this.#$)}withPlugin($){return new g({...this.#$,executor:this.#$.executor.withPlugin($)})}toOperationNode(){return this.#$.executor.transformQuery(this.#$.queryNode,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){const $=this.compile(),Z=$.query,X=await this.#$.executor.executeQuery($,this.#$.queryId);if(this.#$.executor.adapter.supportsReturning&&Z.returning)return X.rows;return[new S4(X.numAffectedRows??X.numUpdatedOrDeletedRows??BigInt(0),X.numChangedRows)]}async executeTakeFirst(){const[$]=await this.execute();return $}async executeTakeFirstOrThrow($=B0){const Z=await this.executeTakeFirst();if(Z===void 0)throw i0($)?new $(this.toOperationNode()):$(this.toOperationNode());return Z}async*stream($=100){const Z=this.compile(),X=this.#$.executor.stream(Z,$,this.#$.queryId);for await(let Y of X)yield*Y.rows}async explain($,Z){return await new g({...this.#$,queryNode:R.cloneWithExplain(this.#$.queryNode,$,Z)}).execute()}}M(g,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");var I4=H({is($){return $.kind==="CommonTableExpressionNameNode"},create($,Z){return H({kind:"CommonTableExpressionNameNode",table:L0.create($),columns:Z?H(Z.map(D.create)):void 0})}});var E1=H({is($){return $.kind==="CommonTableExpressionNode"},create($,Z){return H({kind:"CommonTableExpressionNode",name:$,expression:Z})},cloneWith($,Z){return H({...$,...Z})}});class O1{#$;constructor($){this.#$=H($)}materialized(){return new O1({...this.#$,node:E1.cloneWith(this.#$.node,{materialized:!0})})}notMaterialized(){return new O1({...this.#$,node:E1.cloneWith(this.#$.node,{materialized:!1})})}toOperationNode(){return this.#$.node}}M(O1,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");function C4($,Z){const X=Z(V9()).toOperationNode();if(Q($))return $(VX(X)).toOperationNode();return E1.create(F9($),X)}var VX=function($){return(Z)=>{return new O1({node:E1.create(F9(Z),$)})}},F9=function($){if($.includes("(")){const Z=$.split(/[\(\)]/),X=Z[0],Y=Z[1].split(",").map((G)=>G.trim());return I4.create(X,Y)}else return I4.create($)};var $8=H({is($){return $.kind==="WithNode"},create($,Z){return H({kind:"WithNode",expressions:H([$]),...Z})},cloneWithExpression($,Z){return H({...$,expressions:H([...$.expressions,Z])})}});function R9($){let Z="";for(let X=0;X<$;++X)Z+=kX();return Z}var kX=function(){return k9[~~(Math.random()*k9.length)]},k9=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function O(){return new q9}class q9{#$;get queryId(){if(this.#$===void 0)this.#$=R9(8);return this.#$}}function W($){return $}class Z8{nodeStack=[];#$=H({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),AddIndexNode:this.transformAddIndex.bind(this)});transformNode($){if(!$)return $;this.nodeStack.push($);const Z=this.transformNodeImpl($);return this.nodeStack.pop(),H(Z)}transformNodeImpl($){return this.#$[$.kind]($)}transformNodeList($){if(!$)return $;return H($.map((Z)=>this.transformNode(Z)))}transformSelectQuery($){return W({kind:"SelectQueryNode",from:this.transformNode($.from),selections:this.transformNodeList($.selections),distinctOn:this.transformNodeList($.distinctOn),joins:this.transformNodeList($.joins),groupBy:this.transformNode($.groupBy),orderBy:this.transformNode($.orderBy),where:this.transformNode($.where),frontModifiers:this.transformNodeList($.frontModifiers),endModifiers:this.transformNodeList($.endModifiers),limit:this.transformNode($.limit),offset:this.transformNode($.offset),with:this.transformNode($.with),having:this.transformNode($.having),explain:this.transformNode($.explain),setOperations:this.transformNodeList($.setOperations)})}transformSelection($){return W({kind:"SelectionNode",selection:this.transformNode($.selection)})}transformColumn($){return W({kind:"ColumnNode",column:this.transformNode($.column)})}transformAlias($){return W({kind:"AliasNode",node:this.transformNode($.node),alias:this.transformNode($.alias)})}transformTable($){return W({kind:"TableNode",table:this.transformNode($.table)})}transformFrom($){return W({kind:"FromNode",froms:this.transformNodeList($.froms)})}transformReference($){return W({kind:"ReferenceNode",column:this.transformNode($.column),table:this.transformNode($.table)})}transformAnd($){return W({kind:"AndNode",left:this.transformNode($.left),right:this.transformNode($.right)})}transformOr($){return W({kind:"OrNode",left:this.transformNode($.left),right:this.transformNode($.right)})}transformValueList($){return W({kind:"ValueListNode",values:this.transformNodeList($.values)})}transformParens($){return W({kind:"ParensNode",node:this.transformNode($.node)})}transformJoin($){return W({kind:"JoinNode",joinType:$.joinType,table:this.transformNode($.table),on:this.transformNode($.on)})}transformRaw($){return W({kind:"RawNode",sqlFragments:H([...$.sqlFragments]),parameters:this.transformNodeList($.parameters)})}transformWhere($){return W({kind:"WhereNode",where:this.transformNode($.where)})}transformInsertQuery($){return W({kind:"InsertQueryNode",into:this.transformNode($.into),columns:this.transformNodeList($.columns),values:this.transformNode($.values),returning:this.transformNode($.returning),onConflict:this.transformNode($.onConflict),onDuplicateKey:this.transformNode($.onDuplicateKey),with:this.transformNode($.with),ignore:$.ignore,replace:$.replace,explain:this.transformNode($.explain),defaultValues:$.defaultValues})}transformValues($){return W({kind:"ValuesNode",values:this.transformNodeList($.values)})}transformDeleteQuery($){return W({kind:"DeleteQueryNode",from:this.transformNode($.from),using:this.transformNode($.using),joins:this.transformNodeList($.joins),where:this.transformNode($.where),returning:this.transformNode($.returning),with:this.transformNode($.with),orderBy:this.transformNode($.orderBy),limit:this.transformNode($.limit),explain:this.transformNode($.explain)})}transformReturning($){return W({kind:"ReturningNode",selections:this.transformNodeList($.selections)})}transformCreateTable($){return W({kind:"CreateTableNode",table:this.transformNode($.table),columns:this.transformNodeList($.columns),constraints:this.transformNodeList($.constraints),temporary:$.temporary,ifNotExists:$.ifNotExists,onCommit:$.onCommit,frontModifiers:this.transformNodeList($.frontModifiers),endModifiers:this.transformNodeList($.endModifiers),selectQuery:this.transformNode($.selectQuery)})}transformColumnDefinition($){return W({kind:"ColumnDefinitionNode",column:this.transformNode($.column),dataType:this.transformNode($.dataType),references:this.transformNode($.references),primaryKey:$.primaryKey,autoIncrement:$.autoIncrement,unique:$.unique,notNull:$.notNull,unsigned:$.unsigned,defaultTo:this.transformNode($.defaultTo),check:this.transformNode($.check),generated:this.transformNode($.generated),frontModifiers:this.transformNodeList($.frontModifiers),endModifiers:this.transformNodeList($.endModifiers),nullsNotDistinct:$.nullsNotDistinct})}transformAddColumn($){return W({kind:"AddColumnNode",column:this.transformNode($.column)})}transformDropTable($){return W({kind:"DropTableNode",table:this.transformNode($.table),ifExists:$.ifExists,cascade:$.cascade})}transformOrderBy($){return W({kind:"OrderByNode",items:this.transformNodeList($.items)})}transformOrderByItem($){return W({kind:"OrderByItemNode",orderBy:this.transformNode($.orderBy),direction:this.transformNode($.direction)})}transformGroupBy($){return W({kind:"GroupByNode",items:this.transformNodeList($.items)})}transformGroupByItem($){return W({kind:"GroupByItemNode",groupBy:this.transformNode($.groupBy)})}transformUpdateQuery($){return W({kind:"UpdateQueryNode",table:this.transformNode($.table),from:this.transformNode($.from),joins:this.transformNodeList($.joins),where:this.transformNode($.where),updates:this.transformNodeList($.updates),returning:this.transformNode($.returning),with:this.transformNode($.with),explain:this.transformNode($.explain)})}transformColumnUpdate($){return W({kind:"ColumnUpdateNode",column:this.transformNode($.column),value:this.transformNode($.value)})}transformLimit($){return W({kind:"LimitNode",limit:this.transformNode($.limit)})}transformOffset($){return W({kind:"OffsetNode",offset:this.transformNode($.offset)})}transformOnConflict($){return W({kind:"OnConflictNode",columns:this.transformNodeList($.columns),constraint:this.transformNode($.constraint),indexExpression:this.transformNode($.indexExpression),indexWhere:this.transformNode($.indexWhere),updates:this.transformNodeList($.updates),updateWhere:this.transformNode($.updateWhere),doNothing:$.doNothing})}transformOnDuplicateKey($){return W({kind:"OnDuplicateKeyNode",updates:this.transformNodeList($.updates)})}transformCreateIndex($){return W({kind:"CreateIndexNode",name:this.transformNode($.name),table:this.transformNode($.table),columns:this.transformNodeList($.columns),unique:$.unique,using:this.transformNode($.using),ifNotExists:$.ifNotExists,where:this.transformNode($.where),nullsNotDistinct:$.nullsNotDistinct})}transformList($){return W({kind:"ListNode",items:this.transformNodeList($.items)})}transformDropIndex($){return W({kind:"DropIndexNode",name:this.transformNode($.name),table:this.transformNode($.table),ifExists:$.ifExists,cascade:$.cascade})}transformPrimaryKeyConstraint($){return W({kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList($.columns),name:this.transformNode($.name)})}transformUniqueConstraint($){return W({kind:"UniqueConstraintNode",columns:this.transformNodeList($.columns),name:this.transformNode($.name),nullsNotDistinct:$.nullsNotDistinct})}transformForeignKeyConstraint($){return W({kind:"ForeignKeyConstraintNode",columns:this.transformNodeList($.columns),references:this.transformNode($.references),name:this.transformNode($.name),onDelete:$.onDelete,onUpdate:$.onUpdate})}transformSetOperation($){return W({kind:"SetOperationNode",operator:$.operator,expression:this.transformNode($.expression),all:$.all})}transformReferences($){return W({kind:"ReferencesNode",table:this.transformNode($.table),columns:this.transformNodeList($.columns),onDelete:$.onDelete,onUpdate:$.onUpdate})}transformCheckConstraint($){return W({kind:"CheckConstraintNode",expression:this.transformNode($.expression),name:this.transformNode($.name)})}transformWith($){return W({kind:"WithNode",expressions:this.transformNodeList($.expressions),recursive:$.recursive})}transformCommonTableExpression($){return W({kind:"CommonTableExpressionNode",name:this.transformNode($.name),materialized:$.materialized,expression:this.transformNode($.expression)})}transformCommonTableExpressionName($){return W({kind:"CommonTableExpressionNameNode",table:this.transformNode($.table),columns:this.transformNodeList($.columns)})}transformHaving($){return W({kind:"HavingNode",having:this.transformNode($.having)})}transformCreateSchema($){return W({kind:"CreateSchemaNode",schema:this.transformNode($.schema),ifNotExists:$.ifNotExists})}transformDropSchema($){return W({kind:"DropSchemaNode",schema:this.transformNode($.schema),ifExists:$.ifExists,cascade:$.cascade})}transformAlterTable($){return W({kind:"AlterTableNode",table:this.transformNode($.table),renameTo:this.transformNode($.renameTo),setSchema:this.transformNode($.setSchema),columnAlterations:this.transformNodeList($.columnAlterations),addConstraint:this.transformNode($.addConstraint),dropConstraint:this.transformNode($.dropConstraint),addIndex:this.transformNode($.addIndex),dropIndex:this.transformNode($.dropIndex)})}transformDropColumn($){return W({kind:"DropColumnNode",column:this.transformNode($.column)})}transformRenameColumn($){return W({kind:"RenameColumnNode",column:this.transformNode($.column),renameTo:this.transformNode($.renameTo)})}transformAlterColumn($){return W({kind:"AlterColumnNode",column:this.transformNode($.column),dataType:this.transformNode($.dataType),dataTypeExpression:this.transformNode($.dataTypeExpression),setDefault:this.transformNode($.setDefault),dropDefault:$.dropDefault,setNotNull:$.setNotNull,dropNotNull:$.dropNotNull})}transformModifyColumn($){return W({kind:"ModifyColumnNode",column:this.transformNode($.column)})}transformAddConstraint($){return W({kind:"AddConstraintNode",constraint:this.transformNode($.constraint)})}transformDropConstraint($){return W({kind:"DropConstraintNode",constraintName:this.transformNode($.constraintName),ifExists:$.ifExists,modifier:$.modifier})}transformCreateView($){return W({kind:"CreateViewNode",name:this.transformNode($.name),temporary:$.temporary,orReplace:$.orReplace,ifNotExists:$.ifNotExists,materialized:$.materialized,columns:this.transformNodeList($.columns),as:this.transformNode($.as)})}transformDropView($){return W({kind:"DropViewNode",name:this.transformNode($.name),ifExists:$.ifExists,materialized:$.materialized,cascade:$.cascade})}transformGenerated($){return W({kind:"GeneratedNode",byDefault:$.byDefault,always:$.always,identity:$.identity,stored:$.stored,expression:this.transformNode($.expression)})}transformDefaultValue($){return W({kind:"DefaultValueNode",defaultValue:this.transformNode($.defaultValue)})}transformOn($){return W({kind:"OnNode",on:this.transformNode($.on)})}transformSelectModifier($){return W({kind:"SelectModifierNode",modifier:$.modifier,rawModifier:this.transformNode($.rawModifier),of:this.transformNodeList($.of)})}transformCreateType($){return W({kind:"CreateTypeNode",name:this.transformNode($.name),enum:this.transformNode($.enum)})}transformDropType($){return W({kind:"DropTypeNode",name:this.transformNode($.name),ifExists:$.ifExists})}transformExplain($){return W({kind:"ExplainNode",format:$.format,options:this.transformNode($.options)})}transformSchemableIdentifier($){return W({kind:"SchemableIdentifierNode",schema:this.transformNode($.schema),identifier:this.transformNode($.identifier)})}transformAggregateFunction($){return W({kind:"AggregateFunctionNode",aggregated:this.transformNodeList($.aggregated),distinct:$.distinct,filter:this.transformNode($.filter),func:$.func,over:this.transformNode($.over)})}transformOver($){return W({kind:"OverNode",orderBy:this.transformNode($.orderBy),partitionBy:this.transformNode($.partitionBy)})}transformPartitionBy($){return W({kind:"PartitionByNode",items:this.transformNodeList($.items)})}transformPartitionByItem($){return W({kind:"PartitionByItemNode",partitionBy:this.transformNode($.partitionBy)})}transformBinaryOperation($){return W({kind:"BinaryOperationNode",leftOperand:this.transformNode($.leftOperand),operator:this.transformNode($.operator),rightOperand:this.transformNode($.rightOperand)})}transformUnaryOperation($){return W({kind:"UnaryOperationNode",operator:this.transformNode($.operator),operand:this.transformNode($.operand)})}transformUsing($){return W({kind:"UsingNode",tables:this.transformNodeList($.tables)})}transformFunction($){return W({kind:"FunctionNode",func:$.func,arguments:this.transformNodeList($.arguments)})}transformCase($){return W({kind:"CaseNode",value:this.transformNode($.value),when:this.transformNodeList($.when),else:this.transformNode($.else),isStatement:$.isStatement})}transformWhen($){return W({kind:"WhenNode",condition:this.transformNode($.condition),result:this.transformNode($.result)})}transformJSONReference($){return W({kind:"JSONReferenceNode",reference:this.transformNode($.reference),traversal:this.transformNode($.traversal)})}transformJSONPath($){return W({kind:"JSONPathNode",inOperator:this.transformNode($.inOperator),pathLegs:this.transformNodeList($.pathLegs)})}transformJSONPathLeg($){return W({kind:"JSONPathLegNode",type:$.type,value:$.value})}transformJSONOperatorChain($){return W({kind:"JSONOperatorChainNode",operator:this.transformNode($.operator),values:this.transformNodeList($.values)})}transformTuple($){return W({kind:"TupleNode",values:this.transformNodeList($.values)})}transformAddIndex($){return W({kind:"AddIndexNode",name:this.transformNode($.name),columns:this.transformNodeList($.columns),unique:$.unique,using:this.transformNode($.using),ifNotExists:$.ifNotExists})}transformDataType($){return $}transformSelectAll($){return $}transformIdentifier($){return $}transformValue($){return $}transformPrimitiveValueList($){return $}transformOperator($){return $}transformDefaultInsertValue($){return $}}var RX=H({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0});class h4 extends Z8{#$;#Z=new Set;#X=new Set;constructor($){super();this.#$=$}transformNodeImpl($){if(!this.#H($))return super.transformNodeImpl($);const Z=this.#K($);for(let G of Z)this.#X.add(G);const X=this.#G($);for(let G of X)this.#Z.add(G);const Y=super.transformNodeImpl($);for(let G of X)this.#Z.delete(G);for(let G of Z)this.#X.delete(G);return Y}transformSchemableIdentifier($){const Z=super.transformSchemableIdentifier($);if(Z.schema||!this.#Z.has($.identifier.name))return Z;return{...Z,schema:V.create(this.#$)}}transformReferences($){const Z=super.transformReferences($);if(Z.table.table.schema)return Z;return{...Z,table:L0.createWithSchema(this.#$,Z.table.table.identifier.name)}}#H($){return $.kind in RX}#G($){const Z=new Set;if("name"in $&&$.name&&Z0.is($.name))this.#J($.name,Z);if("from"in $&&$.from)for(let X of $.from.froms)this.#Y(X,Z);if("into"in $&&$.into)this.#Y($.into,Z);if("table"in $&&$.table)this.#Y($.table,Z);if("joins"in $&&$.joins)for(let X of $.joins)this.#Y(X.table,Z);return Z}#K($){const Z=new Set;if("with"in $&&$.with)this.#_($.with,Z);return Z}#Y($,Z){const X=L0.is($)?$:d.is($)&&L0.is($.node)?$.node:null;if(X)this.#J(X.table,Z)}#J($,Z){const X=$.identifier.name;if(!this.#Z.has(X)&&!this.#X.has(X))Z.add(X)}#_($,Z){for(let X of $.expressions){const Y=X.name.table.table.identifier.name;if(!this.#X.has(Y))Z.add(Y)}}}class M0{#$;constructor($){this.#$=new h4($)}transformQuery($){return this.#$.transformNode($.node)}async transformResult($){return $.result}}class C0{#$;constructor($){this.#$=H($)}selectFrom($){return w1({queryId:O(),executor:this.#$.executor,queryNode:q.createFrom(Q0($),this.#$.withNode)})}selectNoFrom($){return w1({queryId:O(),executor:this.#$.executor,queryNode:q.cloneWithSelections(q.create(this.#$.withNode),D0($))})}insertInto($){return new m({queryId:O(),executor:this.#$.executor,queryNode:o.create(T($),this.#$.withNode)})}replaceInto($){return new m({queryId:O(),executor:this.#$.executor,queryNode:o.create(T($),this.#$.withNode,!0)})}deleteFrom($){return new b({queryId:O(),executor:this.#$.executor,queryNode:a0.create(Q0($),this.#$.withNode)})}updateTable($){return new g({queryId:O(),executor:this.#$.executor,queryNode:H1.create(p0($),this.#$.withNode)})}with($,Z){const X=C4($,Z);return new C0({...this.#$,withNode:this.#$.withNode?$8.cloneWithExpression(this.#$.withNode,X):$8.create(X)})}withRecursive($,Z){const X=C4($,Z);return new C0({...this.#$,withNode:this.#$.withNode?$8.cloneWithExpression(this.#$.withNode,X):$8.create(X,{recursive:!0})})}withPlugin($){return new C0({...this.#$,executor:this.#$.executor.withPlugin($)})}withoutPlugins(){return new C0({...this.#$,executor:this.#$.executor.withoutPlugins()})}withSchema($){return new C0({...this.#$,executor:this.#$.executor.withPluginAtFront(new M0($))})}}class N8{#$;#Z;#X;constructor(){this.#$=new Promise(($,Z)=>{this.#X=Z,this.#Z=$})}get promise(){return this.#$}resolve=($)=>{if(this.#Z)this.#Z($)};reject=($)=>{if(this.#X)this.#X($)}}function D9($){if(P9.has($))return;P9.add($),console.log($)}var P9=new Set;var PX=function($,Z){const{numAffectedRows:X}=$;if(X===void 0&&$.numUpdatedOrDeletedRows===void 0||X!==void 0&&Z.numAffectedRows!==void 0)return;D9("kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.")},qX=H([]);class X8{#$;constructor($=qX){this.#$=$}get plugins(){return this.#$}transformQuery($,Z){for(let X of this.#$){const Y=X.transformQuery({node:$,queryId:Z});if(Y.kind===$.kind)$=Y;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${$.kind}`,`but it returned a ${Y.kind}`].join(" "))}return $}async executeQuery($,Z){return await this.provideConnection(async(X)=>{const Y=await X.executeQuery($),G=await this.#Z(Y,Z);return PX(Y,G),G})}async*stream($,Z,X){const Y=new N8,G=new N8;this.provideConnection(async(J)=>{return Y.resolve(J),await G.promise}).catch((J)=>Y.reject(J));const K=await Y.promise;try{for await(let J of K.streamQuery($,Z))yield await this.#Z(J,X)}finally{G.resolve()}}async#Z($,Z){for(let X of this.#$)$=await X.transformResult({result:$,queryId:Z});return $}}class T1 extends X8{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin($){return new T1([...this.plugins,$])}withPlugins($){return new T1([...this.plugins,...$])}withPluginAtFront($){return new T1([$,...this.plugins])}withoutPlugins(){return new T1([])}}var A1=new T1;function V9(){return new C0({executor:A1})}function E9($,Z){return new X1({joinNode:u0.create($,p0(Z))})}function O9(){return new q1({overNode:r1.create()})}function p($,Z){if(Z.length===3)return EX($,Z[0],Z[1],Z[2]);else if(Z.length===2)return DX($,Z[0],Z[1]);else throw new Error("not implemented")}var DX=function($,Z,X){return X(E9($,Z)).toOperationNode()},EX=function($,Z,X,Y){return u0.createWithOn($,p0(Z),i(X,"=",Y))};var w9=H({is($){return $.kind==="OffsetNode"},create($){return H({kind:"OffsetNode",offset:$})}});var T9=H({is($){return $.kind==="GroupByItemNode"},create($){return H({kind:"GroupByItemNode",groupBy:$})}});function A9($){return $=Q($)?$(E0()):$,v0($).map(T9.create)}var b8=H({is($){return $.kind==="SetOperationNode"},create($,Z,X){return H({kind:"SetOperationNode",operator:$,expression:Z,all:X})}});function Y1($,Z,X){if(Q(Z))Z=Z(y8());if(!l(Z))Z=[Z];return Z.map((Y)=>b8.create($,H0(Y),X))}class A{#$;constructor($){this.#$=$}get expressionType(){return}as($){return new f8(this,$)}or(...$){return new g8(P0.create(this.#$,S($)))}and(...$){return new m8(X0.create(this.#$,S($)))}$castTo(){return new A(this.#$)}$notNull(){return new A(this.#$)}toOperationNode(){return this.#$}}class f8{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}get expression(){return this.#$}get alias(){return this.#Z}toOperationNode(){return d.create(this.#$.toOperationNode(),x(this.#Z)?this.#Z.toOperationNode():V.create(this.#Z))}}class g8{#$;constructor($){this.#$=$}get expressionType(){return}as($){return new f8(this,$)}or(...$){return new g8(P0.create(this.#$,S($)))}$castTo(){return new g8(this.#$)}toOperationNode(){return S0.create(this.#$)}}class m8{#$;constructor($){this.#$=$}get expressionType(){return}as($){return new f8(this,$)}and(...$){return new m8(X0.create(this.#$,S($)))}$castTo(){return new m8(this.#$)}toOperationNode(){return S0.create(this.#$)}}function w1($){return new k($)}class k{#$;constructor($){this.#$=H($)}get expressionType(){return}get isSelectQueryBuilder(){return!0}where(...$){return new k({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,S($))})}whereRef($,Z,X){return new k({...this.#$,queryNode:R.cloneWithWhere(this.#$.queryNode,i($,Z,X))})}having(...$){return new k({...this.#$,queryNode:q.cloneWithHaving(this.#$.queryNode,S($))})}havingRef($,Z,X){return new k({...this.#$,queryNode:q.cloneWithHaving(this.#$.queryNode,i($,Z,X))})}select($){return new k({...this.#$,queryNode:q.cloneWithSelections(this.#$.queryNode,D0($))})}distinctOn($){return new k({...this.#$,queryNode:q.cloneWithDistinctOn(this.#$.queryNode,v0($))})}modifyFront($){return new k({...this.#$,queryNode:q.cloneWithFrontModifier(this.#$.queryNode,z0.createWithExpression($.toOperationNode()))})}modifyEnd($){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.createWithExpression($.toOperationNode()))})}distinct(){return new k({...this.#$,queryNode:q.cloneWithFrontModifier(this.#$.queryNode,z0.create("Distinct"))})}forUpdate($){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("ForUpdate",$?n1($).map(T):void 0))})}forShare($){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("ForShare",$?n1($).map(T):void 0))})}forKeyShare($){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("ForKeyShare",$?n1($).map(T):void 0))})}forNoKeyUpdate($){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("ForNoKeyUpdate",$?n1($).map(T):void 0))})}skipLocked(){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("SkipLocked"))})}noWait(){return new k({...this.#$,queryNode:q.cloneWithEndModifier(this.#$.queryNode,z0.create("NoWait"))})}selectAll($){return new k({...this.#$,queryNode:q.cloneWithSelections(this.#$.queryNode,I0($))})}innerJoin(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("InnerJoin",$))})}leftJoin(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("LeftJoin",$))})}rightJoin(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("RightJoin",$))})}fullJoin(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("FullJoin",$))})}innerJoinLateral(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("LateralInnerJoin",$))})}leftJoinLateral(...$){return new k({...this.#$,queryNode:R.cloneWithJoin(this.#$.queryNode,p("LateralLeftJoin",$))})}orderBy(...$){return new k({...this.#$,queryNode:q.cloneWithOrderByItems(this.#$.queryNode,d0($))})}groupBy($){return new k({...this.#$,queryNode:q.cloneWithGroupByItems(this.#$.queryNode,A9($))})}limit($){return new k({...this.#$,queryNode:q.cloneWithLimit(this.#$.queryNode,B8.create(z($)))})}offset($){return new k({...this.#$,queryNode:q.cloneWithOffset(this.#$.queryNode,w9.create(z($)))})}union($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("union",$,!1))})}unionAll($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("union",$,!0))})}intersect($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("intersect",$,!1))})}intersectAll($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("intersect",$,!0))})}except($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("except",$,!1))})}exceptAll($){return new k({...this.#$,queryNode:q.cloneWithSetOperations(this.#$.queryNode,Y1("except",$,!0))})}as($){return new j4(this,$)}clearSelect(){return new k({...this.#$,queryNode:q.cloneWithoutSelections(this.#$.queryNode)})}clearWhere(){return new k({...this.#$,queryNode:R.cloneWithoutWhere(this.#$.queryNode)})}clearLimit(){return new k({...this.#$,queryNode:q.cloneWithoutLimit(this.#$.queryNode)})}clearOffset(){return new k({...this.#$,queryNode:q.cloneWithoutOffset(this.#$.queryNode)})}clearOrderBy(){return new k({...this.#$,queryNode:q.cloneWithoutOrderBy(this.#$.queryNode)})}$call($){return $(this)}$if($,Z){if($)return Z(this);return new k({...this.#$})}$castTo(){return new k(this.#$)}$narrowType(){return new k(this.#$)}$assertType(){return new k(this.#$)}$asTuple(){return new A(this.toOperationNode())}withPlugin($){return new k({...this.#$,executor:this.#$.executor.withPlugin($)})}toOperationNode(){return this.#$.executor.transformQuery(this.#$.queryNode,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){const $=this.compile();return(await this.#$.executor.executeQuery($,this.#$.queryId)).rows}async executeTakeFirst(){const[$]=await this.execute();return $}async executeTakeFirstOrThrow($=B0){const Z=await this.executeTakeFirst();if(Z===void 0)throw i0($)?new $(this.toOperationNode()):$(this.toOperationNode());return Z}async*stream($=100){const Z=this.compile(),X=this.#$.executor.stream(Z,$,this.#$.queryId);for await(let Y of X)yield*Y.rows}async explain($,Z){return await new k({...this.#$,queryNode:R.cloneWithExplain(this.#$.queryNode,$,Z)}).execute()}}M(k,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class j4{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}get expression(){return this.#$}get alias(){return this.#Z}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return d.create(this.#$.toOperationNode(),V.create(this.#Z))}}M(j4,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.");var N0=H({is($){return $.kind==="AggregateFunctionNode"},create($,Z=[]){return H({kind:"AggregateFunctionNode",func:$,aggregated:Z})},cloneWithDistinct($){return H({...$,distinct:!0})},cloneWithFilter($,Z){return H({...$,filter:$.filter?u.cloneWithOperation($.filter,"And",Z):u.create(Z)})},cloneWithOrFilter($,Z){return H({...$,filter:$.filter?u.cloneWithOperation($.filter,"Or",Z):u.create(Z)})},cloneWithOver($,Z){return H({...$,over:Z})}});var x4=H({is($){return $.kind==="FunctionNode"},create($,Z){return H({kind:"FunctionNode",func:$,arguments:Z})}});class F0{#$;constructor($){this.#$=H($)}get expressionType(){return}as($){return new z9(this,$)}distinct(){return new F0({...this.#$,aggregateFunctionNode:N0.cloneWithDistinct(this.#$.aggregateFunctionNode)})}filterWhere(...$){return new F0({...this.#$,aggregateFunctionNode:N0.cloneWithFilter(this.#$.aggregateFunctionNode,S($))})}filterWhereRef($,Z,X){return new F0({...this.#$,aggregateFunctionNode:N0.cloneWithFilter(this.#$.aggregateFunctionNode,i($,Z,X))})}over($){const Z=O9();return new F0({...this.#$,aggregateFunctionNode:N0.cloneWithOver(this.#$.aggregateFunctionNode,($?$(Z):Z).toOperationNode())})}$call($){return $(this)}$castTo(){return new F0(this.#$)}$notNull(){return new F0(this.#$)}toOperationNode(){return this.#$.aggregateFunctionNode}}M(F0,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class z9{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}get expression(){return this.#$}get alias(){return this.#Z}toOperationNode(){return d.create(this.#$.toOperationNode(),V.create(this.#Z))}}function c8(){const $=(X,Y)=>{return new A(x4.create(X,v0(Y??[])))},Z=(X,Y)=>{return new F0({aggregateFunctionNode:N0.create(X,Y?v0(Y):void 0)})};return Object.assign($,{agg:Z,avg(X){return Z("avg",[X])},coalesce(...X){return $("coalesce",X)},count(X){return Z("count",[X])},countAll(X){return new F0({aggregateFunctionNode:N0.create("count",I0(X))})},max(X){return Z("max",[X])},min(X){return Z("min",[X])},sum(X){return Z("sum",[X])},any(X){return $("any",[X])},jsonAgg(X){return new F0({aggregateFunctionNode:N0.create("json_agg",[j(X)?T(X):X.toOperationNode()])})},toJson(X){return new A(x4.create("to_json",[j(X)?T(X):X.toOperationNode()]))}})}var Q9=H({is($){return $.kind==="UnaryOperationNode"},create($,Z){return H({kind:"UnaryOperationNode",operator:$,operand:Z})}});function S9($,Z){return Q9.create(J0.create($),a(Z))}var H8=H({is($){return $.kind==="WhenNode"},create($){return H({kind:"WhenNode",condition:$})},cloneWithResult($,Z){return H({...$,result:Z})}});var W0=H({is($){return $.kind==="CaseNode"},create($){return H({kind:"CaseNode",value:$})},cloneWithWhen($,Z){return H({...$,when:H($.when?[...$.when,Z]:[Z])})},cloneWithThen($,Z){return H({...$,when:$.when?H([...$.when.slice(0,-1),H8.cloneWithResult($.when[$.when.length-1],Z)]):void 0})},cloneWith($,Z){return H({...$,...Z})}});class Y8{#$;constructor($){this.#$=H($)}when(...$){return new v4({...this.#$,node:W0.cloneWithWhen(this.#$.node,H8.create(S($)))})}}class v4{#$;constructor($){this.#$=H($)}then($){return new I9({...this.#$,node:W0.cloneWithThen(this.#$.node,C8($)?o1($):z($))})}}class I9{#$;constructor($){this.#$=H($)}when(...$){return new v4({...this.#$,node:W0.cloneWithWhen(this.#$.node,H8.create(S($)))})}else($){return new C9({...this.#$,node:W0.cloneWith(this.#$.node,{else:C8($)?o1($):z($)})})}end(){return new A(W0.cloneWith(this.#$.node,{isStatement:!1}))}endCase(){return new A(W0.cloneWith(this.#$.node,{isStatement:!0}))}}class C9{#$;constructor($){this.#$=H($)}end(){return new A(W0.cloneWith(this.#$.node,{isStatement:!1}))}endCase(){return new A(W0.cloneWith(this.#$.node,{isStatement:!0}))}}var u8=H({is($){return $.kind==="JSONOperatorChainNode"},create($){return H({kind:"JSONOperatorChainNode",operator:$,values:H([])})},cloneWithValue($,Z){return H({...$,values:H([...$.values,Z])})}});var B4=H({is($){return $.kind==="JSONPathLegNode"},create($,Z){return H({kind:"JSONPathLegNode",type:$,value:Z})}});var t0=H({is($){return $.kind==="JSONPathNode"},create($){return H({kind:"JSONPathNode",inOperator:$,pathLegs:H([])})},cloneWithLeg($,Z){return H({...$,pathLegs:H([...$.pathLegs,Z])})}});var z1=H({is($){return $.kind==="JSONReferenceNode"},create($,Z){return H({kind:"JSONReferenceNode",reference:$,traversal:Z})},cloneWithTraversal($,Z){return H({...$,traversal:Z})}});class G1{#$;constructor($){this.#$=$}at($){return this.#Z("ArrayLocation",$)}key($){return this.#Z("Member",$)}#Z($,Z){if(z1.is(this.#$))return new N4(z1.cloneWithTraversal(this.#$,t0.is(this.#$.traversal)?t0.cloneWithLeg(this.#$.traversal,B4.create($,Z)):u8.cloneWithValue(this.#$.traversal,n.createImmediate(Z))));return new N4(t0.cloneWithLeg(this.#$,B4.create($,Z)))}}class N4 extends G1{#$;constructor($){super($);this.#$=$}get expressionType(){return}as($){return new h9(this,$)}$castTo(){return new G1(this.#$)}$notNull(){return new G1(this.#$)}toOperationNode(){return this.#$}}class h9{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}get expression(){return this.#$}get alias(){return this.#Z}toOperationNode(){return d.create(this.#$.toOperationNode(),x(this.#Z)?this.#Z.toOperationNode():V.create(this.#Z))}}var b4=H({is($){return $.kind==="TupleNode"},create($){return H({kind:"TupleNode",values:H($)})}});function y8($=A1){function Z(G,K,J){return new A(h8(G,K,J))}function X(G,K){return new A(S9(G,K))}const Y=Object.assign(Z,{fn:void 0,eb:void 0,selectFrom(G){return w1({queryId:O(),executor:$,queryNode:q.createFrom(Q0(G))})},case(G){return new Y8({node:W0.create(q0(G)?void 0:a(G))})},ref(G,K){if(q0(K))return new A(_0(G));return new G1(j9(G,K))},jsonPath(){return new G1(t0.create())},table(G){return new A(T(G))},val(G){return new A(z(G))},refTuple(...G){return new A(b4.create(G.map(a)))},tuple(...G){return new A(b4.create(G.map(z)))},lit(G){return new A(o1(G))},unary:X,not(G){return X("not",G)},exists(G){return X("exists",G)},neg(G){return X("-",G)},between(G,K,J){return new A(l0.create(a(G),J0.create("between"),X0.create(z(K),z(J))))},betweenSymmetric(G,K,J){return new A(l0.create(a(G),J0.create("between symmetric"),X0.create(z(K),z(J))))},and(G){if(l(G))return new A(j8(G,"and"));return new A(F4(G,"and"))},or(G){if(l(G))return new A(j8(G,"or"));return new A(F4(G,"or"))},parens(...G){const K=S(G);if(S0.is(K))return new A(K);else return new A(S0.create(K))},withSchema(G){return y8($.withPluginAtFront(new M0(G)))}});return Y.fn=c8(),Y.eb=Y,Y}function E0($){return y8()}function H0($){if(x($))return $.toOperationNode();else if(Q($))return $(E0()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify($)}`)}function S8($){if(x($))return $.toOperationNode();else if(Q($))return $(E0()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify($)}`)}function j0($){return i5($)||t5($)||Q($)}function P4($){if(j($))return _0($);return $.toOperationNode()}function v0($){if(l($))return $.map((Z)=>a(Z));else return[a($)]}function a($){if(j0($))return H0($);return P4($)}function j9($,Z){const X=_0($);if(L4(Z))return z1.create(X,u8.create(J0.create(Z)));const Y=Z.slice(0,-1);if(L4(Y))return z1.create(X,t0.create(J0.create(Y)));throw new Error(`Invalid JSON operator: ${Z}`)}function _0($){if(!$.includes("."))return k1.create(D.create($));const X=$.split(".").map(g4);if(X.length===3)return OX(X);if(X.length===2)return wX(X);throw new Error(`invalid column reference ${$}`)}function K9($){if($.includes(" as ")){const[X,Y]=$.split(" as ").map(g4);return d.create(_0(X),V.create(Y))}else return _0($)}function y4($){return D.create($)}function Q1($){if($.includes(" ")){const[X,Y]=$.split(" ").map(g4);if(!E4(Y))throw new Error(`invalid order direction "${Y}" next to "${X}"`);return d0([X,Y])[0]}else return y4($)}var OX=function($){const[Z,X,Y]=$;return k1.create(D.create(Y),L0.createWithSchema(Z,X))},wX=function($){const[Z,X]=$;return k1.create(D.create(X),L0.create(Z))},g4=function($){return $.trim()};function b0($){return new S1($)}class S1{#$;constructor($){this.#$=H($)}get expressionType(){return}get isRawBuilder(){return!0}as($){return new m4(this,$)}$castTo(){return new S1({...this.#$})}$notNull(){return new S1(this.#$)}withPlugin($){return new S1({...this.#$,plugins:this.#$.plugins!==void 0?H([...this.#$.plugins,$]):H([$])})}toOperationNode(){return this.#X(this.#Z())}compile($){return this.#H(this.#Z($))}async execute($){const Z=this.#Z($);return Z.executeQuery(this.#H(Z),this.#$.queryId)}#Z($){const Z=$!==void 0?$.getExecutor():A1;return this.#$.plugins!==void 0?Z.withPlugins(this.#$.plugins):Z}#X($){return $.transformQuery(this.#$.rawNode,this.#$.queryId)}#H($){return $.compileQuery(this.#X($),this.#$.queryId)}}M(S1,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class m4{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}get expression(){return this.#$}get alias(){return this.#Z}get rawBuilder(){return this.#$}toOperationNode(){return d.create(this.#$.toOperationNode(),x(this.#Z)?this.#Z.toOperationNode():V.create(this.#Z))}}M(m4,"don't await AliasedRawBuilder instances directly. AliasedRawBuilder should never be executed directly since it's always a part of another query.");var x9=function($){if(x($))return $.toOperationNode();return z($)},K1=Object.assign(($,...Z)=>{return b0({queryId:O(),rawNode:N.create($,Z?.map(x9)??[])})},{ref($){return b0({queryId:O(),rawNode:N.createWithChild(_0($))})},val($){return b0({queryId:O(),rawNode:N.createWithChild(z($))})},value($){return this.val($)},table($){return b0({queryId:O(),rawNode:N.createWithChild(T($))})},id(...$){const Z=new Array($.length+1).fill(".");return Z[0]="",Z[Z.length-1]="",b0({queryId:O(),rawNode:N.create(Z,$.map(V.create))})},lit($){return b0({queryId:O(),rawNode:N.createWithChild(n.createImmediate($))})},literal($){return this.lit($)},raw($){return b0({queryId:O(),rawNode:N.createWithSql($)})},join($,Z=K1`, `){const X=new Array(2*$.length-1),Y=Z.toOperationNode();for(let G=0;G<$.length;++G)if(X[2*G]=x9($[G]),G!==$.length-1)X[2*G+1]=Y;return b0({queryId:O(),rawNode:N.createWithChildren(X)})}});var w=H({is($){return $.kind==="AlterTableNode"},create($){return H({kind:"AlterTableNode",table:$})},cloneWithTableProps($,Z){return H({...$,...Z})},cloneWithColumnAlteration($,Z){return H({...$,columnAlterations:$.columnAlterations?[...$.columnAlterations,Z]:[Z]})}});var w0=H({is($){return $.kind==="CreateIndexNode"},create($){return H({kind:"CreateIndexNode",name:V.create($)})},cloneWith($,Z){return H({...$,...Z})},cloneWithColumns($,Z){return H({...$,columns:[...$.columns||[],...Z]})}});var p8=H({is($){return $.kind==="CreateSchemaNode"},create($,Z){return H({kind:"CreateSchemaNode",schema:V.create($),...Z})},cloneWith($,Z){return H({...$,...Z})}});var v9=["preserve rows","delete rows","drop"],t=H({is($){return $.kind==="CreateTableNode"},create($){return H({kind:"CreateTableNode",table:$,columns:H([])})},cloneWithColumn($,Z){return H({...$,columns:H([...$.columns,Z])})},cloneWithConstraint($,Z){return H({...$,constraints:$.constraints?H([...$.constraints,Z]):H([Z])})},cloneWithFrontModifier($,Z){return H({...$,frontModifiers:$.frontModifiers?H([...$.frontModifiers,Z]):H([Z])})},cloneWithEndModifier($,Z){return H({...$,endModifiers:$.endModifiers?H([...$.endModifiers,Z]):H([Z])})},cloneWith($,Z){return H({...$,...Z})}});var s0=H({is($){return $.kind==="DropIndexNode"},create($,Z){return H({kind:"DropIndexNode",name:Z0.create($),...Z})},cloneWith($,Z){return H({...$,...Z})}});var G8=H({is($){return $.kind==="DropSchemaNode"},create($,Z){return H({kind:"DropSchemaNode",schema:V.create($),...Z})},cloneWith($,Z){return H({...$,...Z})}});var K8=H({is($){return $.kind==="DropTableNode"},create($,Z){return H({kind:"DropTableNode",table:$,...Z})},cloneWith($,Z){return H({...$,...Z})}});var f4=H({is($){return $.kind==="AddColumnNode"},create($){return H({kind:"AddColumnNode",column:$})}});var C=H({is($){return $.kind==="ColumnDefinitionNode"},create($,Z){return H({kind:"ColumnDefinitionNode",column:D.create($),dataType:Z})},cloneWithFrontModifier($,Z){return H({...$,frontModifiers:$.frontModifiers?H([...$.frontModifiers,Z]):[Z]})},cloneWithEndModifier($,Z){return H({...$,endModifiers:$.endModifiers?H([...$.endModifiers,Z]):[Z]})},cloneWith($,Z){return H({...$,...Z})}});var c4=H({is($){return $.kind==="DropColumnNode"},create($){return H({kind:"DropColumnNode",column:D.create($)})}});var u4=H({is($){return $.kind==="RenameColumnNode"},create($,Z){return H({kind:"RenameColumnNode",column:D.create($),renameTo:D.create(Z)})}});var I1=H({is($){return $.kind==="CheckConstraintNode"},create($,Z){return H({kind:"CheckConstraintNode",expression:$,name:Z?V.create(Z):void 0})}});var B9=["no action","restrict","cascade","set null","set default"],C1=H({is($){return $.kind==="ReferencesNode"},create($,Z){return H({kind:"ReferencesNode",table:$,columns:H([...Z])})},cloneWithOnDelete($,Z){return H({...$,onDelete:Z})},cloneWithOnUpdate($,Z){return H({...$,onUpdate:Z})}});function l8($){return x($)?$.toOperationNode():n.createImmediate($)}var J8=H({is($){return $.kind==="GeneratedNode"},create($){return H({kind:"GeneratedNode",...$})},createWithExpression($){return H({kind:"GeneratedNode",always:!0,expression:$})},cloneWith($,Z){return H({...$,...Z})}});var N9=H({is($){return $.kind==="DefaultValueNode"},create($){return H({kind:"DefaultValueNode",defaultValue:$})}});function h1($){if(B9.includes($))return $;throw new Error(`invalid OnModifyForeignAction ${$}`)}class I{#$;constructor($){this.#$=$}autoIncrement(){return new I(C.cloneWith(this.#$,{autoIncrement:!0}))}primaryKey(){return new I(C.cloneWith(this.#$,{primaryKey:!0}))}references($){const Z=_0($);if(!Z.table||V1.is(Z.column))throw new Error(`invalid call references('${$}'). The reference must have format table.column or schema.table.column`);return new I(C.cloneWith(this.#$,{references:C1.create(Z.table,[Z.column])}))}onDelete($){if(!this.#$.references)throw new Error("on delete constraint can only be added for foreign keys");return new I(C.cloneWith(this.#$,{references:C1.cloneWithOnDelete(this.#$.references,h1($))}))}onUpdate($){if(!this.#$.references)throw new Error("on update constraint can only be added for foreign keys");return new I(C.cloneWith(this.#$,{references:C1.cloneWithOnUpdate(this.#$.references,h1($))}))}unique(){return new I(C.cloneWith(this.#$,{unique:!0}))}notNull(){return new I(C.cloneWith(this.#$,{notNull:!0}))}unsigned(){return new I(C.cloneWith(this.#$,{unsigned:!0}))}defaultTo($){return new I(C.cloneWith(this.#$,{defaultTo:N9.create(l8($))}))}check($){return new I(C.cloneWith(this.#$,{check:I1.create($.toOperationNode())}))}generatedAlwaysAs($){return new I(C.cloneWith(this.#$,{generated:J8.createWithExpression($.toOperationNode())}))}generatedAlwaysAsIdentity(){return new I(C.cloneWith(this.#$,{generated:J8.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new I(C.cloneWith(this.#$,{generated:J8.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#$.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new I(C.cloneWith(this.#$,{generated:J8.cloneWith(this.#$.generated,{stored:!0})}))}modifyFront($){return new I(C.cloneWithFrontModifier(this.#$,$.toOperationNode()))}nullsNotDistinct(){return new I(C.cloneWith(this.#$,{nullsNotDistinct:!0}))}modifyEnd($){return new I(C.cloneWithEndModifier(this.#$,$.toOperationNode()))}$call($){return $(this)}toOperationNode(){return this.#$}}M(I,"don't await ColumnDefinitionBuilder instances directly.");var p4=H({is($){return $.kind==="ModifyColumnNode"},create($){return H({kind:"ModifyColumnNode",column:$})}});var b9=H({is($){return $.kind==="DataTypeNode"},create($){return H({kind:"DataTypeNode",dataType:$})}});function y0($){return x($)?$.toOperationNode():b9.create($)}var J1=H({is($){return $.kind==="ForeignKeyConstraintNode"},create($,Z,X,Y){return H({kind:"ForeignKeyConstraintNode",columns:$,references:C1.create(Z,X),name:Y?V.create(Y):void 0})},cloneWith($,Z){return H({...$,...Z})}});class n0{#$;constructor($){this.#$=$}onDelete($){return new n0(J1.cloneWith(this.#$,{onDelete:h1($)}))}onUpdate($){return new n0(J1.cloneWith(this.#$,{onUpdate:h1($)}))}$call($){return $(this)}toOperationNode(){return this.#$}}M(n0,"don't await ForeignKeyConstraintBuilder instances directly.");var j1=H({is($){return $.kind==="AddConstraintNode"},create($){return H({kind:"AddConstraintNode",constraint:$})}});var x1=H({is($){return $.kind==="UniqueConstraintNode"},create($,Z,X){return H({kind:"UniqueConstraintNode",columns:H($.map(D.create)),name:Z?V.create(Z):void 0,nullsNotDistinct:X})},cloneWith($,Z){return H({...$,...Z})}});var v1=H({is($){return $.kind==="DropConstraintNode"},create($){return H({kind:"DropConstraintNode",constraintName:V.create($)})},cloneWith($,Z){return H({...$,...Z})}});var B1=H({is($){return $.kind==="AlterColumnNode"},create($,Z,X){return H({kind:"AlterColumnNode",column:D.create($),[Z]:X})}});class _8{#$;constructor($){this.#$=$}setDataType($){return new N1(B1.create(this.#$,"dataType",y0($)))}setDefault($){return new N1(B1.create(this.#$,"setDefault",l8($)))}dropDefault(){return new N1(B1.create(this.#$,"dropDefault",!0))}setNotNull(){return new N1(B1.create(this.#$,"setNotNull",!0))}dropNotNull(){return new N1(B1.create(this.#$,"dropNotNull",!0))}$call($){return $(this)}}class N1{#$;constructor($){this.#$=$}toOperationNode(){return this.#$}}class g0{#$;constructor($){this.#$=H($)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(g0,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");class b1{#$;constructor($){this.#$=H($)}onDelete($){return new b1({...this.#$,constraintBuilder:this.#$.constraintBuilder.onDelete($)})}onUpdate($){return new b1({...this.#$,constraintBuilder:this.#$.constraintBuilder.onUpdate($)})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(w.cloneWithTableProps(this.#$.node,{addConstraint:j1.create(this.#$.constraintBuilder.toOperationNode())}),this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(b1,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");class _1{#$;constructor($){this.#$=H($)}ifExists(){return new _1({...this.#$,node:w.cloneWithTableProps(this.#$.node,{dropConstraint:v1.cloneWith(this.#$.node.dropConstraint,{ifExists:!0})})})}cascade(){return new _1({...this.#$,node:w.cloneWithTableProps(this.#$.node,{dropConstraint:v1.cloneWith(this.#$.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new _1({...this.#$,node:w.cloneWithTableProps(this.#$.node,{dropConstraint:v1.cloneWith(this.#$.node.dropConstraint,{modifier:"restrict"})})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(_1,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");var d8=H({is($){return $.kind==="PrimaryKeyConstraintNode"},create($,Z){return H({kind:"PrimaryKeyConstraintNode",columns:H($.map(D.create)),name:Z?V.create(Z):void 0})}});var o0=H({is($){return $.kind==="AddIndexNode"},create($){return H({kind:"AddIndexNode",name:V.create($)})},cloneWith($,Z){return H({...$,...Z})},cloneWithColumns($,Z){return H({...$,columns:[...$.columns||[],...Z]})}});class m0{#$;constructor($){this.#$=H($)}unique(){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.cloneWith(this.#$.node.addIndex,{unique:!0})})})}column($){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.cloneWithColumns(this.#$.node.addIndex,[Q1($)])})})}columns($){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.cloneWithColumns(this.#$.node.addIndex,$.map(Q1))})})}expression($){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.cloneWithColumns(this.#$.node.addIndex,[$.toOperationNode()])})})}using($){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.cloneWith(this.#$.node.addIndex,{using:N.createWithSql($)})})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(m0,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");class W1{#$;constructor($){this.#$=$}toOperationNode(){return this.#$}nullsNotDistinct(){return new W1(x1.cloneWith(this.#$,{nullsNotDistinct:!0}))}}M(W1,"don't await UniqueConstraintNodeBuilder instances directly.");class a8{#$;constructor($){this.#$=H($)}renameTo($){return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{renameTo:T($)})})}setSchema($){return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{setSchema:V.create($)})})}alterColumn($,Z){const X=Z(new _8($));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,X.toOperationNode())})}dropColumn($){return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,c4.create($))})}renameColumn($,Z){return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,u4.create($,Z))})}addColumn($,Z,X=A0){const Y=X(new I(C.create($,y0(Z))));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,f4.create(Y.toOperationNode()))})}modifyColumn($,Z,X=A0){const Y=X(new I(C.create($,y0(Z))));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,p4.create(Y.toOperationNode()))})}addUniqueConstraint($,Z,X=A0){const Y=X(new W1(x1.create(Z,$)));return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addConstraint:j1.create(Y.toOperationNode())})})}addCheckConstraint($,Z){return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addConstraint:j1.create(I1.create(Z.toOperationNode(),$))})})}addForeignKeyConstraint($,Z,X,Y){return new b1({...this.#$,constraintBuilder:new n0(J1.create(Z.map(D.create),T(X),Y.map(D.create),$))})}addPrimaryKeyConstraint($,Z){return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addConstraint:j1.create(d8.create(Z,$))})})}dropConstraint($){return new _1({...this.#$,node:w.cloneWithTableProps(this.#$.node,{dropConstraint:v1.create($)})})}addIndex($){return new m0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{addIndex:o0.create($)})})}dropIndex($){return new g0({...this.#$,node:w.cloneWithTableProps(this.#$.node,{dropIndex:s0.create($)})})}$call($){return $(this)}}class V0{#$;constructor($){this.#$=H($)}alterColumn($,Z){const X=Z(new _8($));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,X.toOperationNode())})}dropColumn($){return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,c4.create($))})}renameColumn($,Z){return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,u4.create($,Z))})}addColumn($,Z,X=A0){const Y=X(new I(C.create($,y0(Z))));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,f4.create(Y.toOperationNode()))})}modifyColumn($,Z,X=A0){const Y=X(new I(C.create($,y0(Z))));return new V0({...this.#$,node:w.cloneWithColumnAlteration(this.#$.node,p4.create(Y.toOperationNode()))})}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(a8,"don't await AlterTableBuilder instances");M(_8,"don't await AlterColumnBuilder instances");M(V0,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class W8 extends Z8{transformValue($){return{...super.transformValue($),immediate:!0}}}class U0{#$;constructor($){this.#$=H($)}ifNotExists(){return new U0({...this.#$,node:w0.cloneWith(this.#$.node,{ifNotExists:!0})})}unique(){return new U0({...this.#$,node:w0.cloneWith(this.#$.node,{unique:!0})})}nullsNotDistinct(){return new U0({...this.#$,node:w0.cloneWith(this.#$.node,{nullsNotDistinct:!0})})}on($){return new U0({...this.#$,node:w0.cloneWith(this.#$.node,{table:T($)})})}column($){return new U0({...this.#$,node:w0.cloneWithColumns(this.#$.node,[Q1($)])})}columns($){return new U0({...this.#$,node:w0.cloneWithColumns(this.#$.node,$.map(Q1))})}expression($){return new U0({...this.#$,node:w0.cloneWithColumns(this.#$.node,[$.toOperationNode()])})}using($){return new U0({...this.#$,node:w0.cloneWith(this.#$.node,{using:N.createWithSql($)})})}where(...$){const Z=new W8;return new U0({...this.#$,node:R.cloneWithWhere(this.#$.node,Z.transformNode(S($)))})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(U0,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");class U8{#$;constructor($){this.#$=H($)}ifNotExists(){return new U8({...this.#$,node:p8.cloneWith(this.#$.node,{ifNotExists:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(U8,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");function y9($){if(v9.includes($))return $;throw new Error(`invalid OnCommitAction ${$}`)}class e{#$;constructor($){this.#$=H($)}temporary(){return new e({...this.#$,node:t.cloneWith(this.#$.node,{temporary:!0})})}onCommit($){return new e({...this.#$,node:t.cloneWith(this.#$.node,{onCommit:y9($)})})}ifNotExists(){return new e({...this.#$,node:t.cloneWith(this.#$.node,{ifNotExists:!0})})}addColumn($,Z,X=A0){const Y=X(new I(C.create($,y0(Z))));return new e({...this.#$,node:t.cloneWithColumn(this.#$.node,Y.toOperationNode())})}addPrimaryKeyConstraint($,Z){return new e({...this.#$,node:t.cloneWithConstraint(this.#$.node,d8.create(Z,$))})}addUniqueConstraint($,Z,X=A0){const Y=X(new W1(x1.create(Z,$)));return new e({...this.#$,node:t.cloneWithConstraint(this.#$.node,Y.toOperationNode())})}addCheckConstraint($,Z){return new e({...this.#$,node:t.cloneWithConstraint(this.#$.node,I1.create(Z.toOperationNode(),$))})}addForeignKeyConstraint($,Z,X,Y,G=A0){const K=G(new n0(J1.create(Z.map(D.create),T(X),Y.map(D.create),$)));return new e({...this.#$,node:t.cloneWithConstraint(this.#$.node,K.toOperationNode())})}modifyFront($){return new e({...this.#$,node:t.cloneWithFrontModifier(this.#$.node,$.toOperationNode())})}modifyEnd($){return new e({...this.#$,node:t.cloneWithEndModifier(this.#$.node,$.toOperationNode())})}as($){return new e({...this.#$,node:t.cloneWith(this.#$.node,{selectQuery:H0($)})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(e,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");class U1{#$;constructor($){this.#$=H($)}on($){return new U1({...this.#$,node:s0.cloneWith(this.#$.node,{table:T($)})})}ifExists(){return new U1({...this.#$,node:s0.cloneWith(this.#$.node,{ifExists:!0})})}cascade(){return new U1({...this.#$,node:s0.cloneWith(this.#$.node,{cascade:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(U1,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");class y1{#$;constructor($){this.#$=H($)}ifExists(){return new y1({...this.#$,node:G8.cloneWith(this.#$.node,{ifExists:!0})})}cascade(){return new y1({...this.#$,node:G8.cloneWith(this.#$.node,{cascade:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(y1,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");class g1{#$;constructor($){this.#$=H($)}ifExists(){return new g1({...this.#$,node:K8.cloneWith(this.#$.node,{ifExists:!0})})}cascade(){return new g1({...this.#$,node:K8.cloneWith(this.#$.node,{cascade:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(g1,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");var T0=H({is($){return $.kind==="CreateViewNode"},create($){return H({kind:"CreateViewNode",name:Z0.create($)})},cloneWith($,Z){return H({...$,...Z})}});class l4{#$=new W8;transformQuery($){return this.#$.transformNode($.node)}transformResult($){return Promise.resolve($.result)}}class h0{#$;constructor($){this.#$=H($)}temporary(){return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{temporary:!0})})}materialized(){return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{materialized:!0})})}ifNotExists(){return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{ifNotExists:!0})})}orReplace(){return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{orReplace:!0})})}columns($){return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{columns:$.map(y4)})})}as($){const Z=$.withPlugin(new l4).toOperationNode();return new h0({...this.#$,node:T0.cloneWith(this.#$.node,{as:Z})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(h0,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");var m1=H({is($){return $.kind==="DropViewNode"},create($){return H({kind:"DropViewNode",name:Z0.create($)})},cloneWith($,Z){return H({...$,...Z})}});class L1{#$;constructor($){this.#$=H($)}materialized(){return new L1({...this.#$,node:m1.cloneWith(this.#$.node,{materialized:!0})})}ifExists(){return new L1({...this.#$,node:m1.cloneWith(this.#$.node,{ifExists:!0})})}cascade(){return new L1({...this.#$,node:m1.cloneWith(this.#$.node,{cascade:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(L1,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");var i8=H({is($){return $.kind==="CreateTypeNode"},create($){return H({kind:"CreateTypeNode",name:$})},cloneWithEnum($,Z){return H({...$,enum:R1.create(Z.map((X)=>n.createImmediate(X)))})}});class L8{#$;constructor($){this.#$=H($)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}asEnum($){return new L8({...this.#$,node:i8.cloneWithEnum(this.#$.node,$)})}$call($){return $(this)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(L8,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");var t8=H({is($){return $.kind==="DropTypeNode"},create($){return H({kind:"DropTypeNode",name:$})},cloneWith($,Z){return H({...$,...Z})}});class M8{#$;constructor($){this.#$=H($)}ifExists(){return new M8({...this.#$,node:t8.cloneWith(this.#$.node,{ifExists:!0})})}$call($){return $(this)}toOperationNode(){return this.#$.executor.transformQuery(this.#$.node,this.#$.queryId)}compile(){return this.#$.executor.compileQuery(this.toOperationNode(),this.#$.queryId)}async execute(){await this.#$.executor.executeQuery(this.compile(),this.#$.queryId)}}M(M8,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");function d4($){if($.includes(".")){const X=$.split(".").map(TX);if(X.length===2)return Z0.createWithSchema(X[0],X[1]);else throw new Error(`invalid schemable identifier ${$}`)}else return Z0.create($)}var TX=function($){return $.trim()};class f1{#$;constructor($){this.#$=$}createTable($){return new e({queryId:O(),executor:this.#$,node:t.create(T($))})}dropTable($){return new g1({queryId:O(),executor:this.#$,node:K8.create(T($))})}createIndex($){return new U0({queryId:O(),executor:this.#$,node:w0.create($)})}dropIndex($){return new U1({queryId:O(),executor:this.#$,node:s0.create($)})}createSchema($){return new U8({queryId:O(),executor:this.#$,node:p8.create($)})}dropSchema($){return new y1({queryId:O(),executor:this.#$,node:G8.create($)})}alterTable($){return new a8({queryId:O(),executor:this.#$,node:w.create(T($))})}createView($){return new h0({queryId:O(),executor:this.#$,node:T0.create($)})}dropView($){return new L1({queryId:O(),executor:this.#$,node:m1.create($)})}createType($){return new L8({queryId:O(),executor:this.#$,node:i8.create(d4($))})}dropType($){return new M8({queryId:O(),executor:this.#$,node:t8.create(d4($))})}withPlugin($){return new f1(this.#$.withPlugin($))}withoutPlugins(){return new f1(this.#$.withoutPlugins())}withSchema($){return new f1(this.#$.withPluginAtFront(new M0($)))}}class a4{ref($){return new q4($)}}class i4{#$;constructor($){this.#$=$}async provideConnection($){const Z=await this.#$.acquireConnection();try{return await $(Z)}finally{await this.#$.releaseConnection(Z)}}}class r0 extends X8{#$;#Z;#X;constructor($,Z,X,Y=[]){super(Y);this.#$=$,this.#Z=Z,this.#X=X}get adapter(){return this.#Z}compileQuery($){return this.#$.compileQuery($)}provideConnection($){return this.#X.provideConnection($)}withPlugins($){return new r0(this.#$,this.#Z,this.#X,[...this.plugins,...$])}withPlugin($){return new r0(this.#$,this.#Z,this.#X,[...this.plugins,$])}withPluginAtFront($){return new r0(this.#$,this.#Z,this.#X,[$,...this.plugins])}withConnectionProvider($){return new r0(this.#$,this.#Z,$,[...this.plugins])}withoutPlugins(){return new r0(this.#$,this.#Z,this.#X,[])}}function t4(){if(typeof performance!=="undefined"&&Q(performance.now))return performance.now();else return Date.now()}class s4{#$;#Z;#X;#H;#G;#K=new WeakSet;constructor($,Z){this.#H=!1,this.#$=$,this.#Z=Z}async init(){if(this.#G)throw new Error("driver has already been destroyed");if(!this.#X)this.#X=this.#$.init().then(()=>{this.#H=!0}).catch(($)=>{return this.#X=void 0,Promise.reject($)});await this.#X}async acquireConnection(){if(this.#G)throw new Error("driver has already been destroyed");if(!this.#H)await this.init();const $=await this.#$.acquireConnection();if(!this.#K.has($)){if(this.#Y())this.#J($);this.#K.add($)}return $}async releaseConnection($){await this.#$.releaseConnection($)}beginTransaction($,Z){return this.#$.beginTransaction($,Z)}commitTransaction($){return this.#$.commitTransaction($)}rollbackTransaction($){return this.#$.rollbackTransaction($)}async destroy(){if(!this.#X)return;if(await this.#X,!this.#G)this.#G=this.#$.destroy().catch(($)=>{return this.#G=void 0,Promise.reject($)});await this.#G}#Y(){return this.#Z.isLevelEnabled("query")||this.#Z.isLevelEnabled("error")}#J($){const Z=$.executeQuery;$.executeQuery=async(X)=>{let Y;const G=t4();try{return await Z.call($,X)}catch(K){throw Y=K,await this.#_(K,X,G),K}finally{if(!Y)await this.#M(X,G)}}}async#_($,Z,X){await this.#Z.error(()=>({level:"error",error:$,query:Z,queryDurationMillis:this.#U(X)}))}async#M($,Z){await this.#Z.query(()=>({level:"query",query:$,queryDurationMillis:this.#U(Z)}))}#U($){return t4()-$}}var AX=()=>{};class s8{#$;#Z;constructor($){this.#$=$}async provideConnection($){while(this.#Z)await this.#Z.catch(AX);return this.#Z=this.#X($).finally(()=>{this.#Z=void 0}),this.#Z}async#X($){return await $(this.#$)}}var g9=["read uncommitted","read committed","repeatable read","serializable","snapshot"];var zX=function($){if($.level==="query")console.log(`kysely:query: ${$.query.sql}`),console.log(`kysely:query: duration: ${$.queryDurationMillis.toFixed(1)}ms`);else if($.level==="error")if($.error instanceof Error)console.error(`kysely:error: ${$.error.stack??$.error.message}`);else console.error(`kysely:error: ${JSON.stringify({error:$.error,query:$.query.sql,queryDurationMillis:$.queryDurationMillis})}`)},kR=H(["query","error"]);class n4{#$;#Z;constructor($){if(Q($))this.#Z=$,this.#$=H({query:!0,error:!0});else this.#Z=zX,this.#$=H({query:$.includes("query"),error:$.includes("error")})}isLevelEnabled($){return this.#$[$]}async query($){if(this.#$.query)await this.#Z($())}async error($){if(this.#$.error)await this.#Z($())}}function m9($){return c($)&&Q($.compile)}function QX($){return c($)&&c($.config)&&c($.driver)&&c($.executor)&&c($.dialect)}var SX=function($){if($.isolationLevel&&!g9.includes($.isolationLevel))throw new Error(`invalid transaction isolation level ${$.isolationLevel}`)};class f0 extends C0{#$;constructor($){let Z,X;if(QX($))Z={executor:$.executor},X={...$};else{const Y=$.dialect,G=Y.createDriver(),K=Y.createQueryCompiler(),J=Y.createAdapter(),_=new n4($.log??[]),U=new s4(G,_),L=new i4(U),F=new r0(K,J,L,$.plugins??[]);Z={executor:F},X={config:$,executor:F,dialect:Y,driver:U}}super(Z);this.#$=H(X)}get schema(){return new f1(this.#$.executor)}get dynamic(){return new a4}get introspection(){return this.#$.dialect.createIntrospector(this.withoutPlugins())}case($){return new Y8({node:W0.create(q0($)?void 0:H0($))})}get fn(){return c8()}transaction(){return new n8({...this.#$})}connection(){return new o4({...this.#$})}withPlugin($){return new f0({...this.#$,executor:this.#$.executor.withPlugin($)})}withoutPlugins(){return new f0({...this.#$,executor:this.#$.executor.withoutPlugins()})}withSchema($){return new f0({...this.#$,executor:this.#$.executor.withPluginAtFront(new M0($))})}withTables(){return new f0({...this.#$})}async destroy(){await this.#$.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#$.executor}executeQuery($,Z=O()){const X=m9($)?$.compile():$;return this.getExecutor().executeQuery(X,Z)}}class c1 extends f0{#$;constructor($){super($);this.#$=$}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin($){return new c1({...this.#$,executor:this.#$.executor.withPlugin($)})}withoutPlugins(){return new c1({...this.#$,executor:this.#$.executor.withoutPlugins()})}withSchema($){return new c1({...this.#$,executor:this.#$.executor.withPluginAtFront(new M0($))})}withTables(){return new c1({...this.#$})}}class o4{#$;constructor($){this.#$=H($)}async execute($){return this.#$.executor.provideConnection(async(Z)=>{const X=this.#$.executor.withConnectionProvider(new s8(Z)),Y=new f0({...this.#$,executor:X});return await $(Y)})}}M(o4,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");class n8{#$;constructor($){this.#$=H($)}setIsolationLevel($){return new n8({...this.#$,isolationLevel:$})}async execute($){const{isolationLevel:Z,...X}=this.#$,Y={isolationLevel:Z};return SX(Y),this.#$.executor.provideConnection(async(G)=>{const K=this.#$.executor.withConnectionProvider(new s8(G)),J=new c1({...X,executor:K});try{await this.#$.driver.beginTransaction(G,Y);const _=await $(J);return await this.#$.driver.commitTransaction(G),_}catch(_){throw await this.#$.driver.rollbackTransaction(G),_}})}}M(n8,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");class r4{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#$=H({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),AddIndexNode:this.visitAddIndex.bind(this)});visitNode=($)=>{this.nodeStack.push($),this.#$[$.kind]($),this.nodeStack.pop()}}class e4 extends r4{#$="";#Z=[];get numParameters(){return this.#Z.length}compileQuery($){return this.#$="",this.#Z=[],this.visitNode($),H({query:$,sql:this.getSql(),parameters:[...this.#Z]})}getSql(){return this.#$}visitSelectQuery($){const Z=this.parentNode!==void 0&&!S0.is(this.parentNode)&&!o.is(this.parentNode)&&!t.is(this.parentNode)&&!T0.is(this.parentNode)&&!b8.is(this.parentNode);if(this.parentNode===void 0&&$.explain)this.visitNode($.explain),this.append(" ");if(Z)this.append("(");if($.with)this.visitNode($.with),this.append(" ");if(this.append("select"),$.distinctOn)this.append(" "),this.compileDistinctOn($.distinctOn);if($.frontModifiers?.length)this.append(" "),this.compileList($.frontModifiers," ");if($.selections)this.append(" "),this.compileList($.selections);if($.from)this.append(" "),this.visitNode($.from);if($.joins)this.append(" "),this.compileList($.joins," ");if($.where)this.append(" "),this.visitNode($.where);if($.groupBy)this.append(" "),this.visitNode($.groupBy);if($.having)this.append(" "),this.visitNode($.having);if($.setOperations)this.append(" "),this.compileList($.setOperations," ");if($.orderBy)this.append(" "),this.visitNode($.orderBy);if($.limit)this.append(" "),this.visitNode($.limit);if($.offset)this.append(" "),this.visitNode($.offset);if($.endModifiers?.length)this.append(" "),this.compileList(this.sortSelectModifiers([...$.endModifiers])," ");if(Z)this.append(")")}visitFrom($){this.append("from "),this.compileList($.froms)}visitSelection($){this.visitNode($.selection)}visitColumn($){this.visitNode($.column)}compileDistinctOn($){this.append("distinct on ("),this.compileList($),this.append(")")}compileList($,Z=", "){const X=$.length-1;for(let Y=0;Y<=X;Y++)if(this.visitNode($[Y]),Y<X)this.append(Z)}visitWhere($){this.append("where "),this.visitNode($.where)}visitHaving($){this.append("having "),this.visitNode($.having)}visitInsertQuery($){const Z=this.nodeStack.find(R.is)!==$;if(!Z&&$.explain)this.visitNode($.explain),this.append(" ");if(Z)this.append("(");if($.with)this.visitNode($.with),this.append(" ");if(this.append($.replace?"replace":"insert"),$.ignore)this.append(" ignore");if(this.append(" into "),this.visitNode($.into),$.columns)this.append(" ("),this.compileList($.columns),this.append(")");if($.values)this.append(" "),this.visitNode($.values);if($.defaultValues)this.append(" "),this.append("default values");if($.onConflict)this.append(" "),this.visitNode($.onConflict);if($.onDuplicateKey)this.append(" "),this.visitNode($.onDuplicateKey);if($.returning)this.append(" "),this.visitNode($.returning);if(Z)this.append(")")}visitValues($){this.append("values "),this.compileList($.values)}visitDeleteQuery($){const Z=this.nodeStack.find(R.is)!==$;if(!Z&&$.explain)this.visitNode($.explain),this.append(" ");if(Z)this.append("(");if($.with)this.visitNode($.with),this.append(" ");if(this.append("delete "),this.visitNode($.from),$.using)this.append(" "),this.visitNode($.using);if($.joins)this.append(" "),this.compileList($.joins," ");if($.where)this.append(" "),this.visitNode($.where);if($.orderBy)this.append(" "),this.visitNode($.orderBy);if($.limit)this.append(" "),this.visitNode($.limit);if($.returning)this.append(" "),this.visitNode($.returning);if(Z)this.append(")")}visitReturning($){this.append("returning "),this.compileList($.selections)}visitAlias($){this.visitNode($.node),this.append(" as "),this.visitNode($.alias)}visitReference($){if($.table)this.visitNode($.table),this.append(".");this.visitNode($.column)}visitSelectAll($){this.append("*")}visitIdentifier($){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier($),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier($){if(!j($.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier($.name))}visitAnd($){this.visitNode($.left),this.append(" and "),this.visitNode($.right)}visitOr($){this.visitNode($.left),this.append(" or "),this.visitNode($.right)}visitValue($){if($.immediate)this.appendImmediateValue($.value);else this.appendValue($.value)}visitValueList($){this.append("("),this.compileList($.values),this.append(")")}visitTuple($){this.append("("),this.compileList($.values),this.append(")")}visitPrimitiveValueList($){this.append("(");const{values:Z}=$;for(let X=0;X<Z.length;++X)if(this.appendValue(Z[X]),X!==Z.length-1)this.append(", ");this.append(")")}visitParens($){this.append("("),this.visitNode($.node),this.append(")")}visitJoin($){if(this.append(CX[$.joinType]),this.append(" "),this.visitNode($.table),$.on)this.append(" "),this.visitNode($.on)}visitOn($){this.append("on "),this.visitNode($.on)}visitRaw($){const{sqlFragments:Z,parameters:X}=$;for(let Y=0;Y<Z.length;++Y)if(this.append(Z[Y]),X.length>Y)this.visitNode(X[Y])}visitOperator($){this.append($.operator)}visitTable($){this.visitNode($.table)}visitSchemableIdentifier($){if($.schema)this.visitNode($.schema),this.append(".");this.visitNode($.identifier)}visitCreateTable($){if(this.append("create "),$.frontModifiers&&$.frontModifiers.length>0)this.compileList($.frontModifiers," "),this.append(" ");if($.temporary)this.append("temporary ");if(this.append("table "),$.ifNotExists)this.append("if not exists ");if(this.visitNode($.table),$.selectQuery)this.append(" as "),this.visitNode($.selectQuery);else{if(this.append(" ("),this.compileList([...$.columns,...$.constraints??[]]),this.append(")"),$.onCommit)this.append(" on commit "),this.append($.onCommit);if($.endModifiers&&$.endModifiers.length>0)this.append(" "),this.compileList($.endModifiers," ")}}visitColumnDefinition($){if(this.visitNode($.column),this.append(" "),this.visitNode($.dataType),$.unsigned)this.append(" unsigned");if($.frontModifiers&&$.frontModifiers.length>0)this.append(" "),this.compileList($.frontModifiers," ");if($.generated)this.append(" "),this.visitNode($.generated);if($.defaultTo)this.append(" "),this.visitNode($.defaultTo);if($.notNull)this.append(" not null");if($.unique)this.append(" unique");if($.nullsNotDistinct)this.append(" nulls not distinct");if($.primaryKey)this.append(" primary key");if($.autoIncrement)this.append(" "),this.append(this.getAutoIncrement());if($.references)this.append(" "),this.visitNode($.references);if($.check)this.append(" "),this.visitNode($.check);if($.endModifiers&&$.endModifiers.length>0)this.append(" "),this.compileList($.endModifiers," ")}getAutoIncrement(){return"auto_increment"}visitReferences($){if(this.append("references "),this.visitNode($.table),this.append(" ("),this.compileList($.columns),this.append(")"),$.onDelete)this.append(" on delete "),this.append($.onDelete);if($.onUpdate)this.append(" on update "),this.append($.onUpdate)}visitDropTable($){if(this.append("drop table "),$.ifExists)this.append("if exists ");if(this.visitNode($.table),$.cascade)this.append(" cascade")}visitDataType($){this.append($.dataType)}visitOrderBy($){this.append("order by "),this.compileList($.items)}visitOrderByItem($){if(this.visitNode($.orderBy),$.direction)this.append(" "),this.visitNode($.direction)}visitGroupBy($){this.append("group by "),this.compileList($.items)}visitGroupByItem($){this.visitNode($.groupBy)}visitUpdateQuery($){const Z=this.nodeStack.find(R.is)!==$;if(!Z&&$.explain)this.visitNode($.explain),this.append(" ");if(Z)this.append("(");if($.with)this.visitNode($.with),this.append(" ");if(this.append("update "),this.visitNode($.table),this.append(" set "),$.updates)this.compileList($.updates);if($.from)this.append(" "),this.visitNode($.from);if($.joins)this.append(" "),this.compileList($.joins," ");if($.where)this.append(" "),this.visitNode($.where);if($.returning)this.append(" "),this.visitNode($.returning);if(Z)this.append(")")}visitColumnUpdate($){this.visitNode($.column),this.append(" = "),this.visitNode($.value)}visitLimit($){this.append("limit "),this.visitNode($.limit)}visitOffset($){this.append("offset "),this.visitNode($.offset)}visitOnConflict($){if(this.append("on conflict"),$.columns)this.append(" ("),this.compileList($.columns),this.append(")");else if($.constraint)this.append(" on constraint "),this.visitNode($.constraint);else if($.indexExpression)this.append(" ("),this.visitNode($.indexExpression),this.append(")");if($.indexWhere)this.append(" "),this.visitNode($.indexWhere);if($.doNothing===!0)this.append(" do nothing");else if($.updates){if(this.append(" do update set "),this.compileList($.updates),$.updateWhere)this.append(" "),this.visitNode($.updateWhere)}}visitOnDuplicateKey($){this.append("on duplicate key update "),this.compileList($.updates)}visitCreateIndex($){if(this.append("create "),$.unique)this.append("unique ");if(this.append("index "),$.ifNotExists)this.append("if not exists ");if(this.visitNode($.name),$.table)this.append(" on "),this.visitNode($.table);if($.using)this.append(" using "),this.visitNode($.using);if($.columns)this.append(" ("),this.compileList($.columns),this.append(")");if($.nullsNotDistinct)this.append(" nulls not distinct");if($.where)this.append(" "),this.visitNode($.where)}visitDropIndex($){if(this.append("drop index "),$.ifExists)this.append("if exists ");if(this.visitNode($.name),$.table)this.append(" on "),this.visitNode($.table);if($.cascade)this.append(" cascade")}visitCreateSchema($){if(this.append("create schema "),$.ifNotExists)this.append("if not exists ");this.visitNode($.schema)}visitDropSchema($){if(this.append("drop schema "),$.ifExists)this.append("if exists ");if(this.visitNode($.schema),$.cascade)this.append(" cascade")}visitPrimaryKeyConstraint($){if($.name)this.append("constraint "),this.visitNode($.name),this.append(" ");this.append("primary key ("),this.compileList($.columns),this.append(")")}visitUniqueConstraint($){if($.name)this.append("constraint "),this.visitNode($.name),this.append(" ");if(this.append("unique"),$.nullsNotDistinct)this.append(" nulls not distinct");this.append(" ("),this.compileList($.columns),this.append(")")}visitCheckConstraint($){if($.name)this.append("constraint "),this.visitNode($.name),this.append(" ");this.append("check ("),this.visitNode($.expression),this.append(")")}visitForeignKeyConstraint($){if($.name)this.append("constraint "),this.visitNode($.name),this.append(" ");if(this.append("foreign key ("),this.compileList($.columns),this.append(") "),this.visitNode($.references),$.onDelete)this.append(" on delete "),this.append($.onDelete);if($.onUpdate)this.append(" on update "),this.append($.onUpdate)}visitList($){this.compileList($.items)}visitWith($){if(this.append("with "),$.recursive)this.append("recursive ");this.compileList($.expressions)}visitCommonTableExpression($){if(this.visitNode($.name),this.append(" as "),$1($.materialized)){if(!$.materialized)this.append("not ");this.append("materialized ")}this.visitNode($.expression)}visitCommonTableExpressionName($){if(this.visitNode($.table),$.columns)this.append("("),this.compileList($.columns),this.append(")")}visitAlterTable($){if(this.append("alter table "),this.visitNode($.table),this.append(" "),$.renameTo)this.append("rename to "),this.visitNode($.renameTo);if($.setSchema)this.append("set schema "),this.visitNode($.setSchema);if($.addConstraint)this.visitNode($.addConstraint);if($.dropConstraint)this.visitNode($.dropConstraint);if($.columnAlterations)this.compileColumnAlterations($.columnAlterations);if($.addIndex)this.visitNode($.addIndex);if($.dropIndex)this.visitNode($.dropIndex)}visitAddColumn($){this.append("add column "),this.visitNode($.column)}visitRenameColumn($){this.append("rename column "),this.visitNode($.column),this.append(" to "),this.visitNode($.renameTo)}visitDropColumn($){this.append("drop column "),this.visitNode($.column)}visitAlterColumn($){if(this.append("alter column "),this.visitNode($.column),this.append(" "),$.dataType){if(this.announcesNewColumnDataType())this.append("type ");if(this.visitNode($.dataType),$.dataTypeExpression)this.append("using "),this.visitNode($.dataTypeExpression)}if($.setDefault)this.append("set default "),this.visitNode($.setDefault);if($.dropDefault)this.append("drop default");if($.setNotNull)this.append("set not null");if($.dropNotNull)this.append("drop not null")}visitModifyColumn($){this.append("modify column "),this.visitNode($.column)}visitAddConstraint($){this.append("add "),this.visitNode($.constraint)}visitDropConstraint($){if(this.append("drop constraint "),$.ifExists)this.append("if exists ");if(this.visitNode($.constraintName),$.modifier==="cascade")this.append(" cascade");else if($.modifier==="restrict")this.append(" restrict")}visitSetOperation($){if(this.append($.operator),this.append(" "),$.all)this.append("all ");this.visitNode($.expression)}visitCreateView($){if(this.append("create "),$.orReplace)this.append("or replace ");if($.materialized)this.append("materialized ");if($.temporary)this.append("temporary ");if(this.append("view "),$.ifNotExists)this.append("if not exists ");if(this.visitNode($.name),this.append(" "),$.columns)this.append("("),this.compileList($.columns),this.append(") ");if($.as)this.append("as "),this.visitNode($.as)}visitDropView($){if(this.append("drop "),$.materialized)this.append("materialized ");if(this.append("view "),$.ifExists)this.append("if exists ");if(this.visitNode($.name),$.cascade)this.append(" cascade")}visitGenerated($){if(this.append("generated "),$.always)this.append("always ");if($.byDefault)this.append("by default ");if(this.append("as "),$.identity)this.append("identity");if($.expression)this.append("("),this.visitNode($.expression),this.append(")");if($.stored)this.append(" stored")}visitDefaultValue($){this.append("default "),this.visitNode($.defaultValue)}visitSelectModifier($){if($.rawModifier)this.visitNode($.rawModifier);else this.append(IX[$.modifier]);if($.of)this.append(" of "),this.compileList($.of,", ")}visitCreateType($){if(this.append("create type "),this.visitNode($.name),$.enum)this.append(" as enum "),this.visitNode($.enum)}visitDropType($){if(this.append("drop type "),$.ifExists)this.append("if exists ");this.visitNode($.name)}visitExplain($){if(this.append("explain"),$.options||$.format){if(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),$.options){if(this.visitNode($.options),$.format)this.append(this.getExplainOptionsDelimiter())}if($.format)this.append("format"),this.append(this.getExplainOptionAssignment()),this.append($.format);this.append(this.getRightExplainOptionsWrapper())}}visitDefaultInsertValue($){this.append("default")}visitAggregateFunction($){if(this.append($.func),this.append("("),$.distinct)this.append("distinct ");if(this.compileList($.aggregated),this.append(")"),$.filter)this.append(" filter("),this.visitNode($.filter),this.append(")");if($.over)this.append(" "),this.visitNode($.over)}visitOver($){if(this.append("over("),$.partitionBy){if(this.visitNode($.partitionBy),$.orderBy)this.append(" ")}if($.orderBy)this.visitNode($.orderBy);this.append(")")}visitPartitionBy($){this.append("partition by "),this.compileList($.items)}visitPartitionByItem($){this.visitNode($.partitionBy)}visitBinaryOperation($){this.visitNode($.leftOperand),this.append(" "),this.visitNode($.operator),this.append(" "),this.visitNode($.rightOperand)}visitUnaryOperation($){if(this.visitNode($.operator),!this.isMinusOperator($.operator))this.append(" ");this.visitNode($.operand)}isMinusOperator($){return J0.is($)&&$.operator==="-"}visitUsing($){this.append("using "),this.compileList($.tables)}visitFunction($){this.append($.func),this.append("("),this.compileList($.arguments),this.append(")")}visitCase($){if(this.append("case"),$.value)this.append(" "),this.visitNode($.value);if($.when)this.append(" "),this.compileList($.when," ");if($.else)this.append(" else "),this.visitNode($.else);if(this.append(" end"),$.isStatement)this.append(" case")}visitWhen($){if(this.append("when "),this.visitNode($.condition),$.result)this.append(" then "),this.visitNode($.result)}visitJSONReference($){this.visitNode($.reference),this.visitNode($.traversal)}visitJSONPath($){if($.inOperator)this.visitNode($.inOperator);this.append("'$");for(let Z of $.pathLegs)this.visitNode(Z);this.append("'")}visitJSONPathLeg($){const Z=$.type==="ArrayLocation";if(this.append(Z?"[":"."),this.append(String($.value)),Z)this.append("]")}visitJSONOperatorChain($){for(let Z=0,X=$.values.length;Z<X;Z++){if(Z===X-1)this.visitNode($.operator);else this.append("->");this.visitNode($.values[Z])}}visitAddIndex($){if(this.append("add "),$.unique)this.append("unique ");if(this.append("index "),this.visitNode($.name),$.columns)this.append(" ("),this.compileList($.columns),this.append(")");if($.using)this.append(" using "),this.visitNode($.using)}append($){this.#$+=$}appendValue($){this.addParameter($),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier($){const Z=this.getLeftIdentifierWrapper(),X=this.getRightIdentifierWrapper();let Y="";for(let G of $)if(Y+=G,G===Z)Y+=Z;else if(G===X)Y+=X;return Y}addParameter($){this.#Z.push($)}appendImmediateValue($){if(j($))this.append(`'${$}'`);else if(z8($)||$1($))this.append($.toString());else if(F1($))this.append("null");else if(l5($))this.appendImmediateValue($.toISOString());else if(d5($))this.appendImmediateValue($.toString());else throw new Error(`invalid immediate value ${$}`)}sortSelectModifiers($){return $.sort((Z,X)=>Z.modifier&&X.modifier?f9[Z.modifier]-f9[X.modifier]:1),H($)}compileColumnAlterations($){this.compileList($)}announcesNewColumnDataType(){return!0}}var IX=H({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),f9=H({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),CX=H({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral"});var F8=H({raw($,Z=[]){return H({sql:$,query:N.createWithSql($),parameters:H(Z)})}});class $5{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}class Z5{transformQuery($){return $.node}async transformResult($){return $.result}}var H5="kysely_migration",r8="kysely_migration_lock",hX=!1,X5="migration_lock",jX=H({__noMigrations__:!0});class xX{#$;constructor($){this.#$=H($)}async getMigrations(){const $=await this.#W(this.#H)?await this.#$.db.withPlugin(this.#Y).selectFrom(this.#H).select(["name","timestamp"]).execute():[];return(await this.#k()).map(({name:X,...Y})=>{const G=$.find((K)=>K.name===X);return{name:X,migration:Y,executedAt:G?new Date(G.timestamp):void 0}})}async migrateToLatest(){return this.#Z(()=>({direction:"Up",step:Infinity}))}async migrateTo($){return this.#Z(({migrations:Z,executedMigrations:X,pendingMigrations:Y})=>{if($===jX)return{direction:"Down",step:Infinity};if(!Z.find((J)=>J.name===$))throw new Error(`migration "${$}" doesn't exist`);const G=X.indexOf($),K=Y.findIndex((J)=>J.name===$);if(G!==-1)return{direction:"Down",step:X.length-G-1};else if(K!==-1)return{direction:"Up",step:K+1};else throw new Error(`migration "${$}" isn't executed or pending`)})}async migrateUp(){return this.#Z(()=>({direction:"Up",step:1}))}async migrateDown(){return this.#Z(()=>({direction:"Down",step:1}))}async#Z($){try{return await this.#J(),await this.#q($)}catch(Z){if(Z instanceof o8)return Z.resultSet;return{error:Z}}}get#X(){return this.#$.migrationTableSchema}get#H(){return this.#$.migrationTableName??H5}get#G(){return this.#$.migrationLockTableName??r8}get#K(){return this.#$.allowUnorderedMigrations??hX}get#Y(){if(this.#X)return new M0(this.#X);return new Z5}async#J(){await this.#_(),await this.#M(),await this.#U(),await this.#R()}async#_(){if(!this.#X)return;if(!await this.#F())try{await this.#L(this.#$.db.schema.createSchema(this.#X))}catch($){if(!await this.#F())throw $}}async#M(){if(!await this.#W(this.#H))try{if(this.#X)await this.#L(this.#$.db.schema.createSchema(this.#X));await this.#L(this.#$.db.schema.withPlugin(this.#Y).createTable(this.#H).addColumn("name","varchar(255)",($)=>$.notNull().primaryKey()).addColumn("timestamp","varchar(255)",($)=>$.notNull()))}catch($){if(!await this.#W(this.#H))throw $}}async#U(){if(!await this.#W(this.#G))try{await this.#L(this.#$.db.schema.withPlugin(this.#Y).createTable(this.#G).addColumn("id","varchar(255)",($)=>$.notNull().primaryKey()).addColumn("is_locked","integer",($)=>$.notNull().defaultTo(0)))}catch($){if(!await this.#W(this.#G))throw $}}async#R(){if(!await this.#V())try{await this.#$.db.withPlugin(this.#Y).insertInto(this.#G).values({id:X5,is_locked:0}).execute()}catch($){if(!await this.#V())throw $}}async#F(){return(await this.#$.db.introspection.getSchemas()).some((Z)=>Z.name===this.#X)}async#W($){const Z=this.#X;return(await this.#$.db.introspection.getTables({withInternalKyselyTables:!0})).some((Y)=>Y.name===$&&(!Z||Y.schema===Z))}async#V(){return!!await this.#$.db.withPlugin(this.#Y).selectFrom(this.#G).where("id","=",X5).select("id").executeTakeFirst()}async#q($){const Z=this.#$.db.getExecutor().adapter,X=H({lockTable:this.#$.migrationLockTableName??r8,lockRowId:X5,lockTableSchema:this.#$.migrationTableSchema}),Y=async(G)=>{try{await Z.acquireMigrationLock(G,X);const K=await this.#P(G);if(K.migrations.length===0)return{results:[]};const{direction:J,step:_}=$(K);if(_<=0)return{results:[]};if(J==="Down")return await this.#T(G,K,_);else if(J==="Up")return await this.#A(G,K,_);return{results:[]}}finally{await Z.releaseMigrationLock(G,X)}};if(Z.supportsTransactionalDdl)return this.#$.db.transaction().execute(Y);else return this.#$.db.connection().execute(Y)}async#P($){const Z=await this.#k(),X=await this.#E($);if(this.#O(Z,X),!this.#K)this.#w(Z,X);const Y=this.#D(Z,X);return H({migrations:Z,executedMigrations:X,lastMigration:a5(X),pendingMigrations:Y})}#D($,Z){return $.filter((X)=>{return!Z.includes(X.name)})}async#k(){const $=await this.#$.provider.getMigrations();return Object.keys($).sort().map((Z)=>({...$[Z],name:Z}))}async#E($){return(await $.withPlugin(this.#Y).selectFrom(this.#H).select("name").orderBy(["timestamp","name"]).execute()).map((X)=>X.name)}#O($,Z){for(let X of Z)if(!$.some((Y)=>Y.name===X))throw new Error(`corrupted migrations: previously executed migration ${X} is missing`)}#w($,Z){for(let X=0;X<Z.length;++X)if($[X].name!==Z[X])throw new Error(`corrupted migrations: expected previously executed migration ${Z[X]} to be at index ${X} but ${$[X].name} was found in its place. New migrations must always have a name that comes alphabetically after the last executed migration.`)}async#T($,Z,X){const Y=Z.executedMigrations.slice().reverse().slice(0,X).map((K)=>{return Z.migrations.find((J)=>J.name===K)}),G=Y.map((K)=>{return{migrationName:K.name,direction:"Down",status:"NotExecuted"}});for(let K=0;K<G.length;++K){const J=Y[K];try{if(J.down)await J.down($),await $.withPlugin(this.#Y).deleteFrom(this.#H).where("name","=",J.name).execute(),G[K]={migrationName:J.name,direction:"Down",status:"Success"}}catch(_){throw G[K]={migrationName:J.name,direction:"Down",status:"Error"},new o8({error:_,results:G})}}return{results:G}}async#A($,Z,X){const G=Z.pendingMigrations.slice(0,X).map((K)=>{return{migrationName:K.name,direction:"Up",status:"NotExecuted"}});for(let K=0;K<G.length;K++){const J=Z.pendingMigrations[K];try{await J.up($),await $.withPlugin(this.#Y).insertInto(this.#H).values({name:J.name,timestamp:(new Date()).toISOString()}).execute(),G[K]={migrationName:J.name,direction:"Up",status:"Success"}}catch(_){throw G[K]={migrationName:J.name,direction:"Up",status:"Error"},new o8({error:_,results:G})}}return{results:G}}async#L($){if(this.#$.db.getExecutor().adapter.supportsCreateIfNotExists)$=$.ifNotExists();await $.execute()}}class o8 extends Error{#$;constructor($){super();this.#$=$}get resultSet(){return this.#$}}var vX=/"/g;class Y5 extends e4{sanitizeIdentifier($){return $.replace(vX,'""')}}class G5{#$;constructor($){this.#$=$}async getSchemas(){return(await this.#$.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map((Z)=>({name:Z.nspname}))}async getTables($={withInternalKyselyTables:!1}){let Z=this.#$.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",this.#$.selectFrom("pg_class").select(K1`true`.as("auto_incrementing")).whereRef("relnamespace","=","c.relnamespace").where("relkind","=","S").where("relname","=",K1`c.relname || '_' || a.attname || '_seq'`).as("auto_incrementing")]).where((Y)=>Y.or([Y("c.relkind","=","r"),Y("c.relkind","=","v")])).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();if(!$.withInternalKyselyTables)Z=Z.where("c.relname","!=",H5).where("c.relname","!=",r8);const X=await Z.execute();return this.#Z(X)}async getMetadata($){return{tables:await this.getTables($)}}#Z($){return $.reduce((Z,X)=>{let Y=Z.find((G)=>G.name===X.table&&G.schema===X.schema);if(!Y)Y=H({name:X.table,isView:X.table_type==="v",schema:X.schema,columns:[]}),Z.push(Y);return Y.columns.push(H({name:X.column,dataType:X.type,dataTypeSchema:X.type_schema,isNullable:!X.not_null,isAutoIncrementing:!!X.auto_incrementing,hasDefaultValue:X.has_default})),Z},[])}}var BX=BigInt("3853314791062309107");class K5 extends $5{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock($,Z){await K1`select pg_advisory_xact_lock(${K1.lit(BX)})`.execute($)}async releaseMigrationLock($,Z){}}function c9($,Z){if(NX($)&&Z.stack){const X=Z.stack.split("\n").slice(1).join("\n");return $.stack+=`\n${X}`,$}return $}var NX=function($){return c($)&&j($.stack)};var u9=Symbol();class J5{#$;#Z=new WeakMap;#X;constructor($){this.#$=H({...$})}async init(){this.#X=Q(this.#$.pool)?await this.#$.pool():this.#$.pool}async acquireConnection(){const $=await this.#X.connect();let Z=this.#Z.get($);if(!Z){if(Z=new p9($,{cursor:this.#$.cursor??null}),this.#Z.set($,Z),this.#$.onCreateConnection)await this.#$.onCreateConnection(Z)}return Z}async beginTransaction($,Z){if(Z.isolationLevel)await $.executeQuery(F8.raw(`start transaction isolation level ${Z.isolationLevel}`));else await $.executeQuery(F8.raw("begin"))}async commitTransaction($){await $.executeQuery(F8.raw("commit"))}async rollbackTransaction($){await $.executeQuery(F8.raw("rollback"))}async releaseConnection($){$[u9]()}async destroy(){if(this.#X){const $=this.#X;this.#X=void 0,await $.end()}}}class p9{#$;#Z;constructor($,Z){this.#$=$,this.#Z=Z}async executeQuery($){try{const Z=await this.#$.query($.sql,[...$.parameters]);if(Z.command==="INSERT"||Z.command==="UPDATE"||Z.command==="DELETE"){const X=BigInt(Z.rowCount);return{numUpdatedOrDeletedRows:X,numAffectedRows:X,rows:Z.rows??[]}}return{rows:Z.rows??[]}}catch(Z){throw c9(Z,new Error)}}async*streamQuery($,Z){if(!this.#Z.cursor)throw new Error("'cursor' is not present in your postgres dialect config. It's required to make streaming work in postgres.");if(!Number.isInteger(Z)||Z<=0)throw new Error("chunkSize must be a positive integer");const X=this.#$.query(new this.#Z.cursor($.sql,$.parameters.slice()));try{while(!0){const Y=await X.read(Z);if(Y.length===0)break;yield{rows:Y}}}finally{await X.close()}}[u9](){this.#$.release()}}class _5{#$;constructor($){this.#$=$}createDriver(){return new J5(this.#$)}createQueryCompiler(){return new Y5}createAdapter(){return new K5}createIntrospector($){return new G5($)}}var ZX=PY(f5(),1),DY=new _5({pool:new ZX.Pool({database:"rinha",host:"db",user:"admin",password:"123",port:5432,max:5})}),VP=new f0({dialect:DY});
api01-1  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^
api01-1  | ECONNREFUSED: Failed to connect
api01-1  |  syscall: "connect"
api01-1  | 
api01-1  |       at /usr/src/app/dist/chunk-a11d92ce62e56ec8.js:1:60364
api01-1  |       at promiseReactionJob (native:1:1)
api01-1  |       at processTicksAndRejections (native:1:1)
api01-1  | GET - http://localhost/clientes/1/extrato failed
db-1     | 2024-02-19 04:59:26.929 UTC [50] LOG:  checkpoint complete: wrote 940 buffers (5.7%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.383 s, sync=0.114 s, total=0.514 s; sync files=313, longest=0.063 s, average=0.001 s; distance=4296 kB, estimate=4296 kB; lsn=0/191CBF0, redo lsn=0/191CBF0
db-1     | 2024-02-19 04:59:26.934 UTC [49] LOG:  database system is shut down
db-1     |  done
db-1     | server stopped
db-1     | 
db-1     | PostgreSQL init process complete; ready for start up.
db-1     | 
db-1     | 2024-02-19 04:59:26.962 UTC [1] LOG:  starting PostgreSQL 16.2 (Debian 16.2-1.pgdg120+2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
db-1     | 2024-02-19 04:59:26.962 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db-1     | 2024-02-19 04:59:26.962 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db-1     | 2024-02-19 04:59:26.967 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db-1     | 2024-02-19 04:59:27.015 UTC [67] LOG:  database system was shut down at 2024-02-19 04:59:26 UTC
db-1     | 2024-02-19 04:59:27.025 UTC [1] LOG:  database system is ready to accept connections
db-1     | 2024-02-19 04:59:55.421 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:55.421 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82335).
db-1     | 2024-02-19 04:59:55.421 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:55.453 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:55.453 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -107208).
db-1     | 2024-02-19 04:59:55.453 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:55.582 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:55.582 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80279).
db-1     | 2024-02-19 04:59:55.582 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:55.646 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:55.646 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105307).
db-1     | 2024-02-19 04:59:55.646 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:56.002 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:56.002 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101044).
db-1     | 2024-02-19 04:59:56.002 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:56.533 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:56.533 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102196).
db-1     | 2024-02-19 04:59:56.533 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:56.655 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:56.655 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100778).
db-1     | 2024-02-19 04:59:56.655 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:56.685 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:56.685 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101682).
db-1     | 2024-02-19 04:59:56.685 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:57.049 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:57.049 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103443).
db-1     | 2024-02-19 04:59:57.049 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:57.231 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:57.231 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80608).
db-1     | 2024-02-19 04:59:57.231 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:57.376 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:57.376 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80266).
db-1     | 2024-02-19 04:59:57.376 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:57.406 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:57.406 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84241).
db-1     | 2024-02-19 04:59:57.406 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:57.663 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:57.663 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101726).
db-1     | 2024-02-19 04:59:57.663 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.091 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.091 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80716).
db-1     | 2024-02-19 04:59:58.091 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.176 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.176 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84337).
db-1     | 2024-02-19 04:59:58.176 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.233 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.233 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -87110).
db-1     | 2024-02-19 04:59:58.233 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.263 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.263 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105521).
db-1     | 2024-02-19 04:59:58.263 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.293 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.293 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105321).
db-1     | 2024-02-19 04:59:58.293 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.318 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.318 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -88095).
db-1     | 2024-02-19 04:59:58.318 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.400 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.400 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -87262).
db-1     | 2024-02-19 04:59:58.400 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.427 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.427 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84680).
db-1     | 2024-02-19 04:59:58.427 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.453 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.453 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100178).
db-1     | 2024-02-19 04:59:58.453 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.507 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.507 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -85356).
db-1     | 2024-02-19 04:59:58.507 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.777 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.777 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -83518).
db-1     | 2024-02-19 04:59:58.777 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:58.885 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:58.885 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82967).
db-1     | 2024-02-19 04:59:58.885 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:59.209 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:59.209 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86771).
db-1     | 2024-02-19 04:59:59.209 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:59.236 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:59.236 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -83914).
db-1     | 2024-02-19 04:59:59.236 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:59.738 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:59.738 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80856).
db-1     | 2024-02-19 04:59:59.738 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 04:59:59.896 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 04:59:59.896 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82447).
db-1     | 2024-02-19 04:59:59.896 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:00.054 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:00.054 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86875).
db-1     | 2024-02-19 05:00:00.054 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:00.616 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:00.616 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -81825).
db-1     | 2024-02-19 05:00:00.616 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:00.641 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:00.641 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -85555).
db-1     | 2024-02-19 05:00:00.641 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:00.666 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:00.666 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106417).
db-1     | 2024-02-19 05:00:00.666 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:00.866 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:00.866 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101039).
db-1     | 2024-02-19 05:00:00.866 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:01.481 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:01.481 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102088).
db-1     | 2024-02-19 05:00:01.481 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:01.506 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:01.506 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100291).
db-1     | 2024-02-19 05:00:01.506 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:01.601 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:01.601 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82641).
db-1     | 2024-02-19 05:00:01.601 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:01.625 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:01.625 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -88174).
db-1     | 2024-02-19 05:00:01.625 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:01.958 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:01.958 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82095).
db-1     | 2024-02-19 05:00:01.958 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.101 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.101 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103854).
db-1     | 2024-02-19 05:00:02.101 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.244 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.244 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80779).
db-1     | 2024-02-19 05:00:02.244 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.292 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.292 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -89731).
db-1     | 2024-02-19 05:00:02.292 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.519 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.519 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -81577).
db-1     | 2024-02-19 05:00:02.519 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.814 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.814 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82290).
db-1     | 2024-02-19 05:00:02.814 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:02.928 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:02.928 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -81928).
db-1     | 2024-02-19 05:00:02.928 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.155 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.155 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106286).
db-1     | 2024-02-19 05:00:03.155 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.223 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.223 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82469).
db-1     | 2024-02-19 05:00:03.223 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.269 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.269 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -108209).
db-1     | 2024-02-19 05:00:03.269 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.444 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.444 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106129).
db-1     | 2024-02-19 05:00:03.444 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.465 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.465 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103398).
db-1     | 2024-02-19 05:00:03.465 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.617 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.617 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -83110).
db-1     | 2024-02-19 05:00:03.617 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.770 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.770 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -83995).
db-1     | 2024-02-19 05:00:03.770 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.792 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.792 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102195).
db-1     | 2024-02-19 05:00:03.792 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.835 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.835 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -104859).
db-1     | 2024-02-19 05:00:03.835 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.900 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.900 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -104531).
db-1     | 2024-02-19 05:00:03.900 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:03.922 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:03.922 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101372).
db-1     | 2024-02-19 05:00:03.922 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:04.226 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:04.226 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86970).
db-1     | 2024-02-19 05:00:04.226 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:04.270 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:04.270 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -85138).
db-1     | 2024-02-19 05:00:04.270 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:04.439 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:04.439 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82002).
db-1     | 2024-02-19 05:00:04.439 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.227 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.227 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100371).
db-1     | 2024-02-19 05:00:05.227 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.692 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.692 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101787).
db-1     | 2024-02-19 05:00:05.692 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.772 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.772 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106289).
db-1     | 2024-02-19 05:00:05.772 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.831 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.831 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103278).
db-1     | 2024-02-19 05:00:05.831 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.872 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.872 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105799).
db-1     | 2024-02-19 05:00:05.872 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.951 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.951 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103138).
db-1     | 2024-02-19 05:00:05.951 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:05.972 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:05.972 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102117).
db-1     | 2024-02-19 05:00:05.972 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.031 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.031 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100145).
db-1     | 2024-02-19 05:00:06.031 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.132 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.132 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101094).
db-1     | 2024-02-19 05:00:06.132 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.253 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.253 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -104199).
db-1     | 2024-02-19 05:00:06.253 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.310 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.310 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100107).
db-1     | 2024-02-19 05:00:06.310 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.879 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.879 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103804).
db-1     | 2024-02-19 05:00:06.879 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:06.996 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:06.996 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100951).
db-1     | 2024-02-19 05:00:06.996 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:07.293 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:07.293 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102936).
db-1     | 2024-02-19 05:00:07.293 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:07.328 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:07.328 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100450).
db-1     | 2024-02-19 05:00:07.328 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:07.932 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:07.932 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101140).
db-1     | 2024-02-19 05:00:07.932 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.083 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.083 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101913).
db-1     | 2024-02-19 05:00:08.083 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.216 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.216 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101913).
db-1     | 2024-02-19 05:00:08.216 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.345 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.345 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -108510).
db-1     | 2024-02-19 05:00:08.345 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.581 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.581 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101202).
db-1     | 2024-02-19 05:00:08.581 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.800 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.800 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100047).
db-1     | 2024-02-19 05:00:08.800 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:08.909 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:08.909 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -108088).
db-1     | 2024-02-19 05:00:08.909 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.036 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.036 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -107439).
db-1     | 2024-02-19 05:00:09.036 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.054 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.054 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103424).
db-1     | 2024-02-19 05:00:09.054 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.127 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.127 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -107882).
db-1     | 2024-02-19 05:00:09.127 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.326 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.326 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100360).
db-1     | 2024-02-19 05:00:09.326 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.469 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.469 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106533).
db-1     | 2024-02-19 05:00:09.469 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.594 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.594 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103375).
db-1     | 2024-02-19 05:00:09.594 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.916 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.916 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -81888).
db-1     | 2024-02-19 05:00:09.916 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:09.951 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:09.951 UTC [76] DETAIL:  Failing row contains (5, kid mais, 500000, -500263).
db-1     | 2024-02-19 05:00:09.951 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.167 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.167 UTC [71] DETAIL:  Failing row contains (5, kid mais, 500000, -505456).
db-1     | 2024-02-19 05:00:10.167 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.183 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.183 UTC [76] DETAIL:  Failing row contains (5, kid mais, 500000, -500096).
db-1     | 2024-02-19 05:00:10.183 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.220 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.220 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86744).
db-1     | 2024-02-19 05:00:10.220 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.256 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.256 UTC [76] DETAIL:  Failing row contains (5, kid mais, 500000, -501465).
db-1     | 2024-02-19 05:00:10.256 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.292 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.292 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100462).
db-1     | 2024-02-19 05:00:10.292 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.326 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.326 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103511).
db-1     | 2024-02-19 05:00:10.326 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.375 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.375 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105696).
db-1     | 2024-02-19 05:00:10.375 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.409 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.409 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82394).
db-1     | 2024-02-19 05:00:10.409 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.663 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.663 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100435).
db-1     | 2024-02-19 05:00:10.663 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.715 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.715 UTC [73] DETAIL:  Failing row contains (5, kid mais, 500000, -506541).
db-1     | 2024-02-19 05:00:10.715 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.731 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.731 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106343).
db-1     | 2024-02-19 05:00:10.731 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.749 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.749 UTC [76] DETAIL:  Failing row contains (5, kid mais, 500000, -501793).
db-1     | 2024-02-19 05:00:10.749 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.817 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.817 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -107344).
db-1     | 2024-02-19 05:00:10.817 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.833 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.833 UTC [76] DETAIL:  Failing row contains (5, kid mais, 500000, -500577).
db-1     | 2024-02-19 05:00:10.833 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.867 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.867 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101711).
db-1     | 2024-02-19 05:00:10.867 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:10.935 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:10.935 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -81951).
db-1     | 2024-02-19 05:00:10.935 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.036 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.036 UTC [73] DETAIL:  Failing row contains (5, kid mais, 500000, -502663).
db-1     | 2024-02-19 05:00:11.036 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.088 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.088 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -101707).
db-1     | 2024-02-19 05:00:11.088 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.373 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.373 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -109734).
db-1     | 2024-02-19 05:00:11.373 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.492 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.492 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105981).
db-1     | 2024-02-19 05:00:11.492 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.540 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.540 UTC [71] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100337).
db-1     | 2024-02-19 05:00:11.540 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.658 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.658 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -109564).
db-1     | 2024-02-19 05:00:11.658 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.807 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.807 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80655).
db-1     | 2024-02-19 05:00:11.807 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.840 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.840 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86306).
db-1     | 2024-02-19 05:00:11.840 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.874 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.874 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -102806).
db-1     | 2024-02-19 05:00:11.874 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.892 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.892 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80628).
db-1     | 2024-02-19 05:00:11.892 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.974 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.974 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80553).
db-1     | 2024-02-19 05:00:11.974 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:11.992 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:11.992 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -87518).
db-1     | 2024-02-19 05:00:11.992 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.025 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.025 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100481).
db-1     | 2024-02-19 05:00:12.025 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.041 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.041 UTC [77] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -87401).
db-1     | 2024-02-19 05:00:12.041 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.059 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.059 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82346).
db-1     | 2024-02-19 05:00:12.059 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.075 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.075 UTC [73] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -82708).
db-1     | 2024-02-19 05:00:12.075 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.092 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.092 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -100990).
db-1     | 2024-02-19 05:00:12.092 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.125 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.125 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -104453).
db-1     | 2024-02-19 05:00:12.125 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.225 UTC [77] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.225 UTC [77] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106155).
db-1     | 2024-02-19 05:00:12.225 UTC [77] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.259 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.259 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105943).
db-1     | 2024-02-19 05:00:12.259 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.371 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.371 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103651).
db-1     | 2024-02-19 05:00:12.371 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.451 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.451 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103604).
db-1     | 2024-02-19 05:00:12.451 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.565 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.565 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -103227).
db-1     | 2024-02-19 05:00:12.565 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.581 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.581 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -104782).
db-1     | 2024-02-19 05:00:12.581 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.694 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.694 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -86356).
db-1     | 2024-02-19 05:00:12.694 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.741 UTC [73] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.741 UTC [73] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -106069).
db-1     | 2024-02-19 05:00:12.741 UTC [73] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.773 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.773 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84612).
db-1     | 2024-02-19 05:00:12.773 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.904 UTC [71] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.904 UTC [71] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84646).
db-1     | 2024-02-19 05:00:12.904 UTC [71] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:12.952 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:12.952 UTC [76] DETAIL:  Failing row contains (1, o barato sai caro, 100000, -105159).
db-1     | 2024-02-19 05:00:12.952 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:13.000 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:13.000 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -84048).
db-1     | 2024-02-19 05:00:13.000 UTC [76] STATEMENT:  update "clientes" set "saldo" = $1 where "clientes"."id" = $2
db-1     | 2024-02-19 05:00:13.015 UTC [76] ERROR:  new row for relation "clientes" violates check constraint "ck_saldo"
db-1     | 2024-02-19 05:00:13.015 UTC [76] DETAIL:  Failing row contains (2, zan corp ltda, 80000, -80784).
